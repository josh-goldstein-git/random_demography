<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction to Demographic Heterogeneity | Mathematical Demography</title>
  <meta name="description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction to Demographic Heterogeneity | Mathematical Demography" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction to Demographic Heterogeneity | Mathematical Demography" />
  
  <meta name="twitter:description" content="This is a book from the Mathematical Demography lecture notes." />
  

<meta name="author" content="Josh R. Goldstein" />


<meta name="date" content="2020-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="frailty.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Random Demography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Demographic Heterogeneity</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#part-i.-conceptual-introduction"><i class="fa fa-check"></i><b>2.2</b> Part I. Conceptual Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#what-is-demographic-heterogeneity"><i class="fa fa-check"></i><b>2.2.1</b> What is Demographic Heterogeneity?</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#analogies"><i class="fa fa-check"></i><b>2.2.2</b> Analogies</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#whats-new"><i class="fa fa-check"></i><b>2.2.3</b> What’s new?</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#application"><i class="fa fa-check"></i><b>2.2.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#part-ii.-formal-analysis"><i class="fa fa-check"></i><b>2.3</b> Part II. Formal Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#outline-1"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#keyfitz-result"><i class="fa fa-check"></i><b>2.3.2</b> Keyfitz result</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#us-mexico-example"><i class="fa fa-check"></i><b>2.3.3</b> US-Mexico Example</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#the-origin-of-professor-wachters-poisson-exponential-model"><i class="fa fa-check"></i><b>2.3.4</b> The Origin of Professor Wachter’s Poisson-Exponential Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#some-commentary"><i class="fa fa-check"></i><b>2.3.5</b> Some commentary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#questions"><i class="fa fa-check"></i><b>2.5</b> Questions</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#solutions"><i class="fa fa-check"></i><b>2.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>3</b> Multiplicative Fixed Frailty</a><ul>
<li class="chapter" data-level="3.1" data-path="frailty.html"><a href="frailty.html#outline-2"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frailty.html"><a href="frailty.html#review-of-mortality-mathematics"><i class="fa fa-check"></i><b>3.1.1</b> Review of mortality mathematics</a></li>
<li class="chapter" data-level="3.1.2" data-path="frailty.html"><a href="frailty.html#application-what-is-ellx"><i class="fa fa-check"></i><b>3.1.2</b> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="frailty.html"><a href="frailty.html#extending-keyfitz-to-mortality"><i class="fa fa-check"></i><b>3.1.3</b> Extending Keyfitz to mortality</a></li>
<li class="chapter" data-level="3.1.4" data-path="frailty.html"><a href="frailty.html#multiplicative-fixed-frailty"><i class="fa fa-check"></i><b>3.1.4</b> Multiplicative Fixed frailty</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frailty.html"><a href="frailty.html#part-i.-results-from-fixed-frailty"><i class="fa fa-check"></i><b>3.2</b> Part I. Results from Fixed Frailty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frailty.html"><a href="frailty.html#a-simulation"><i class="fa fa-check"></i><b>3.2.1</b> A simulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="frailty.html"><a href="frailty.html#lets-derive-pop-survival-note-bars-barell"><i class="fa fa-check"></i><b>3.2.2</b> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="frailty.html"><a href="frailty.html#now-population-hazards-stepping-stones"><i class="fa fa-check"></i><b>3.2.3</b> Now population hazards (stepping stones)</a></li>
<li class="chapter" data-level="3.2.4" data-path="frailty.html"><a href="frailty.html#rodriguez-question"><i class="fa fa-check"></i><b>3.2.4</b> Rodriguez question</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frailty.html"><a href="frailty.html#part-ii.-introduction-to-gamma-frailty"><i class="fa fa-check"></i><b>3.3</b> Part II. Introduction to Gamma Frailty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frailty.html"><a href="frailty.html#the-gamma-distribution"><i class="fa fa-check"></i><b>3.3.1</b> The Gamma distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="frailty.html"><a href="frailty.html#gamma-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Gamma in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="frailty.html"><a href="frailty.html#population-survival-of-gamma-frailty"><i class="fa fa-check"></i><b>3.3.3</b> Population Survival of Gamma Frailty</a></li>
<li class="chapter" data-level="3.3.4" data-path="frailty.html"><a href="frailty.html#interpreting-gamma-frailty-survival"><i class="fa fa-check"></i><b>3.3.4</b> Interpreting Gamma-frailty survival</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frailty.html"><a href="frailty.html#conclusions-1"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
<li class="chapter" data-level="3.5" data-path="frailty.html"><a href="frailty.html#questions-1"><i class="fa fa-check"></i><b>3.5</b> Questions</a></li>
<li class="chapter" data-level="3.6" data-path="frailty.html"><a href="frailty.html#solutions-1"><i class="fa fa-check"></i><b>3.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html"><i class="fa fa-check"></i><b>4</b> Gamma Frailty with Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#from-survival-to-hazards"><i class="fa fa-check"></i><b>4.1</b> From survival to hazards</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#what-happens-to-frailty-of-survivors"><i class="fa fa-check"></i><b>4.1.1</b> What happens to frailty of survivors?</a></li>
<li class="chapter" data-level="4.1.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#average-frailty-in-terms-of-survival"><i class="fa fa-check"></i><b>4.1.2</b> Average frailty in terms of survival</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#censoc-selection-and-observed-frailty"><i class="fa fa-check"></i><b>4.2</b> CenSoc: Selection and observed frailty</a><ul>
<li class="chapter" data-level="4.2.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#data"><i class="fa fa-check"></i><b>4.2.1</b> Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#estimation"><i class="fa fa-check"></i><b>4.2.2</b> Estimation</a></li>
<li class="chapter" data-level="4.2.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#discuss-our-conclusions-and-possible-future-directions-to-follow."><i class="fa fa-check"></i><b>4.2.3</b> Discuss our conclusions and possible future directions to follow.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#questions-2"><i class="fa fa-check"></i><b>4.3</b> Questions</a></li>
<li class="chapter" data-level="4.4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#solutions-2"><i class="fa fa-check"></i><b>4.4</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html"><i class="fa fa-check"></i><b>5</b> Convergence and cross-overs</a><ul>
<li class="chapter" data-level="5.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#outline-3"><i class="fa fa-check"></i><b>5.1</b> Outline</a></li>
<li class="chapter" data-level="5.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#what-happens-to-mortality-disparities-at-older-ages"><i class="fa fa-check"></i><b>5.2</b> What happens to mortality disparities at older ages?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-possible-null-model"><i class="fa fa-check"></i><b>5.2.1</b> A possible null-model</a></li>
<li class="chapter" data-level="5.2.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-result-5e---vaupel2014unobserved-eq-38"><i class="fa fa-check"></i><b>5.2.2</b> A result: (5E - <span class="citation">Vaupel and Missov (<span>2014</span>)</span> (Eq 38))</a></li>
<li class="chapter" data-level="5.2.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#inversion"><i class="fa fa-check"></i><b>5.2.3</b> Inversion</a></li>
<li class="chapter" data-level="5.2.4" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#an-example-1"><i class="fa fa-check"></i><b>5.2.4</b> An example</a></li>
<li class="chapter" data-level="5.2.5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#application-1"><i class="fa fa-check"></i><b>5.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#student-presentation"><i class="fa fa-check"></i><b>5.3</b> Student Presentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html"><i class="fa fa-check"></i><b>6</b> Mortality plateaus</a><ul>
<li class="chapter" data-level="6.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-4"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#heterogeneity-slows-mortality-improvement"><i class="fa fa-check"></i><b>6.2</b> Heterogeneity slows mortality improvement</a><ul>
<li class="chapter" data-level="6.2.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#an-example-2"><i class="fa fa-check"></i><b>6.2.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#conclusions-2"><i class="fa fa-check"></i><b>6.3</b> Conclusions</a></li>
<li class="chapter" data-level="6.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#hazards-and-plateaus-by-professor-ken-wachter"><i class="fa fa-check"></i><b>6.4</b> Hazards and Plateaus by Professor Ken Wachter</a><ul>
<li class="chapter" data-level="6.4.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-5"><i class="fa fa-check"></i><b>6.4.1</b> Outline</a></li>
<li class="chapter" data-level="6.4.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#extremes-of-longevity-in-humans-and-other-species"><i class="fa fa-check"></i><b>6.4.2</b> Extremes of Longevity in Humans and Other Species</a></li>
<li class="chapter" data-level="6.4.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#gamma-gompertz-fixed-frailty-hazards"><i class="fa fa-check"></i><b>6.4.3</b> Gamma-Gompertz Fixed Frailty Hazards</a></li>
<li class="chapter" data-level="6.4.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#less-restrictive-frailty-models"><i class="fa fa-check"></i><b>6.4.4</b> Less Restrictive Frailty Models</a></li>
<li class="chapter" data-level="6.4.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#mutation-accumulation-gompertz-hazards-with-plateaus"><i class="fa fa-check"></i><b>6.4.5</b> Mutation Accumulation, Gompertz Hazards with Plateaus</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#key-points"><i class="fa fa-check"></i><b>6.5</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><i class="fa fa-check"></i><b>7</b> Fertility Heterogeneity: Tempo Distortions and Distorted Tempo</a><ul>
<li class="chapter" data-level="7.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#outline-6"><i class="fa fa-check"></i><b>7.1</b> Outline</a></li>
<li class="chapter" data-level="7.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#fertility-postponement-a-very-simple-example"><i class="fa fa-check"></i><b>7.2.1</b> Fertility postponement, a very simple example</a></li>
<li class="chapter" data-level="7.2.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#continuous-postponement-a-shiny-simulation"><i class="fa fa-check"></i><b>7.2.2</b> Continuous postponement, a shiny simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#period-shifts-bongaarts-and-feeneys-model"><i class="fa fa-check"></i><b>7.3</b> Period Shifts: Bongaarts and Feeney’s model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here"><i class="fa fa-check"></i><b>7.3.1</b> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></a></li>
<li class="chapter" data-level="7.3.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#tempo-adjusted-tfr"><i class="fa fa-check"></i><b>7.3.2</b> Tempo-adjusted TFR:</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-application-to-the-united-states"><i class="fa fa-check"></i><b>7.4</b> An Application to the United States</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-3"><i class="fa fa-check"></i><b>7.4.1</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#two-americas"><i class="fa fa-check"></i><b>7.5</b> Two Americas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#mixture"><i class="fa fa-check"></i><b>7.5.1</b> Mixture</a></li>
<li class="chapter" data-level="7.5.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-algorithm-for-tempo-adjustment-of-mixtures"><i class="fa fa-check"></i><b>7.5.2</b> An algorithm for tempo adjustment of mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-4"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a><ul>
<li class="chapter" data-level="7.6.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#caveats"><i class="fa fa-check"></i><b>7.6.1</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#questions-3"><i class="fa fa-check"></i><b>7.7</b> Questions</a></li>
<li class="chapter" data-level="7.8" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#solutions-3"><i class="fa fa-check"></i><b>7.8</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="branching-processes.html"><a href="branching-processes.html"><i class="fa fa-check"></i><b>8</b> Branching Processes</a><ul>
<li class="chapter" data-level="8.1" data-path="branching-processes.html"><a href="branching-processes.html#outline-7"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="branching-processes.html"><a href="branching-processes.html#motivation"><i class="fa fa-check"></i><b>8.2</b> Motivation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="branching-processes.html"><a href="branching-processes.html#very-brief-history-of-branching-processes"><i class="fa fa-check"></i><b>8.2.1</b> Very brief history of Branching Processes</a></li>
<li class="chapter" data-level="8.2.2" data-path="branching-processes.html"><a href="branching-processes.html#applicability-to-the-coronavirus-yes-and-no."><i class="fa fa-check"></i><b>8.2.2</b> Applicability to the Coronavirus? Yes and no.</a></li>
<li class="chapter" data-level="8.2.3" data-path="branching-processes.html"><a href="branching-processes.html#simulated-examples-and-the-questions-they-raise"><i class="fa fa-check"></i><b>8.2.3</b> Simulated examples and the questions they raise</a></li>
<li class="chapter" data-level="8.2.4" data-path="branching-processes.html"><a href="branching-processes.html#what-is-a-bienayme-galton-watson-branching-process"><i class="fa fa-check"></i><b>8.2.4</b> What is a (Bienayme)-Galton-Watson branching process?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="branching-processes.html"><a href="branching-processes.html#simulations-of-parents-having-children"><i class="fa fa-check"></i><b>8.3</b> Simulations of parents having children</a></li>
<li class="chapter" data-level="8.4" data-path="branching-processes.html"><a href="branching-processes.html#the-probability-generating-function-our-mathematical-tool"><i class="fa fa-check"></i><b>8.4</b> The Probability Generating Function: Our mathematical tool</a></li>
<li class="chapter" data-level="8.5" data-path="branching-processes.html"><a href="branching-processes.html#extinction"><i class="fa fa-check"></i><b>8.5</b> Extinction</a></li>
<li class="chapter" data-level="8.6" data-path="branching-processes.html"><a href="branching-processes.html#good-and-bad-set-ups-for-branching-process"><i class="fa fa-check"></i><b>8.6</b> Good and bad set-ups for branching process</a></li>
<li class="chapter" data-level="8.7" data-path="branching-processes.html"><a href="branching-processes.html#the-distribution-of-offspring-of-all-generations"><i class="fa fa-check"></i><b>8.7</b> The distribution of offspring of all generations</a><ul>
<li class="chapter" data-level="8.7.1" data-path="branching-processes.html"><a href="branching-processes.html#proving-mathbbe-z_n-mn"><i class="fa fa-check"></i><b>8.7.1</b> Proving <span class="math inline">\(\mathbb{E} Z_n = m^n\)</span></a></li>
<li class="chapter" data-level="8.7.2" data-path="branching-processes.html"><a href="branching-processes.html#variance-result."><i class="fa fa-check"></i><b>8.7.2</b> Variance result.</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="branching-processes.html"><a href="branching-processes.html#geometric-offspring-distribution"><i class="fa fa-check"></i><b>8.8</b> Geometric offspring distribution</a><ul>
<li class="chapter" data-level="8.8.1" data-path="branching-processes.html"><a href="branching-processes.html#the-geometric-distributions-simple-pgf"><i class="fa fa-check"></i><b>8.8.1</b> The Geometric Distribution’s simple PGF</a></li>
<li class="chapter" data-level="8.8.2" data-path="branching-processes.html"><a href="branching-processes.html#a-plot-of-keyfitzs-numbers-for-generations-1-2-and-3.-is-it-exponential-for-k-0"><i class="fa fa-check"></i><b>8.8.2</b> A plot of Keyfitz’s numbers for generations 1, 2, and 3. Is it exponential for <span class="math inline">\(k &gt; 0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="branching-processes.html"><a href="branching-processes.html#branching-processes-and-covid-19"><i class="fa fa-check"></i><b>8.9</b> Branching Processes and Covid-19</a></li>
<li class="chapter" data-level="8.10" data-path="branching-processes.html"><a href="branching-processes.html#problems"><i class="fa fa-check"></i><b>8.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fisher-wright.html"><a href="fisher-wright.html"><i class="fa fa-check"></i><b>9</b> Fisher-Wright</a><ul>
<li class="chapter" data-level="9.1" data-path="fisher-wright.html"><a href="fisher-wright.html#outline-8"><i class="fa fa-check"></i><b>9.1</b> Outline</a></li>
<li class="chapter" data-level="9.2" data-path="fisher-wright.html"><a href="fisher-wright.html#parallel"><i class="fa fa-check"></i><b>9.2</b> Parallel</a><ul>
<li class="chapter" data-level="9.2.1" data-path="fisher-wright.html"><a href="fisher-wright.html#another-cell-phone-example"><i class="fa fa-check"></i><b>9.2.1</b> Another cell phone example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="fisher-wright.html"><a href="fisher-wright.html#mutation"><i class="fa fa-check"></i><b>9.3</b> Mutation</a></li>
<li class="chapter" data-level="9.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fixation"><i class="fa fa-check"></i><b>9.4</b> Fixation</a><ul>
<li class="chapter" data-level="9.4.1" data-path="fisher-wright.html"><a href="fisher-wright.html#probability-that-a-particular-line-will-fix"><i class="fa fa-check"></i><b>9.4.1</b> Probability that a particular line will “fix”</a></li>
<li class="chapter" data-level="9.4.2" data-path="fisher-wright.html"><a href="fisher-wright.html#expected-time-until-fixation"><i class="fa fa-check"></i><b>9.4.2</b> Expected time until fixation?</a></li>
<li class="chapter" data-level="9.4.3" data-path="fisher-wright.html"><a href="fisher-wright.html#path-to-fixation-a-measure-of-homogeneityheterogeneity"><i class="fa fa-check"></i><b>9.4.3</b> Path to fixation: a measure of homogeneity/heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="fisher-wright.html"><a href="fisher-wright.html#baby-names"><i class="fa fa-check"></i><b>9.5</b> Baby Names</a><ul>
<li class="chapter" data-level="9.5.1" data-path="fisher-wright.html"><a href="fisher-wright.html#basic-idea"><i class="fa fa-check"></i><b>9.5.1</b> Basic idea</a></li>
<li class="chapter" data-level="9.5.2" data-path="fisher-wright.html"><a href="fisher-wright.html#fisher-wright-simulation-of-baby-names-hahn-and-bentley"><i class="fa fa-check"></i><b>9.5.2</b> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</a></li>
<li class="chapter" data-level="9.5.3" data-path="fisher-wright.html"><a href="fisher-wright.html#drawing-their-picture-with-simulation"><i class="fa fa-check"></i><b>9.5.3</b> Drawing their picture with simulation</a></li>
<li class="chapter" data-level="9.5.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fw-babyname-simulation-of-equilibrium-frequencies"><i class="fa fa-check"></i><b>9.5.4</b> FW babyname simulation of equilibrium frequencies</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="fisher-wright.html"><a href="fisher-wright.html#now-we-can-simulate-babyynmes"><i class="fa fa-check"></i><b>9.6</b> Now we can simulate babyynmes</a></li>
<li class="chapter" data-level="9.7" data-path="fisher-wright.html"><a href="fisher-wright.html#conclusions-5"><i class="fa fa-check"></i><b>9.7</b> Conclusions</a><ul>
<li class="chapter" data-level="9.7.1" data-path="fisher-wright.html"><a href="fisher-wright.html#some-potential-criticism"><i class="fa fa-check"></i><b>9.7.1</b> Some potential criticism</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="coalescent.html"><a href="coalescent.html"><i class="fa fa-check"></i><b>10</b> Coalescent</a><ul>
<li class="chapter" data-level="10.1" data-path="coalescent.html"><a href="coalescent.html#outline-9"><i class="fa fa-check"></i><b>10.1</b> Outline</a></li>
<li class="chapter" data-level="10.2" data-path="coalescent.html"><a href="coalescent.html#the-coalescent-expectations-of-the-past"><i class="fa fa-check"></i><b>10.2</b> The Coalescent: Expectations of the Past</a></li>
<li class="chapter" data-level="10.3" data-path="coalescent.html"><a href="coalescent.html#our-first-question-when-was-mrca"><i class="fa fa-check"></i><b>10.3</b> Our first question: When was MRCA?</a></li>
<li class="chapter" data-level="10.4" data-path="coalescent.html"><a href="coalescent.html#mutation-and-inference-of-tmrca-and-n"><i class="fa fa-check"></i><b>10.4</b> Mutation and inference of TMRCA and <span class="math inline">\(N\)</span></a><ul>
<li class="chapter" data-level="10.4.1" data-path="coalescent.html"><a href="coalescent.html#inference-of-population-size-simulation"><i class="fa fa-check"></i><b>10.4.1</b> Inference of population size (Simulation)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="coalescent.html"><a href="coalescent.html#coalescence-of-a-sample-of-n-individuals"><i class="fa fa-check"></i><b>10.5</b> Coalescence of a sample of <span class="math inline">\(n\)</span> individuals</a></li>
<li class="chapter" data-level="10.6" data-path="coalescent.html"><a href="coalescent.html#an-application-of-coalescent-theory"><i class="fa fa-check"></i><b>10.6</b> An application of coalescent theory</a><ul>
<li class="chapter" data-level="10.6.1" data-path="coalescent.html"><a href="coalescent.html#coalesence-when-population-is-changing"><i class="fa fa-check"></i><b>10.6.1</b> Coalesence when population is changing</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="coalescent.html"><a href="coalescent.html#reconstruction-ancient-european-population-sizes-using-batinis-sample-of-mitochondrial-dna"><i class="fa fa-check"></i><b>10.7</b> Reconstruction Ancient European Population Sizes using Batini’s sample of Mitochondrial DNA"</a><ul>
<li class="chapter" data-level="10.7.1" data-path="coalescent.html"><a href="coalescent.html#summary-of-batini-et-al."><i class="fa fa-check"></i><b>10.7.1</b> Summary of Batini et al.</a></li>
<li class="chapter" data-level="10.7.2" data-path="coalescent.html"><a href="coalescent.html#ancient-population-estimates"><i class="fa fa-check"></i><b>10.7.2</b> Ancient population estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="student-presentations.html"><a href="student-presentations.html"><i class="fa fa-check"></i><b>11</b> Student Presentations</a><ul>
<li class="chapter" data-level="11.1" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers"><i class="fa fa-check"></i><b>11.1</b> Mortality Crossovers</a><ul>
<li class="chapter" data-level="11.1.1" data-path="student-presentations.html"><a href="student-presentations.html#outline-10"><i class="fa fa-check"></i><b>11.1.1</b> Outline</a></li>
<li class="chapter" data-level="11.1.2" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers-reality-or-bad-data-coale1986mortality"><i class="fa fa-check"></i><b>11.1.2</b> <em>Mortality Crossovers: Reality or Bad Data?</em> <span class="citation">(Coale and Kisker <span>1986</span>)</span></a></li>
<li class="chapter" data-level="11.1.3" data-path="student-presentations.html"><a href="student-presentations.html#methods-for-evaluating-the-heterogeneity-of-aging-processes-in-human-populations-using-vital-statistics-data-explaining-the-blackwhite-mortality-crossover-by-a-model-of-mortality-selection-manton1981methods"><i class="fa fa-check"></i><b>11.1.3</b> <em>Methods for Evaluating the Heterogeneity of Aging Processes in Human Populations Using Vital Statistics Data: Explaining the Black/White Mortality Crossover by a Model of Mortality Selection</em> <span class="citation">(Manton and Stallard <span>1981</span>)</span></a></li>
<li class="chapter" data-level="11.1.4" data-path="student-presentations.html"><a href="student-presentations.html#censoc-mortality-crossovers"><i class="fa fa-check"></i><b>11.1.4</b> CenSoc Mortality Crossovers</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="student-presentations.html"><a href="student-presentations.html#plateaus"><i class="fa fa-check"></i><b>11.2</b> Plateaus</a></li>
<li class="chapter" data-level="11.3" data-path="student-presentations.html"><a href="student-presentations.html#rising-inequality"><i class="fa fa-check"></i><b>11.3</b> Rising Inequality</a><ul>
<li class="chapter" data-level="11.3.1" data-path="student-presentations.html"><a href="student-presentations.html#trends-in-mortality-differentials-and-life-expectancy-for-male-social-security-covered-workers-by-socioeconomic-status-waldron2007trends"><i class="fa fa-check"></i><b>11.3.1</b> <em>Trends in mortality differentials and life expectancy for male social security-covered workers, by socioeconomic status</em> <span class="citation">(Waldron <span>2007</span>)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html"><i class="fa fa-check"></i><b>12</b> Demographic theory and COVID-19</a><ul>
<li class="chapter" data-level="12.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#outline-11"><i class="fa fa-check"></i><b>12.1</b> Outline</a></li>
<li class="chapter" data-level="12.2" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#motivating-questions"><i class="fa fa-check"></i><b>12.2</b> Motivating questions</a></li>
<li class="chapter" data-level="12.3" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#population-aging"><i class="fa fa-check"></i><b>12.3</b> Population aging</a><ul>
<li class="chapter" data-level="12.3.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stable-theory"><i class="fa fa-check"></i><b>12.3.1</b> Stable theory</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#keyfitzs-entropy"><i class="fa fa-check"></i><b>12.4</b> Keyfitz’s entropy</a></li>
<li class="chapter" data-level="12.5" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#loss-of-person-years-remaining"><i class="fa fa-check"></i><b>12.5</b> Loss of person years remaining</a></li>
<li class="chapter" data-level="12.6" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stationary-theory"><i class="fa fa-check"></i><b>12.6</b> Stationary theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematical Demography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Introduction to Demographic Heterogeneity</h1>
<div id="outline" class="section level2">
<h2><span class="header-section-number">2.1</span> Outline</h2>
<ol style="list-style-type: decimal">
<li>What demographic heterogeneity is (and isn’t)</li>
<li>Dynamics of population growth with two sub-groups</li>
<li>Keyfitz’s result <span class="math inline">\(\bar{r}&#39;(t) = \sigma^2_r(t)\)</span>.</li>
<li>Ken’s model of Poisson heterogeneity</li>
</ol>
</div>
<div id="part-i.-conceptual-introduction" class="section level2">
<h2><span class="header-section-number">2.2</span> Part I. Conceptual Introduction</h2>
<div id="what-is-demographic-heterogeneity" class="section level3">
<h3><span class="header-section-number">2.2.1</span> What is Demographic Heterogeneity?</h3>
<ul>
<li>If we see different outcomes (e.g., people dying at different ages),
is this <em>Demographic Heterogeneity</em>? NO.</li>
<li>Demographic heterogeneity <span class="math inline">\(=\)</span> different rates for different folks.</li>
</ul>
<blockquote>
<p>In a <em>demographically heterogeneous</em> population, people are of
different types, with different type-specific rates.</p>
</blockquote>
<p>(These types can be discrete, with individuals being
homogeneous within their type, or they can be continuous with possibly
no individual having exactly the same risk as another.)</p>
<div id="an-example" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> An example</h4>
<p>Let’s draw 10 individuals from a homogeneous population and
heterogeneous population.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1"></a>  <span class="co">## Homogeneous hazard of 1/10</span></span>
<span id="cb1-2"><a href="intro.html#cb1-2"></a>  <span class="kw">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb1-3"><a href="intro.html#cb1-3"></a>  x.homo &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">10</span>, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>)</span>
<span id="cb1-4"><a href="intro.html#cb1-4"></a>  <span class="co">## Heterogeneous hazard (half 1/6 and half 1/13)</span></span>
<span id="cb1-5"><a href="intro.html#cb1-5"></a>  <span class="co">## Note: I didn&#39;t pick these particular numbers for any specific reason</span></span>
<span id="cb1-6"><a href="intro.html#cb1-6"></a>  x.hetero &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rexp</span>(<span class="dv">5</span>, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>),</span>
<span id="cb1-7"><a href="intro.html#cb1-7"></a>                <span class="kw">rexp</span>(<span class="dv">5</span>, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">13</span>))</span>
<span id="cb1-8"><a href="intro.html#cb1-8"></a>  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb1-9"><a href="intro.html#cb1-9"></a>  <span class="kw">dotchart</span>(x.homo, <span class="dt">main =</span> <span class="st">&quot;homogenous variation&quot;</span>)</span>
<span id="cb1-10"><a href="intro.html#cb1-10"></a>  <span class="kw">dotchart</span>(x.hetero, <span class="dt">main =</span> <span class="st">&quot;heterogeneous variation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hetero-homo"></span>
<img src="bookdown-demo_files/figure-html/hetero-homo-1.png" alt="Homogeneity and Heterogeneity" width="80%" />
<p class="caption">
Figure 2.1: Homogeneity and Heterogeneity
</p>
</div>
<ul>
<li>Can you tell which is which?
<ul>
<li><em>Homogeneous</em>: Chance only</li>
<li><em>Heterogeneous:</em> Chance + group variation in risk</li>
</ul></li>
<li>Would we expect to see a difference if we increased sample?
<ul>
<li>A good question. We suspect that with a large enough sample we might be able to tell the difference between a mixture of two types and a single type. We can try a sample of, say, 1 million, and see if we can tell which is which.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1"></a>  <span class="co">## Homogeneous hazard of 1/10</span></span>
<span id="cb2-2"><a href="intro.html#cb2-2"></a>  <span class="kw">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb2-3"><a href="intro.html#cb2-3"></a>n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb2-4"><a href="intro.html#cb2-4"></a>  x.homo &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>)</span>
<span id="cb2-5"><a href="intro.html#cb2-5"></a>  <span class="co">## Heterogeneous hazard (half 1/6 and half 1/13)</span></span>
<span id="cb2-6"><a href="intro.html#cb2-6"></a>  <span class="co">## Note: I didn&#39;t pick these particular numbers for any specific reason</span></span>
<span id="cb2-7"><a href="intro.html#cb2-7"></a>  x.hetero &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rexp</span>(n<span class="op">/</span><span class="dv">2</span>, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>),</span>
<span id="cb2-8"><a href="intro.html#cb2-8"></a>                <span class="kw">rexp</span>(n<span class="op">/</span><span class="dv">2</span>, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">13</span>))</span>
<span id="cb2-9"><a href="intro.html#cb2-9"></a>  <span class="co">## Look at histograms</span></span>
<span id="cb2-10"><a href="intro.html#cb2-10"></a>  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-11"><a href="intro.html#cb2-11"></a>  <span class="kw">hist</span>(x.homo, <span class="dt">main =</span> <span class="st">&quot;homogenous variation&quot;</span>)</span>
<span id="cb2-12"><a href="intro.html#cb2-12"></a>  <span class="kw">hist</span>(x.hetero, <span class="dt">main =</span> <span class="st">&quot;heterogeneous variation&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hetero-homo-big-1"></span>
<img src="bookdown-demo_files/figure-html/hetero-homo-big-1.png" alt="Homogeneity and Heterogeneity (N = 1 million)" width="80%" />
<p class="caption">
Figure 2.2: Homogeneity and Heterogeneity (N = 1 million)
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1"></a>  <span class="co">## we don&#39;t see much at this resolution</span></span>
<span id="cb3-2"><a href="intro.html#cb3-2"></a>  <span class="co">## To see in log scale, try</span></span>
<span id="cb3-3"><a href="intro.html#cb3-3"></a>  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb3-4"><a href="intro.html#cb3-4"></a>out.hom =<span class="st"> </span><span class="kw">hist</span>(x.homo, <span class="dt">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb3-5"><a href="intro.html#cb3-5"></a>out.het =<span class="st"> </span><span class="kw">hist</span>(x.hetero, <span class="dt">breaks =</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hetero-homo-big-2"></span>
<img src="bookdown-demo_files/figure-html/hetero-homo-big-2.png" alt="Homogeneity and Heterogeneity (N = 1 million)" width="80%" />
<p class="caption">
Figure 2.3: Homogeneity and Heterogeneity (N = 1 million)
</p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="intro.html#cb4-1"></a><span class="kw">plot</span>(out.het<span class="op">$</span>breaks[<span class="op">-</span><span class="dv">1</span>], out.het<span class="op">$</span>counts, <span class="dt">log =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in xy.coords(x, y, xlabel, ylabel, log): 8 y values &lt;= 0 omitted from
## logarithmic plot</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="intro.html#cb6-1"></a><span class="kw">plot</span>(out.hom<span class="op">$</span>breaks[<span class="op">-</span><span class="dv">1</span>], out.hom<span class="op">$</span>counts, <span class="dt">log =</span> <span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in xy.coords(x, y, xlabel, ylabel, log): 10 y values &lt;= 0 omitted from
## logarithmic plot</code></pre>
<div class="figure" style="text-align: center"><span id="fig:hetero-homo-big-3"></span>
<img src="bookdown-demo_files/figure-html/hetero-homo-big-3.png" alt="Homogeneity and Heterogeneity (N = 1 million)" width="80%" />
<p class="caption">
Figure 2.4: Homogeneity and Heterogeneity (N = 1 million)
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="intro.html#cb8-1"></a><span class="co">## And now we can see a bit of curvature in the heterogeneous case.</span></span>
<span id="cb8-2"><a href="intro.html#cb8-2"></a><span class="co">## So our conclusion is that it can be possible to detect the difference but it is not easy or sure.</span></span></code></pre></div>
</div>
</div>
<div id="analogies" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Analogies</h3>
<ul>
<li>Social inequality: equal opportunity vs. equal outcomes</li>
<li>Analysis of variance: <span class="math inline">\(\mbox{total variance} = \mbox{within group} + \mbox{between group}\)</span></li>
<li>Statistical models <span class="math inline">\(y = a + b x + \epsilon\)</span></li>
</ul>
</div>
<div id="whats-new" class="section level3">
<h3><span class="header-section-number">2.2.3</span> What’s new?</h3>
<ul>
<li>Dynamics.</li>
<li>Heterogeneous populations evolve differently.
<ul>
<li>Aggregates <span class="math inline">\(\neq\)</span> Individuals</li>
<li>Rates of growth (or decline)</li>
<li>Changes over time or age or duration</li>
<li>The trajectory of even the  individual differs from population average</li>
<li>Relative positions, change of groups, may be misleading.</li>
</ul></li>
<li>Terminology
<ul>
<li>Heterogeneity</li>
<li>Unobserved heterogeneity</li>
<li>Selection</li>
<li>Selective survival</li>
</ul></li>
</ul>
<!-- \begin{frame}{1. Heterogeneity at work? Black-White Crossover} -->
<!-- \end{frame} -->
<!-- \begin{frame}{1. Heterogeneity at work? Mortality Plateus} -->
<!-- \end{frame} -->
<ul>
<li><p>Big Caveat: Fundamental Unidentifiability</p>
<ul>
<li>Same data of <span class="math inline">\(N\)</span> observations
<ul>
<li><span class="math inline">\(N\)</span> draws from 1 distribution</li>
<li><span class="math inline">\(1\)</span> draw from <span class="math inline">\(N\)</span> distributions</li>
<li>Something in-between</li>
</ul></li>
</ul>
<p>Abel (66) and Beth (76) example.</p></li>
</ul>
<div id="a-2nd-example-exponential-growth-two-countries" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> A 2nd example: Exponential growth, two countries</h4>
<p>Two countries start equal size, but grow at different rates. What
happens to aggregate growth rate?</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="intro.html#cb9-1"></a>  rA =<span class="st"> </span><span class="fl">.03</span> <span class="co">## growth rate of A</span></span>
<span id="cb9-2"><a href="intro.html#cb9-2"></a>  rB =<span class="st"> </span><span class="fl">.01</span> <span class="co">## growth rate of A</span></span>
<span id="cb9-3"><a href="intro.html#cb9-3"></a>  KA =<span class="st"> </span><span class="dv">100</span> <span class="co">## starting pop size</span></span>
<span id="cb9-4"><a href="intro.html#cb9-4"></a>  KB =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb9-5"><a href="intro.html#cb9-5"></a>  t =<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">200</span></span>
<span id="cb9-6"><a href="intro.html#cb9-6"></a>  KA.t =<span class="st"> </span>KA<span class="op">*</span><span class="kw">exp</span>(rA<span class="op">*</span>t) <span class="co">## exp growth of A</span></span>
<span id="cb9-7"><a href="intro.html#cb9-7"></a>  KB.t =<span class="st"> </span>KB<span class="op">*</span><span class="kw">exp</span>(rB<span class="op">*</span>t) <span class="co">## exp growth of B</span></span>
<span id="cb9-8"><a href="intro.html#cb9-8"></a>  K &lt;-<span class="st"> </span>KA.t <span class="op">+</span><span class="st"> </span>KB.t <span class="co">## combined pop</span></span>
<span id="cb9-9"><a href="intro.html#cb9-9"></a>  r.bar =<span class="st"> </span><span class="kw">diff</span>(<span class="kw">log</span>(K)) <span class="co">## growth rate</span></span>
<span id="cb9-10"><a href="intro.html#cb9-10"></a>  <span class="kw">plot</span>(t[<span class="op">-</span><span class="dv">1</span>], r.bar, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.04</span>),</span>
<span id="cb9-11"><a href="intro.html#cb9-11"></a>       <span class="dt">ylab =</span> <span class="st">&quot;r.bar&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb9-12"><a href="intro.html#cb9-12"></a>  <span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(rA, rB), <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:2-countries"></span>
<img src="bookdown-demo_files/figure-html/2-countries-1.png" alt="Aggregate growth rate of sub-populations A + B" width="80%" />
<p class="caption">
Figure 2.5: Aggregate growth rate of sub-populations A + B
</p>
</div>
<!-- title("Aggregate growth rate of sub-populations A + B") -->
<ul>
<li><p>Questions</p>
<ul>
<li>What determines growth rate?</li>
<li>How does it change over time?</li>
<li>Does the process converge?</li>
</ul></li>
</ul>
</div>
<div id="more-examples-to-work" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> More examples to work</h4>
<ol style="list-style-type: decimal">
<li>Differential, constant mortality (<span class="math inline">\(\mu_A = .03\)</span>; <span class="math inline">\(\mu_B =.01\)</span>)</li>
<li>Differential, <em>time-varying</em> mortality or growth.</li>
<li>``Movers and Stayers’’ (Migration)</li>
<li>``Movers and Stayers’’ (Marriage)</li>
<li>Fecundity: aging or heterogeneity?</li>
<li>Divorce: duration or heterogeneity?</li>
<li>Duration of unemployment: duration or heterogeneity?</li>
<li>Recidivism by time out of prison</li>
</ol>
</div>
</div>
<div id="application" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Application</h3>
<iframe src="https://shiny.demog.berkeley.edu/josh/het_ruse/" width="672" height="600px">
</iframe>
<ul>
<li>Can you create a plateau?</li>
<li>Can you create a crossover?</li>
<li>Can you get aggregate rate to decline?</li>
<li>Anything else?</li>
</ul>
</div>
</div>
<div id="part-ii.-formal-analysis" class="section level2">
<h2><span class="header-section-number">2.3</span> Part II. Formal Analysis</h2>
<div id="outline-1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Outline</h3>
<ol style="list-style-type: decimal">
<li>Keyfitz result</li>
<li>Keyfitz USA-Mexico example</li>
<li>Ken’s Poisson-Exponential Model</li>
</ol>
</div>
<div id="keyfitz-result" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Keyfitz result</h3>
<p><span class="math display">\[{d \over dt}\bar{r}(t) = \sigma^2_r(t)\]</span></p>
<blockquote>
<p>When group-specific growth rates are constant the rate of change of the aggregate growth rate equals the variance of the growth rates.</p>
</blockquote>
<ul>
<li>Derivation</li>
</ul>
<p>By definition,
<span class="math display">\[ \bar{K}(t) = \sum_i K_i(t) = \sum_i K_i e^{r_i t} \]</span>
and</p>
<p><span class="math display">\[\bar{r}(t) = {{d \over dt} \bar{K}(t) \over \bar{K}(t)}\]</span></p>
<p>Let’s take derivatives and simplify, recalling definition of variance.</p>
<p>SOLVE?</p>
</div>
<div id="us-mexico-example" class="section level3">
<h3><span class="header-section-number">2.3.3</span> US-Mexico Example</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="intro.html#cb10-1"></a>rm =<span class="st"> </span><span class="fl">3.5</span><span class="op">/</span><span class="dv">100</span></span>
<span id="cb10-2"><a href="intro.html#cb10-2"></a>ru =<span class="st"> </span><span class="fl">.75</span><span class="op">/</span><span class="dv">100</span></span>
<span id="cb10-3"><a href="intro.html#cb10-3"></a>Km =<span class="st"> </span><span class="dv">50</span> </span>
<span id="cb10-4"><a href="intro.html#cb10-4"></a>Ku =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb10-5"><a href="intro.html#cb10-5"></a>t &lt;-<span class="st"> </span><span class="dv">-50</span><span class="op">:</span><span class="dv">150</span> <span class="co">## go back in time to see rise and fall of variance</span></span>
<span id="cb10-6"><a href="intro.html#cb10-6"></a>Kt =<span class="st"> </span>Km <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>rm) <span class="op">+</span><span class="st"> </span>Ku <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>ru)</span>
<span id="cb10-7"><a href="intro.html#cb10-7"></a>bar.rt &lt;-<span class="st"> </span><span class="kw">diff</span>(<span class="kw">log</span>(Kt))</span>
<span id="cb10-8"><a href="intro.html#cb10-8"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb10-9"><a href="intro.html#cb10-9"></a><span class="kw">plot</span>(t, Kt, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</span>
<span id="cb10-10"><a href="intro.html#cb10-10"></a><span class="kw">title</span>(<span class="st">&#39;Total pop size (solid)</span><span class="ch">\n</span><span class="st"> Group m (dashed)&#39;</span>)</span>
<span id="cb10-11"><a href="intro.html#cb10-11"></a><span class="kw">lines</span>(t, Km <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>rm), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-12"><a href="intro.html#cb10-12"></a><span class="kw">lines</span>(t, Ku <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>ru), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-13"><a href="intro.html#cb10-13"></a>my.v =<span class="st"> </span><span class="dv">26</span></span>
<span id="cb10-14"><a href="intro.html#cb10-14"></a><span class="kw">abline</span>(<span class="dt">v =</span> my.v)</span>
<span id="cb10-15"><a href="intro.html#cb10-15"></a><span class="kw">plot</span>(t, Kt, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">log =</span> <span class="st">&#39;y&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="kw">max</span>(Kt)))</span>
<span id="cb10-16"><a href="intro.html#cb10-16"></a><span class="kw">lines</span>(t, Km <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>rm), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb10-17"><a href="intro.html#cb10-17"></a><span class="kw">lines</span>(t, Ku <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(t<span class="op">*</span>ru), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb10-18"><a href="intro.html#cb10-18"></a><span class="kw">abline</span>(<span class="dt">v =</span> my.v)</span>
<span id="cb10-19"><a href="intro.html#cb10-19"></a><span class="kw">title</span>(<span class="st">&quot;Total pop size (solid)</span><span class="ch">\n</span><span class="st"> Group &#39;m&#39; (dashed): Log-scale&quot;</span>)</span>
<span id="cb10-20"><a href="intro.html#cb10-20"></a><span class="kw">plot</span>(t[<span class="op">-</span><span class="dv">1</span>], bar.rt, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;Aggregate growth rate&#39;</span>)</span>
<span id="cb10-21"><a href="intro.html#cb10-21"></a><span class="kw">plot</span>(t[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)], <span class="kw">diff</span>(bar.rt), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb10-22"><a href="intro.html#cb10-22"></a><span class="dt">main =</span> <span class="st">&#39;Change in aggregate growth rate&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:us-mx"></span>
<img src="bookdown-demo_files/figure-html/us-mx-1.png" alt="Keyfitz result for US-Mexico" width="80%" />
<p class="caption">
Figure 2.6: Keyfitz result for US-Mexico
</p>
</div>
<div id="commentary-on-keyfitz-result" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> Commentary on Keyfitz result</h4>
<ul>
<li><p>Growth rates in heterogeneous populations start at pop average and then increase.</p></li>
<li><p>Heterogeneity pop growth</p></li>
<li><p>We will extend to cover non-constant growth</p>
<p>But</p></li>
<li><p>Doesn’t tell us how much bigger <span class="math inline">\(\bar{K}(t)\)</span> is projection using constant aggregate rate <span class="math inline">\(\bar{r}(0)\)</span>.</p></li>
<li><p>Doesn’t give us a formula for time path of aggregate <span class="math inline">\(\bar{K}(t)\)</span> or <span class="math inline">\(\bar{r}(t)\)</span></p>
<p>Note: our homework will try to address some of this using Taylor
approximation.</p></li>
</ul>
</div>
</div>
<div id="the-origin-of-professor-wachters-poisson-exponential-model" class="section level3">
<h3><span class="header-section-number">2.3.4</span> The Origin of Professor Wachter’s Poisson-Exponential Model</h3>
<p>Given a world with many sub-populations, each growing expontentially
at their own rate, what can we say about the time-path of world
population growth?</p>
<p>From an email:</p>
<blockquote>
<p>Josh asks: Suppose we have a discrete mix of subpopulations
growing at different intrinsic rates r whose maximum is r0. Is
there a handy approximation for the growth path of the aggregate
populations?</p>
</blockquote>
<blockquote>
<p>The assumption of a discrete mix is essential here. Otherwise
Tauberian theorems apply and, with a vanishingly small portion of
the population close to the maximum growth rate, we do not obtain
long-run exponential growth.</p>
</blockquote>
<blockquote>
<p>I recommend modeling the discrete distribution of growth rates as
a mixture of Poisson distributions.</p>
</blockquote>
<p>We are considering</p>
<p><span class="math display">\[\begin{equation}
  \label{mixture}
\bar{K}(t) = \sum_i e^{r_i t} K_i(0).
\end{equation}\]</span></p>
<p>Ken suggests
<span class="math display">\[\begin{equation}
  \label{ri_def}
r_i = r_0 - s(\lambda) \cdot a,
\end{equation}\]</span></p>
<ul>
<li><span class="math inline">\(r_0\)</span> growth rate of the fastest growing sub-population</li>
<li><span class="math inline">\(s\)</span> a non-negative Poisson distributed integer</li>
<li><span class="math inline">\(\lambda\)</span> the parameter of the Poisson distribution (also
it’s mean and variance)</li>
<li><span class="math inline">\(a\)</span> gap between adjacent growth rates.</li>
</ul>
<p>Example: sub-populations have growth rates 3, 2, 1, 0, -1, <span class="math inline">\(\ldots\)</span> percent,
then <span class="math inline">\(r_0 = 0.03\)</span> and <span class="math inline">\(a = 0.01\)</span>. Sizes of sub-pops determined by
Poisson dis’n</p>

<div id="closed-form-result" class="section level4">
<h4><span class="header-section-number">2.3.4.1</span> Closed-form result</h4>
<p><span class="math display">\[
K(t) = K(0) e^{r_0 t} e^{-\lambda (1 - e^{-at})}.
\]</span></p>
<p>To derive:</p>
<ul>
<li>Write out mixture to get
<span class="math display">\[  K(t) = K(0) e^{r_0 t} \sum_i e^{-sat} f(s)
\]</span></li>
<li>Substitute for <span class="math inline">\(f(s)\)</span>: <span class="math inline">\(Pois ~ {\lambda^s e^{-\lambda} \over s!}\)</span></li>
<li>Recognize that our mixture contains the series representation of
<span class="math inline">\(e^{-at}\)</span></li>
</ul>
<p>Interpretation
<span class="math display">\[
K(t) = K(0) e^{r_0 t} e^{-\lambda (1 - e^{-at})}.
\]</span></p>
<ul>
<li>Dominant term contains the maximum population growth rate <span class="math inline">\(r_0\)</span>,</li>
<li>Second term gives the diminishing effect of the
sub-populations with smaller population growth rates over time.</li>
</ul>
<p>Some further analysis, What is the closed-form expression for <span class="math inline">\(\bar{r}(t)\)</span>?</p>
</div>
</div>
<div id="some-commentary" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Some commentary</h3>
<ul>
<li>Poisson and Exponential “fit”</li>
<li>We’ll this complementarity again (e.g., with Gamma)</li>
<li>Tractable models are super powerful for enhancing our understanding.</li>
<li>But be careful. Avoid extremes: the model is right/wrong.</li>
</ul>
<p>A BIG caveat, are disaggregated models necessarily better?</p>
<ul>
<li>Some potential problems:
<ul>
<li>Aggregate constraints?</li>
<li>Interacting sub-populations?</li>
<li>Illusion of precision?</li>
</ul></li>
</ul>
</div>
</div>
<div id="conclusions" class="section level2">
<h2><span class="header-section-number">2.4</span> Conclusions</h2>
<ul>
<li>Heterogeneity as variation in risk (not just outcome)</li>
<li>Constantly growing parts <span class="math inline">\(\neq\)</span> constantly growth whole</li>
<li>Keyfitz result: Change in growth rate <span class="math inline">\(=\)</span> variance of growth rates</li>
<li>Poisson growth gives us a closed-form solution.</li>
</ul>
<hr />
<hr />
</div>
<div id="questions" class="section level2">
<h2><span class="header-section-number">2.5</span> Questions</h2>
<ol style="list-style-type: decimal">
<li><p>True or False? “If every part grows exponentially at its own rate, then the whole will also grow exponentially.” Explain your answer briefly.</p></li>
<li><p>List what you think are two of the best arguments in favor of doing a disaggregated projection? What are two of the best arguments in favor of doing an aggregated projection?</p></li>
<li><p>Let there be two countries: USA (<span class="math inline">\(u\)</span>) and Mexico (<span class="math inline">\(m\)</span>). Assume that in 1970, their population size (in millions) is <span class="math inline">\(K_u(1970) = 200\)</span>, <span class="math inline">\(K_m(1970) = 50\)</span> and that their growth rates are <span class="math inline">\(r_u = .0075\)</span> and <span class="math inline">\(r_m = 0.035\)</span>, respectively. Project the first few years and verify that the rate of change in the aggregate growth rate equals the variance of the growth rate. Does it matter what time points and period you consider?</p></li>
<li><p>Using the information from question 3, notice that the growth rate changes over the course of the 50 years, but there is a constant growth rate that will produce the exact same population after 50 years. A reasonable choice of the constant growth rate to apply is the value of the changing growth rate at year 25 (half-way through the period). We can estimate this using a Taylor series approximation: <span class="math display">\[ \bar{r}(25) \approx \bar{r}(0) + 25\bar{r}&#39;(0) + (25)^2 \bar{r}&#39;&#39;(0) \]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Show that <span class="math inline">\(\bar{r}&#39;&#39;(t) = \bar{r}_3(t) - \bar{r}_2(t) \bar{r}(t) - 2 \bar{r}(t) \sigma^2_r(t)\)</span> \</li>
<li>Calculate the combined US-Mexico population after 50 years according to the following five (5) methods, plot the total population after 50 years according to these 5 methods on a graph.
<ol style="list-style-type: lower-roman">
<li>Dissaggregated (“true”) forecast, with each country growing at its own rate</li>
<li>Aggregated forecast, pretending it’s one country, growing at <span class="math inline">\(\bar{r}(0)\)</span>) for 50 years</li>
<li>Aggregated forecast, growing at the “true” value of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period. (Use the value of <span class="math inline">\(\bar{r}(25)\)</span>) that you calculate from the disaggregated forecast)</li>
<li>Aggregated forecast, growing at the first-order Taylor series estimate of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period</li>
<li>Aggregated forecast, growing at the second-order Taylor series estimate of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period</li>
</ol></li>
</ol></li>
<li><p>For Ken’s Poisson-Exponential model,</p>
<ol style="list-style-type: lower-alpha">
<li>What is the closed-form expression for <span class="math inline">\(\hat{r}(t)\)</span><br />
</li>
<li>What is the variance of the growth rate?<br />
</li>
<li>Write down an expression for the distortion index. What variables and parameters in the model does it depend on? Are there any variables or parameters that it doesn’t depend on? (difference of <span class="math inline">\(\bar{r}(t)\)</span> and <span class="math inline">\(\bar{r}(0)\)</span>)</li>
</ol></li>
</ol>
</div>
<div id="solutions" class="section level2">
<h2><span class="header-section-number">2.6</span> Solutions</h2>
<ol style="list-style-type: decimal">
<li><p><em>True or False? “If every part grows exponentially at its own rate, then the whole will also grow exponentially.” Explain your answer briefly.</em>
False.<br />
From Keyfitz we know that the average growth rate of a heterogeneous population is: <span class="math display">\[\bar{r}(t)=\frac{\sum_i{Q_i}{r_i}e^{r_i{t}}}{\sum_i{Q_i}e^{r_i{t}}}\]</span> Here, <span class="math inline">\(\bar{r}(t)\)</span> is not constant for all t as there is a compositional effect. This should be read as “If every part grows at a constant exponential rate, then the whole will also grow exponentially”. We could argue that only in the long term it is true.</p></li>
<li><p><em>List what you think are two of the best arguments in favor of doing a disaggregated projection? What are two of the best arguments in favor of doing an aggregated projection?</em></p>
<ol style="list-style-type: lower-alpha">
<li>Disaggregated projections:
<ol style="list-style-type: lower-roman">
<li>Reveal the “true” path, patterns of individuals different from that of the aggregate.<br />
</li>
<li>Take into account size of each sub-population, in particular the smaller ones.<br />
</li>
<li>Are more precise. Growth rates for sub-populations reflect their intrinsic characteristics, such that projections that do not use appropriate rates can lead to adverse social/policy implications.<br />
</li>
</ol></li>
<li>Aggregated projections:
<ol style="list-style-type: lower-roman">
<li>May used if a population is homogeneous rather than projecting many models for sub-populations.<br />
</li>
<li>Provide a straightforward method of obtaining overall rates rather than the group-specific rates.</li>
<li>Are easier to implement as more data available.</li>
</ol></li>
</ol></li>
<li><p><em>There are two countries, <span class="math inline">\(u\)</span> and <span class="math inline">\(m\)</span>, each with growth rates <span class="math inline">\(r_u = .0075\)</span>, <span class="math inline">\(r_m = 0.035\)</span>, and population sizes in 1970 of <span class="math inline">\(K_u(1970) = 200\)</span>, <span class="math inline">\(K_m(1970) = 50\)</span>. Use the first few years of the projection to verify that rate of change in the aggregate growth rate equals the variance of the growth rate. Does it matter what time points and period you consider?</em><br />
From the information given, we can obtain <span class="math inline">\(\bar{r}(t)\)</span> and <span class="math inline">\(\sigma_r^2(t)\)</span> by projecting each country’s population using individual rates and then obtaining the total population, <span class="math display">\[\bar{K}(t)= \sum_{i\in\{u,m\}}K_{i}(t) = \sum_{i\in\{u,m\}}K_{i}e^{r_{i} t}\]</span> Applying the formula for aggregate growth rate to the USA-Mexico case we get:
<span class="math display">\[\begin{aligned}
 \bar{r}(t) &amp; = \frac{\frac{d}{dt}\bar{K}(t)}{\bar{K}(t)}\\
 &amp; = \frac{K_u(0) r_u(t) e^{r_u(t) t} + K_m(0) r_m(t) e^{r_m(t) t}}{K_u(0) e^{r_u(t) t} + K_m(0) e^{r_m (t) t}}
 \end{aligned}\]</span> For simplicity, time 0 is the year 1970 such that the proyection goes from 1971 (t=1) until 2020 (t=50).<br />
Then, we can calculate the variance of the growth rates as:
<span class="math display">\[\begin{aligned}
 \sigma_r^2(t) &amp;= \frac{{K_u(0) e^{r_u(t) t}(r_u(t) - \bar{r}(t))^2 + K_m(0) e^{r_m(t) t}(r_m(t) - \bar{r}(t))^2}} { {K_u(0) e^{r_u(t) t} + K_m(0) e^{r_m(t) t}}} \\ 
 &amp;= \frac{K_u(t) r_u(t)^2 + K_m(t) r_u(t)^2}{K_u(t)+K_m(t)}-\bar{r}(t)^2 
 \end{aligned}\]</span>
The table below show these results for projections at the beginning and ending of a 50 year period. Overall, the time points do not matter and we can verify that <span class="math inline">\(\frac{d\bar{r}(t)}{d(t)}=\sigma_r^2(t)\)</span></p>
<table style="width:100%;">
<colgroup>
<col width="3%" />
<col width="15%" />
<col width="8%" />
<col width="8%" />
<col width="12%" />
<col width="26%" />
<col width="12%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(t\)</span></th>
<th><span class="math inline">\(\sigma^2_r(t)\)</span></th>
<th><span class="math inline">\(K_u(t)\)</span></th>
<th><span class="math inline">\(K_m(t)\)</span></th>
<th><span class="math inline">\(\bar{K}(t)\)</span></th>
<th><span class="math inline">\(\bar{K}(t)-\bar{K}(t-1)\)</span></th>
<th><span class="math inline">\(\bar{r}(t)\)</span></th>
<th><span class="math inline">\(\bar{r}&#39;(t)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.00021</td>
<td>200</td>
<td>50</td>
<td>250</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>l</td>
<td>0.000123</td>
<td>201.506</td>
<td>51.781</td>
<td>253.287</td>
<td>3.2866</td>
<td>0.0131</td>
<td></td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.000125</td>
<td>203.023</td>
<td>53.625</td>
<td>256.648</td>
<td>3.3614</td>
<td>0.0132</td>
<td>0.0001</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.000127</td>
<td>204.551</td>
<td>55.536</td>
<td>260.087</td>
<td>3.4385</td>
<td>0.0133</td>
<td>0.0001</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="even">
<td>49</td>
<td>0.000189</td>
<td>288.824</td>
<td>277.833</td>
<td>566.658</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>50</td>
<td>0.000189</td>
<td>290.998</td>
<td>287.730</td>
<td>578.728</td>
<td>12.071</td>
<td>0.0211</td>
<td></td>
</tr>
<tr class="even">
<td>51</td>
<td>0.000189</td>
<td>293.189</td>
<td>297.979</td>
<td>591.168</td>
<td>12.440</td>
<td>0.0213</td>
<td>0.0002</td>
</tr>
</tbody>
</table></li>
<li><p><em>Using the information from question 3, notice that the growth rate changes over the course of the 50 years, but there is a constant growth rate that will produce the exact same population after 50 years. A reasonable choice of the constant growth rate to apply is the value of the changing growth rate at year 25 (half-way through the period). We can estimate this using a Taylor series approximation:</em> <span class="math display">\[ \bar{r}(25) \approx \bar{r}(0) + 25\bar{r}&#39;(0) + (25)^2 \bar{r}&#39;&#39;(0) \]</span></p>
<ol style="list-style-type: lower-alpha">
<li><em>Show that <span class="math inline">\(\bar{r}&#39;&#39;(t) = \bar{r}_3(t) - \bar{r}_2(t) \bar{r}(t) - 2 \bar{r}(t) \sigma^2_r(t)\)</span></em><br />
From before, we know that for <span class="math inline">\(i\in\{u,m\}\)</span>:
<span class="math display">\[\begin{aligned}
 \sigma_r^2(t) &amp;= \bar{r}&#39;(t) \\
 &amp; = \frac{d}{dt}\left[ \frac{ \sum K_i r_i e^{r_i t}} {\sum K_i  e^{r_i t}} \right]\\
 &amp; = \frac{\sum K_i(0)r_i^2e^{r_it}} {\sum K_i(0)e^{r_it}} - \left(\frac{ \sum K_i(0)r_ie^{r_it}} {\sum K_i(0)e^{r_it}}\right)^2 \\
 &amp; = \frac{\sum K_i(0)r_i^2e^{r_it}} {\sum K_i(0)e^{r_it}} - \bar{r}^2(t) 
 \end{aligned}\]</span>
Then, we take the second derivative of the growth rate by using the quotient rule <span class="math inline">\(\left(\frac{u}{v}\right)&#39;= \frac{u&#39;v-vu&#39;}{v^2}\)</span>:
<span class="math display">\[\begin{aligned}
 \bar{r}&#39;&#39;(t) &amp;= { \frac{\left(\sum K_i(0)e^{r_it}\right)(\sum K_i(0)r_i^3e^{r_it}) -(\sum K_i(0)r_i^2e^{r_it})(\sum K_i(0)r_i e^{r_it})}  {(\sum K_i(0)e^{r_it})^2 }} - 2\bar{r}(t)\times\bar{r}&#39;(t)\\ 
 &amp;= \frac{ \sum K_i(0)r_i^3e^{r_it}} {\sum K_i(0)e^{r_it} } - \frac{ \sum K_i(0)r_i^2e^{r_it}} {\sum K_i(0)e^{r_it}}\times \frac{\sum K_i(0)r_i e^{r_it}}{\sum K_i(0)e^{r_it} } - 2\bar{r}(t)\sigma^2_r(t) \\
 &amp;= \bar{r}_3 (t) - \bar{r}_2(t)\bar{r}(t) - 2\bar{r}(t)\sigma^2_r(t)
 \end{aligned}\]</span>
where <span class="math inline">\(\bar{r}_n\)</span> is the <span class="math inline">\(n\)</span>th moment of <span class="math inline">\(\bar{r}(t)\)</span>, and it is known that <span class="math inline">\(\bar{r}&#39;(t) = \sigma^2_r(t)\)</span>.<br />
</li>
<li><em>Calculate the combined US-Mexico population after 50 years according to the following five (5) methods, plot the total population after 50 years according to these 5 methods on a graph.</em>
For the following exercises, the population is in millions.
<ol style="list-style-type: lower-roman">
<li><em>Dissaggregated (“true”) forecast, with each country growing at its own rate:</em><br />
<span class="math display">\[\begin{aligned}
 \bar{K}(2020) &amp;= K_u(2020) + K_m(2020)\\ 
 &amp;=K_u(1970) e^{(2020-1970)r_u} + K_m(1970) e^{(2020-1970)r_m}\\
 &amp;=200e^{.0075\times 50} + 50e^{.035\times 50}\\
 &amp;= 578.728 
 \end{aligned}\]</span><br />
</li>
<li><em>Aggregated forecast, pretending it’s one country, growing at <span class="math inline">\(\bar{r}(0)\)</span>) for 50 years:</em><br />
<span class="math display">\[\begin{aligned}
 \overline{r}(1970) &amp;= \frac{\sum K_i(1970)r_i e^{r_i (1970-1970)}} {\sum K_i(1970)e^{r_i (1970-1970) }}\\
 &amp;=\frac{K_u(1970)r_u + K_m(1970)r_m }{K_u(1970) + K_m(1970) }\\
 &amp; =  \frac{ 200\times .0075 + 50\times.035} {200+50 } = 0.013
 \end{aligned}\]</span>
<span class="math display">\[\begin{aligned}
 \bar{K}(2020) &amp;= \bar{K}(1970)e^{\bar{r}(1970) (2020-1970)}\\
 &amp;= 250  e^{.013\times 50} \approx 478.8852
 \end{aligned}\]</span><br />
</li>
<li><em>Aggregated forecast, growing at the “true” value of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period. (Use the value of <span class="math inline">\(\bar{r}(25)\)</span>) that you calculate from the disaggregated forecast):</em>
Translating <span class="math inline">\(\bar{r}(25)\)</span> onto the 1970 timeline, we should look at <span class="math inline">\(\bar{r}(1995)\)</span>
<span class="math display">\[\begin{aligned}
 \bar{r}(1995) &amp;= \sum K_i(1970)r_i e^{r_i (1995-1970)} \over \sum K_i(1970)e^{r_i (1995-1970) }\\
 &amp; = \frac{K_u(1970)r_u e^{r_u (25)} + K_m(1970)r_m e^{r_m (25)} }{K_u(1970)e^{r_u (25)} + K_m(1970)e^{r_m (25)} }\\ 
 &amp; =\frac{200\times.0075 e^{.0075\left(25\right)}+50\times.035 e^{.035\left(25\right)}}{200 e^{.0075\left(25\right)}+50 e^{.035\left(25\right)}} \approx 0.0176632\\
 \bar{K}(2020) &amp;= 250e^{0.016632(50)} \approx 574.25316
 \end{aligned}\]</span><br />
</li>
<li><em>Aggregated forecast, growing at the first-order Taylor series estimate of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period:</em><br />
<span class="math display">\[\begin{aligned}
 \sigma^2_r(1970) &amp;= \frac{K_u(1970)r_u^2 + K_m(1970)r_m^2} {K_u(1970) + K_m(1970)} - \bar{r}^2(0) \\
 &amp; =  \frac{(200)(0.0075)^2 + (50)(0.035)^2}{250}-(0.013)^2 \\
 &amp; = 0.000121 \\
 \hat{\bar{r}}(1995) &amp; \approx \bar{r}(1970) + 25\sigma^2_r(1970) =  0.016025 \\ 
 \bar{K}(2020) &amp;= 250 e^{0.016025(50)} \approx 557.0811485
 \end{aligned}\]</span><br />
</li>
<li><em>Aggregated forecast, growing at the second-order Taylor series estimate of <span class="math inline">\(\bar{r}(25)\)</span> for the whole period:</em><br />
For this exercise we need to first calculate the extra second-order term from the Taylor series, <span class="math inline">\(25^2\bar{r}&#39;&#39;(0)\)</span>:<br />
<span class="math display">\[\begin{aligned}
 \bar{r}&#39;&#39;(1970) &amp;= \frac{200(0.0075)^3+50(0.035)^3}{250} - \frac{200(0.0075)^2+50(0.035)^2}{250} \times (0.013) - 2(0.013)(0.000121)\\
 \hat{\bar{r}}(1995) &amp; \approx \bar{r}(1970) + 25\sigma^2_r(1970) +(25)^2\bar{r}&#39;&#39;(1970) \\
 &amp; =  0.01664891\\
 \bar{K}(2020) &amp;= 250 e^{0.01664891(50)} \\
 &amp; \approx 574.73337 \\
 \end{aligned}\]</span><br />
</li>
<li><em>Graphs</em><br />
There are many methods to project populations.
<img src="figures/problemset1_pp1.png" width="100%" /><img src="figures/problemset1_pp2.png" width="100%" /></li>
</ol></li>
</ol></li>
<li><p><em>For Ken’s Poisson-Exponential model,</em></p>
<ol style="list-style-type: lower-alpha">
<li><em>What is the closed-form expression for <span class="math inline">\(\hat{r}(t)\)</span></em><br />
<span class="math display">\[\begin{aligned}
 \hat{r}(t) &amp;= \frac{d}{dt}log(\hat{k})\\
 &amp;= r_0 - \alpha \lambda e^{-\alpha t}
 \end{aligned}\]</span></li>
<li><em>What is the variance of the growth rate?</em><br />
The variance of the growth rate is <span class="math inline">\(\sigma_r^2(t)\)</span>:
<span class="math display">\[\bar{r}&#39;(t)= \sigma^2_r(t) = \alpha^2\lambda e^{-\alpha t}\]</span></li>
<li><em>Write down an expression for the distortion index. What variables and parameters in the model does it depend on? Are there any variables or parameters that it doesn’t depend on? (difference of <span class="math inline">\(\bar{r}(t)\)</span> and <span class="math inline">\(\bar{r}(0)\)</span>)</em><br />
Distortion index:
<span class="math display">\[\begin{aligned}
 \bar{r}(t) - \bar{r}(0) &amp; = r_0 - \lambda \alpha e^{-\alpha t} - (r_0 - \lambda \alpha e^{0}) \\
 &amp; = \lambda \alpha - \lambda \alpha e^{-\alpha t}\\
 &amp; = \lambda \alpha(1-e^{-\alpha t})
 \end{aligned}\]</span>
Depends on <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(t\)</span>, but not <span class="math inline">\(r_0\)</span> or <span class="math inline">\(s\)</span>. That is, it depends on the the gap between growth rates, the relative population sizes, fastest growth rate, the poisson distribution parameter, but not the poisson distributed integers.</li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frailty.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-heterogeneity.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
