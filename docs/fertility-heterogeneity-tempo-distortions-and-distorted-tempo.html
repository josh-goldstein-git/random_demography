<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Fertility Heterogeneity: Tempo Distortions and Distorted Tempo | Mathematical Demography</title>
  <meta name="description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Fertility Heterogeneity: Tempo Distortions and Distorted Tempo | Mathematical Demography" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Fertility Heterogeneity: Tempo Distortions and Distorted Tempo | Mathematical Demography" />
  
  <meta name="twitter:description" content="This is a book from the Mathematical Demography lecture notes." />
  

<meta name="author" content="Josh R. Goldstein" />


<meta name="date" content="2020-12-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mortality-plateaus.html"/>
<link rel="next" href="branching-processes.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Random Demography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Demographic Heterogeneity</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#part-i.-conceptual-introduction"><i class="fa fa-check"></i><b>2.2</b> Part I. Conceptual Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#what-is-demographic-heterogeneity"><i class="fa fa-check"></i><b>2.2.1</b> What is Demographic Heterogeneity?</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#analogies"><i class="fa fa-check"></i><b>2.2.2</b> Analogies</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#whats-new"><i class="fa fa-check"></i><b>2.2.3</b> What’s new?</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#application"><i class="fa fa-check"></i><b>2.2.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#part-ii.-formal-analysis"><i class="fa fa-check"></i><b>2.3</b> Part II. Formal Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#outline-1"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#keyfitz-result"><i class="fa fa-check"></i><b>2.3.2</b> Keyfitz result</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#us-mexico-example"><i class="fa fa-check"></i><b>2.3.3</b> US-Mexico Example</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#the-origin-of-professor-wachters-poisson-exponential-model"><i class="fa fa-check"></i><b>2.3.4</b> The Origin of Professor Wachter’s Poisson-Exponential Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#some-commentary"><i class="fa fa-check"></i><b>2.3.5</b> Some commentary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#questions"><i class="fa fa-check"></i><b>2.5</b> Questions</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#solutions"><i class="fa fa-check"></i><b>2.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>3</b> Multiplicative Fixed Frailty</a><ul>
<li class="chapter" data-level="3.1" data-path="frailty.html"><a href="frailty.html#outline-2"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frailty.html"><a href="frailty.html#review-of-mortality-mathematics"><i class="fa fa-check"></i><b>3.1.1</b> Review of mortality mathematics</a></li>
<li class="chapter" data-level="3.1.2" data-path="frailty.html"><a href="frailty.html#application-what-is-ellx"><i class="fa fa-check"></i><b>3.1.2</b> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="frailty.html"><a href="frailty.html#extending-keyfitz-to-mortality"><i class="fa fa-check"></i><b>3.1.3</b> Extending Keyfitz to mortality</a></li>
<li class="chapter" data-level="3.1.4" data-path="frailty.html"><a href="frailty.html#multiplicative-fixed-frailty"><i class="fa fa-check"></i><b>3.1.4</b> Multiplicative Fixed frailty</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frailty.html"><a href="frailty.html#part-i.-results-from-fixed-frailty"><i class="fa fa-check"></i><b>3.2</b> Part I. Results from Fixed Frailty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frailty.html"><a href="frailty.html#a-simulation"><i class="fa fa-check"></i><b>3.2.1</b> A simulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="frailty.html"><a href="frailty.html#lets-derive-pop-survival-note-bars-barell"><i class="fa fa-check"></i><b>3.2.2</b> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="frailty.html"><a href="frailty.html#now-population-hazards-stepping-stones"><i class="fa fa-check"></i><b>3.2.3</b> Now population hazards (stepping stones)</a></li>
<li class="chapter" data-level="3.2.4" data-path="frailty.html"><a href="frailty.html#rodriguez-question"><i class="fa fa-check"></i><b>3.2.4</b> Rodriguez question</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frailty.html"><a href="frailty.html#part-ii.-introduction-to-gamma-frailty"><i class="fa fa-check"></i><b>3.3</b> Part II. Introduction to Gamma Frailty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frailty.html"><a href="frailty.html#the-gamma-distribution"><i class="fa fa-check"></i><b>3.3.1</b> The Gamma distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="frailty.html"><a href="frailty.html#gamma-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Gamma in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="frailty.html"><a href="frailty.html#population-survival-of-gamma-frailty"><i class="fa fa-check"></i><b>3.3.3</b> Population Survival of Gamma Frailty</a></li>
<li class="chapter" data-level="3.3.4" data-path="frailty.html"><a href="frailty.html#interpreting-gamma-frailty-survival"><i class="fa fa-check"></i><b>3.3.4</b> Interpreting Gamma-frailty survival</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frailty.html"><a href="frailty.html#conclusions-1"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
<li class="chapter" data-level="3.5" data-path="frailty.html"><a href="frailty.html#questions-1"><i class="fa fa-check"></i><b>3.5</b> Questions</a></li>
<li class="chapter" data-level="3.6" data-path="frailty.html"><a href="frailty.html#solutions-1"><i class="fa fa-check"></i><b>3.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html"><i class="fa fa-check"></i><b>4</b> Gamma Frailty with Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#from-survival-to-hazards"><i class="fa fa-check"></i><b>4.1</b> From survival to hazards</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#what-happens-to-frailty-of-survivors"><i class="fa fa-check"></i><b>4.1.1</b> What happens to frailty of survivors?</a></li>
<li class="chapter" data-level="4.1.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#average-frailty-in-terms-of-survival"><i class="fa fa-check"></i><b>4.1.2</b> Average frailty in terms of survival</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#censoc-selection-and-observed-frailty"><i class="fa fa-check"></i><b>4.2</b> CenSoc: Selection and observed frailty</a><ul>
<li class="chapter" data-level="4.2.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#data"><i class="fa fa-check"></i><b>4.2.1</b> Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#estimation"><i class="fa fa-check"></i><b>4.2.2</b> Estimation</a></li>
<li class="chapter" data-level="4.2.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#discuss-our-conclusions-and-possible-future-directions-to-follow."><i class="fa fa-check"></i><b>4.2.3</b> Discuss our conclusions and possible future directions to follow.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#questions-2"><i class="fa fa-check"></i><b>4.3</b> Questions</a></li>
<li class="chapter" data-level="4.4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#solutions-2"><i class="fa fa-check"></i><b>4.4</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html"><i class="fa fa-check"></i><b>5</b> Convergence and cross-overs</a><ul>
<li class="chapter" data-level="5.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#outline-3"><i class="fa fa-check"></i><b>5.1</b> Outline</a></li>
<li class="chapter" data-level="5.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#what-happens-to-mortality-disparities-at-older-ages"><i class="fa fa-check"></i><b>5.2</b> What happens to mortality disparities at older ages?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-possible-null-model"><i class="fa fa-check"></i><b>5.2.1</b> A possible null-model</a></li>
<li class="chapter" data-level="5.2.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-result-5e---vaupel2014unobserved-eq-38"><i class="fa fa-check"></i><b>5.2.2</b> A result: (5E - <span class="citation">Vaupel and Missov (<span>2014</span>)</span> (Eq 38))</a></li>
<li class="chapter" data-level="5.2.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#inversion"><i class="fa fa-check"></i><b>5.2.3</b> Inversion</a></li>
<li class="chapter" data-level="5.2.4" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#an-example-1"><i class="fa fa-check"></i><b>5.2.4</b> An example</a></li>
<li class="chapter" data-level="5.2.5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#application-1"><i class="fa fa-check"></i><b>5.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#student-presentation"><i class="fa fa-check"></i><b>5.3</b> Student Presentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html"><i class="fa fa-check"></i><b>6</b> Mortality plateaus</a><ul>
<li class="chapter" data-level="6.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-4"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#heterogeneity-slows-mortality-improvement"><i class="fa fa-check"></i><b>6.2</b> Heterogeneity slows mortality improvement</a><ul>
<li class="chapter" data-level="6.2.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#an-example-2"><i class="fa fa-check"></i><b>6.2.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#conclusions-2"><i class="fa fa-check"></i><b>6.3</b> Conclusions</a></li>
<li class="chapter" data-level="6.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#hazards-and-plateaus-by-professor-ken-wachter"><i class="fa fa-check"></i><b>6.4</b> Hazards and Plateaus by Professor Ken Wachter</a><ul>
<li class="chapter" data-level="6.4.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-5"><i class="fa fa-check"></i><b>6.4.1</b> Outline</a></li>
<li class="chapter" data-level="6.4.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#extremes-of-longevity-in-humans-and-other-species"><i class="fa fa-check"></i><b>6.4.2</b> Extremes of Longevity in Humans and Other Species</a></li>
<li class="chapter" data-level="6.4.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#gamma-gompertz-fixed-frailty-hazards"><i class="fa fa-check"></i><b>6.4.3</b> Gamma-Gompertz Fixed Frailty Hazards</a></li>
<li class="chapter" data-level="6.4.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#less-restrictive-frailty-models"><i class="fa fa-check"></i><b>6.4.4</b> Less Restrictive Frailty Models</a></li>
<li class="chapter" data-level="6.4.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#mutation-accumulation-gompertz-hazards-with-plateaus"><i class="fa fa-check"></i><b>6.4.5</b> Mutation Accumulation, Gompertz Hazards with Plateaus</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#key-points"><i class="fa fa-check"></i><b>6.5</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><i class="fa fa-check"></i><b>7</b> Fertility Heterogeneity: Tempo Distortions and Distorted Tempo</a><ul>
<li class="chapter" data-level="7.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#outline-6"><i class="fa fa-check"></i><b>7.1</b> Outline</a></li>
<li class="chapter" data-level="7.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#fertility-postponement-a-very-simple-example"><i class="fa fa-check"></i><b>7.2.1</b> Fertility postponement, a very simple example</a></li>
<li class="chapter" data-level="7.2.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#continuous-postponement-a-shiny-simulation"><i class="fa fa-check"></i><b>7.2.2</b> Continuous postponement, a shiny simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#period-shifts-bongaarts-and-feeneys-model"><i class="fa fa-check"></i><b>7.3</b> Period Shifts: Bongaarts and Feeney’s model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here"><i class="fa fa-check"></i><b>7.3.1</b> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></a></li>
<li class="chapter" data-level="7.3.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#tempo-adjusted-tfr"><i class="fa fa-check"></i><b>7.3.2</b> Tempo-adjusted TFR:</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-application-to-the-united-states"><i class="fa fa-check"></i><b>7.4</b> An Application to the United States</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-3"><i class="fa fa-check"></i><b>7.4.1</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#two-americas"><i class="fa fa-check"></i><b>7.5</b> Two Americas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#mixture"><i class="fa fa-check"></i><b>7.5.1</b> Mixture</a></li>
<li class="chapter" data-level="7.5.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-algorithm-for-tempo-adjustment-of-mixtures"><i class="fa fa-check"></i><b>7.5.2</b> An algorithm for tempo adjustment of mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-4"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a><ul>
<li class="chapter" data-level="7.6.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#caveats"><i class="fa fa-check"></i><b>7.6.1</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#questions-3"><i class="fa fa-check"></i><b>7.7</b> Questions</a></li>
<li class="chapter" data-level="7.8" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#solutions-3"><i class="fa fa-check"></i><b>7.8</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="branching-processes.html"><a href="branching-processes.html"><i class="fa fa-check"></i><b>8</b> Branching Processes</a><ul>
<li class="chapter" data-level="8.1" data-path="branching-processes.html"><a href="branching-processes.html#outline-7"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="branching-processes.html"><a href="branching-processes.html#motivation"><i class="fa fa-check"></i><b>8.2</b> Motivation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="branching-processes.html"><a href="branching-processes.html#very-brief-history-of-branching-processes"><i class="fa fa-check"></i><b>8.2.1</b> Very brief history of Branching Processes</a></li>
<li class="chapter" data-level="8.2.2" data-path="branching-processes.html"><a href="branching-processes.html#applicability-to-the-coronavirus-yes-and-no."><i class="fa fa-check"></i><b>8.2.2</b> Applicability to the Coronavirus? Yes and no.</a></li>
<li class="chapter" data-level="8.2.3" data-path="branching-processes.html"><a href="branching-processes.html#simulated-examples-and-the-questions-they-raise"><i class="fa fa-check"></i><b>8.2.3</b> Simulated examples and the questions they raise</a></li>
<li class="chapter" data-level="8.2.4" data-path="branching-processes.html"><a href="branching-processes.html#what-is-a-bienayme-galton-watson-branching-process"><i class="fa fa-check"></i><b>8.2.4</b> What is a (Bienayme)-Galton-Watson branching process?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="branching-processes.html"><a href="branching-processes.html#simulations-of-parents-having-children"><i class="fa fa-check"></i><b>8.3</b> Simulations of parents having children</a></li>
<li class="chapter" data-level="8.4" data-path="branching-processes.html"><a href="branching-processes.html#the-probability-generating-function-our-mathematical-tool"><i class="fa fa-check"></i><b>8.4</b> The Probability Generating Function: Our mathematical tool</a></li>
<li class="chapter" data-level="8.5" data-path="branching-processes.html"><a href="branching-processes.html#extinction"><i class="fa fa-check"></i><b>8.5</b> Extinction</a></li>
<li class="chapter" data-level="8.6" data-path="branching-processes.html"><a href="branching-processes.html#good-and-bad-set-ups-for-branching-process"><i class="fa fa-check"></i><b>8.6</b> Good and bad set-ups for branching process</a></li>
<li class="chapter" data-level="8.7" data-path="branching-processes.html"><a href="branching-processes.html#the-distribution-of-offspring-of-all-generations"><i class="fa fa-check"></i><b>8.7</b> The distribution of offspring of all generations</a><ul>
<li class="chapter" data-level="8.7.1" data-path="branching-processes.html"><a href="branching-processes.html#proving-mathbbe-z_n-mn"><i class="fa fa-check"></i><b>8.7.1</b> Proving <span class="math inline">\(\mathbb{E} Z_n = m^n\)</span></a></li>
<li class="chapter" data-level="8.7.2" data-path="branching-processes.html"><a href="branching-processes.html#variance-result."><i class="fa fa-check"></i><b>8.7.2</b> Variance result.</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="branching-processes.html"><a href="branching-processes.html#geometric-offspring-distribution"><i class="fa fa-check"></i><b>8.8</b> Geometric offspring distribution</a><ul>
<li class="chapter" data-level="8.8.1" data-path="branching-processes.html"><a href="branching-processes.html#the-geometric-distributions-simple-pgf"><i class="fa fa-check"></i><b>8.8.1</b> The Geometric Distribution’s simple PGF</a></li>
<li class="chapter" data-level="8.8.2" data-path="branching-processes.html"><a href="branching-processes.html#a-plot-of-keyfitzs-numbers-for-generations-1-2-and-3.-is-it-exponential-for-k-0"><i class="fa fa-check"></i><b>8.8.2</b> A plot of Keyfitz’s numbers for generations 1, 2, and 3. Is it exponential for <span class="math inline">\(k &gt; 0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="branching-processes.html"><a href="branching-processes.html#branching-processes-and-covid-19"><i class="fa fa-check"></i><b>8.9</b> Branching Processes and Covid-19</a></li>
<li class="chapter" data-level="8.10" data-path="branching-processes.html"><a href="branching-processes.html#problems"><i class="fa fa-check"></i><b>8.10</b> Problems</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fisher-wright.html"><a href="fisher-wright.html"><i class="fa fa-check"></i><b>9</b> Fisher-Wright</a><ul>
<li class="chapter" data-level="9.1" data-path="fisher-wright.html"><a href="fisher-wright.html#outline-8"><i class="fa fa-check"></i><b>9.1</b> Outline</a></li>
<li class="chapter" data-level="9.2" data-path="fisher-wright.html"><a href="fisher-wright.html#parallel"><i class="fa fa-check"></i><b>9.2</b> Parallel</a><ul>
<li class="chapter" data-level="9.2.1" data-path="fisher-wright.html"><a href="fisher-wright.html#another-cell-phone-example"><i class="fa fa-check"></i><b>9.2.1</b> Another cell phone example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="fisher-wright.html"><a href="fisher-wright.html#mutation"><i class="fa fa-check"></i><b>9.3</b> Mutation</a></li>
<li class="chapter" data-level="9.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fixation"><i class="fa fa-check"></i><b>9.4</b> Fixation</a><ul>
<li class="chapter" data-level="9.4.1" data-path="fisher-wright.html"><a href="fisher-wright.html#probability-that-a-particular-line-will-fix"><i class="fa fa-check"></i><b>9.4.1</b> Probability that a particular line will “fix”</a></li>
<li class="chapter" data-level="9.4.2" data-path="fisher-wright.html"><a href="fisher-wright.html#expected-time-until-fixation"><i class="fa fa-check"></i><b>9.4.2</b> Expected time until fixation?</a></li>
<li class="chapter" data-level="9.4.3" data-path="fisher-wright.html"><a href="fisher-wright.html#path-to-fixation-a-measure-of-homogeneityheterogeneity"><i class="fa fa-check"></i><b>9.4.3</b> Path to fixation: a measure of homogeneity/heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="fisher-wright.html"><a href="fisher-wright.html#baby-names"><i class="fa fa-check"></i><b>9.5</b> Baby Names</a><ul>
<li class="chapter" data-level="9.5.1" data-path="fisher-wright.html"><a href="fisher-wright.html#basic-idea"><i class="fa fa-check"></i><b>9.5.1</b> Basic idea</a></li>
<li class="chapter" data-level="9.5.2" data-path="fisher-wright.html"><a href="fisher-wright.html#fisher-wright-simulation-of-baby-names-hahn-and-bentley"><i class="fa fa-check"></i><b>9.5.2</b> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</a></li>
<li class="chapter" data-level="9.5.3" data-path="fisher-wright.html"><a href="fisher-wright.html#drawing-their-picture-with-simulation"><i class="fa fa-check"></i><b>9.5.3</b> Drawing their picture with simulation</a></li>
<li class="chapter" data-level="9.5.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fw-babyname-simulation-of-equilibrium-frequencies"><i class="fa fa-check"></i><b>9.5.4</b> FW babyname simulation of equilibrium frequencies</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="fisher-wright.html"><a href="fisher-wright.html#now-we-can-simulate-babyynmes"><i class="fa fa-check"></i><b>9.6</b> Now we can simulate babyynmes</a></li>
<li class="chapter" data-level="9.7" data-path="fisher-wright.html"><a href="fisher-wright.html#conclusions-5"><i class="fa fa-check"></i><b>9.7</b> Conclusions</a><ul>
<li class="chapter" data-level="9.7.1" data-path="fisher-wright.html"><a href="fisher-wright.html#some-potential-criticism"><i class="fa fa-check"></i><b>9.7.1</b> Some potential criticism</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="coalescent.html"><a href="coalescent.html"><i class="fa fa-check"></i><b>10</b> Coalescent</a><ul>
<li class="chapter" data-level="10.1" data-path="coalescent.html"><a href="coalescent.html#outline-9"><i class="fa fa-check"></i><b>10.1</b> Outline</a></li>
<li class="chapter" data-level="10.2" data-path="coalescent.html"><a href="coalescent.html#the-coalescent-expectations-of-the-past"><i class="fa fa-check"></i><b>10.2</b> The Coalescent: Expectations of the Past</a></li>
<li class="chapter" data-level="10.3" data-path="coalescent.html"><a href="coalescent.html#our-first-question-when-was-mrca"><i class="fa fa-check"></i><b>10.3</b> Our first question: When was MRCA?</a></li>
<li class="chapter" data-level="10.4" data-path="coalescent.html"><a href="coalescent.html#mutation-and-inference-of-tmrca-and-n"><i class="fa fa-check"></i><b>10.4</b> Mutation and inference of TMRCA and <span class="math inline">\(N\)</span></a><ul>
<li class="chapter" data-level="10.4.1" data-path="coalescent.html"><a href="coalescent.html#inference-of-population-size-simulation"><i class="fa fa-check"></i><b>10.4.1</b> Inference of population size (Simulation)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="coalescent.html"><a href="coalescent.html#coalescence-of-a-sample-of-n-individuals"><i class="fa fa-check"></i><b>10.5</b> Coalescence of a sample of <span class="math inline">\(n\)</span> individuals</a></li>
<li class="chapter" data-level="10.6" data-path="coalescent.html"><a href="coalescent.html#an-application-of-coalescent-theory"><i class="fa fa-check"></i><b>10.6</b> An application of coalescent theory</a><ul>
<li class="chapter" data-level="10.6.1" data-path="coalescent.html"><a href="coalescent.html#coalesence-when-population-is-changing"><i class="fa fa-check"></i><b>10.6.1</b> Coalesence when population is changing</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="coalescent.html"><a href="coalescent.html#reconstruction-ancient-european-population-sizes-using-batinis-sample-of-mitochondrial-dna"><i class="fa fa-check"></i><b>10.7</b> Reconstruction Ancient European Population Sizes using Batini’s sample of Mitochondrial DNA"</a><ul>
<li class="chapter" data-level="10.7.1" data-path="coalescent.html"><a href="coalescent.html#summary-of-batini-et-al."><i class="fa fa-check"></i><b>10.7.1</b> Summary of Batini et al.</a></li>
<li class="chapter" data-level="10.7.2" data-path="coalescent.html"><a href="coalescent.html#ancient-population-estimates"><i class="fa fa-check"></i><b>10.7.2</b> Ancient population estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="student-presentations.html"><a href="student-presentations.html"><i class="fa fa-check"></i><b>11</b> Student Presentations</a><ul>
<li class="chapter" data-level="11.1" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers"><i class="fa fa-check"></i><b>11.1</b> Mortality Crossovers</a><ul>
<li class="chapter" data-level="11.1.1" data-path="student-presentations.html"><a href="student-presentations.html#outline-10"><i class="fa fa-check"></i><b>11.1.1</b> Outline</a></li>
<li class="chapter" data-level="11.1.2" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers-reality-or-bad-data-coale1986mortality"><i class="fa fa-check"></i><b>11.1.2</b> <em>Mortality Crossovers: Reality or Bad Data?</em> <span class="citation">(Coale and Kisker <span>1986</span>)</span></a></li>
<li class="chapter" data-level="11.1.3" data-path="student-presentations.html"><a href="student-presentations.html#methods-for-evaluating-the-heterogeneity-of-aging-processes-in-human-populations-using-vital-statistics-data-explaining-the-blackwhite-mortality-crossover-by-a-model-of-mortality-selection-manton1981methods"><i class="fa fa-check"></i><b>11.1.3</b> <em>Methods for Evaluating the Heterogeneity of Aging Processes in Human Populations Using Vital Statistics Data: Explaining the Black/White Mortality Crossover by a Model of Mortality Selection</em> <span class="citation">(Manton and Stallard <span>1981</span>)</span></a></li>
<li class="chapter" data-level="11.1.4" data-path="student-presentations.html"><a href="student-presentations.html#censoc-mortality-crossovers"><i class="fa fa-check"></i><b>11.1.4</b> CenSoc Mortality Crossovers</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="student-presentations.html"><a href="student-presentations.html#plateaus"><i class="fa fa-check"></i><b>11.2</b> Plateaus</a></li>
<li class="chapter" data-level="11.3" data-path="student-presentations.html"><a href="student-presentations.html#rising-inequality"><i class="fa fa-check"></i><b>11.3</b> Rising Inequality</a><ul>
<li class="chapter" data-level="11.3.1" data-path="student-presentations.html"><a href="student-presentations.html#trends-in-mortality-differentials-and-life-expectancy-for-male-social-security-covered-workers-by-socioeconomic-status-waldron2007trends"><i class="fa fa-check"></i><b>11.3.1</b> <em>Trends in mortality differentials and life expectancy for male social security-covered workers, by socioeconomic status</em> <span class="citation">(Waldron <span>2007</span>)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html"><i class="fa fa-check"></i><b>12</b> Demographic theory and COVID-19</a><ul>
<li class="chapter" data-level="12.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#outline-11"><i class="fa fa-check"></i><b>12.1</b> Outline</a></li>
<li class="chapter" data-level="12.2" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#motivating-questions"><i class="fa fa-check"></i><b>12.2</b> Motivating questions</a></li>
<li class="chapter" data-level="12.3" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#population-aging"><i class="fa fa-check"></i><b>12.3</b> Population aging</a><ul>
<li class="chapter" data-level="12.3.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stable-theory"><i class="fa fa-check"></i><b>12.3.1</b> Stable theory</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#keyfitzs-entropy"><i class="fa fa-check"></i><b>12.4</b> Keyfitz’s entropy</a></li>
<li class="chapter" data-level="12.5" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#loss-of-person-years-remaining"><i class="fa fa-check"></i><b>12.5</b> Loss of person years remaining</a></li>
<li class="chapter" data-level="12.6" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stationary-theory"><i class="fa fa-check"></i><b>12.6</b> Stationary theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematical Demography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fertility-heterogeneity-tempo-distortions-and-distorted-tempo" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Fertility Heterogeneity: Tempo Distortions and Distorted Tempo</h1>
<div id="outline-6" class="section level2">
<h2><span class="header-section-number">7.1</span> Outline</h2>
<ul>
<li>Introduction and a tempo simulation</li>
<li>Bongaarts and Feeney’s formula</li>
<li>An application to the United States</li>
<li>Two Americas?</li>
<li>EM algorithm for unmixing mixtures</li>
<li>An application to two Americas.</li>
</ul>
<p>Additional resources:</p>
<ul>
<li><span class="citation">Sullivan (<a href="#ref-sullivan2005age" role="doc-biblioref">2005</a>)</span>: An early paper (by a Berkeley Demog student!) focusing on ﬁrst birth hazards.</li>
<li><span class="citation">Burkimsher (<a href="#ref-burkimsher2017evolution" role="doc-biblioref">2017</a>)</span>: A descriptive paper, which you can mostly skip. But see especially section 7, where she argues that her ﬁndings contradict Sullivan for the United States.</li>
<li><span class="citation">Hastie, Tibshirani, and Friedman (<a href="#ref-hastie2009elements" role="doc-biblioref">2009</a>)</span>: A textbook example of expectation-maximization algorithm applied to mixture of two normals in Section 8.5.</li>
<li>Victor Lavrenko. Youtube video : “EM algorithm: how it works” <a href="https://www.youtube.com/watch?v=REypj2sy_5U" class="uri">https://www.youtube.com/watch?v=REypj2sy_5U</a>.</li>
<li><span class="citation">Bongaarts and Feeney (<a href="#ref-bongaarts1998quantum" role="doc-biblioref">1998</a>)</span></li>
</ul>
</div>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Introduction</h2>
<p>What we see is superficial. Heterogeneous models reveal what’s “really” going on. (Or do they?).</p>
<ul>
<li>Until the past sections, population hazards mislead.</li>
<li>However in this section, homogeneous fertility misleads.</li>
</ul>
<p>We now reverse perspectives:</p>
<ul>
<li>We see differences we see in genotypes, in lineages, in names.</li>
<li>These could be due to “real” differences (heterogeneity).</li>
<li>But they could also be due to luck: everyone is the same but stochastic outcomes differ.</li>
<li>Our models of individual-level randomness will have predicted dynamics, which are themselves interesting but can also be used as a “null” to compare to observations.</li>
</ul>
<div id="fertility-postponement-a-very-simple-example" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Fertility postponement, a very simple example</h3>
<p>Baseline</p>
<ul>
<li>A population has a history of 1 birth per day</li>
<li>When women turn age 25, they have a daughter.</li>
<li>This gives us a constant stream of births, 365 per year.</li>
</ul>
<p>Postponement</p>
<ul>
<li>Starting on Jan. 1, 2020, everyone postpones childbearing an additional month, until they are aged 25 1/12.</li>
<li>How many births will there be in 2020?</li>
<li>How many births in 2021?</li>
</ul>
<p>As everybody postpones childbearing for a month, then the first birth of 2020 occurs on February 1st so that 31 babies have not been born by then.</p>
<p>This means that during 2020 there are <span class="math inline">\(365-31=334\)</span> births. For this year, births and total fertility rate decrease. However, the postponement doesn’t affect the birth stream in 2021 as there will still be one birth per day, even if in the absence of postponing these some of the births should’ve occured in 2020.</p>
</div>
<div id="continuous-postponement-a-shiny-simulation" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Continuous postponement, a shiny simulation</h3>
<p>To answer these questions, we can use the following shiny app.
<iframe src="https://shiny.demog.berkeley.edu/josh/tempo/" width="672" height="600px"></iframe></p>
<ul>
<li><p><span class="math inline">\(R(t)\)</span> Cumulative postponment</p></li>
<li><p><span class="math inline">\(r(t)\)</span> Incremental postponement <span class="math inline">\(r(t) = R&#39;(t)\)</span></p>
<p>What is a formula for recovering original birth stream?
<span class="math display">\[\begin{align}
\hat{B}_{orig} &amp;= B_{obs} \times (1 + R&#39;(t)) \\
\text{or}\\
\hat{B}_{orig} &amp;= B_{obs} \times 1/  \left[1 - R&#39;(t)\right]?
\end{align}\]</span></p>
<p>Note: this idea of ``recovering original’’ is one way to think
about tempo adjustment.</p></li>
</ul>
<p>We can think of the original version as that which should have ocurred in the absence of postponement. Intuitively, it should be higher than the observed birth stream, but how much larger? The table below shows an example of how to recover the original births where each formula refers to the equations above.</p>
<table>
<thead>
<tr>
<th style="text-align:right;">
r(t)
</th>
<th style="text-align:right;">
B(obs)
</th>
<th style="text-align:right;">
B(orig) formula 1
</th>
<th style="text-align:right;">
B(orig) formula 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
100.1
</td>
<td style="text-align:right;">
101.1111
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
84
</td>
<td style="text-align:right;">
100.8
</td>
<td style="text-align:right;">
105.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
77
</td>
<td style="text-align:right;">
100.1
</td>
<td style="text-align:right;">
110.0000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
100.8
</td>
<td style="text-align:right;">
120.0000
</td>
</tr>
</tbody>
</table>
<p>The correct formula is equation 2. <strong>NOTE: is this correct? If so, why?</strong></p>
</div>
</div>
<div id="period-shifts-bongaarts-and-feeneys-model" class="section level2">
<h2><span class="header-section-number">7.3</span> Period Shifts: Bongaarts and Feeney’s model</h2>
<p>In a bigger microsimulation</p>
<ul>
<li>Each period will have births across a range of ages</li>
<li>We’ll randomly generate the original planned birthdays</li>
<li>Then we’ll shift by a continuous function <span class="math inline">\(R(t)\)</span>.</li>
</ul>
<p>The birth rate of women, <span class="math inline">\(f(a,t)\)</span>, aged <span class="math inline">\(a\)</span> in period <span class="math inline">\(t\)</span> is:
<span class="math display">\[
  f(a,t) = f_0(a - R(t)) (1- R&#39;(t)) q(t)
  \]</span></p>
<p>Where</p>
<ul>
<li><span class="math inline">\(f_0\)</span>: constant baseline schedule (can be normalized to sum to 1).</li>
<li><span class="math inline">\(q(t)\)</span>: period intensity parameter: “quantum”</li>
<li><span class="math inline">\(R(t)\)</span>: cumulative shift.</li>
</ul>
<p>An example</p>
<p><span class="math display">\[
f(a,t) = f_0(a - R(t)) (1- R&#39;(t)) q(t)
\]</span></p>
<ul>
<li><span class="math inline">\(R_{2019} = 3\)</span></li>
<li><span class="math inline">\(R&#39;_{2019} = 0.1\)</span></li>
<li><span class="math inline">\(q(2019) = 1\)</span></li>
</ul>
<p>Give an expression for <span class="math inline">\(f(28,2019)\)</span></p>
<p><span class="math display">\[ \begin{aligned} 
 f(28,2019) &amp;= f_{0}(28-3)\times(1-0.1)\times(1) \\
  &amp; = (0.9)f_{0}(25)
 \end{aligned}\]</span></p>
<p>Therefore, the fertility rate for a 28 year-old in 2019 would be 0.9 of the baseline fertility rate at age 25. Another way of thinking about it is that had there been no postponement, the fertility rate that we are observing in 2019 for this 28 year-old would actually be similar to that of a 25 year old.</p>
<p>Small changes in the stock can have huge effect in the flows.</p>
<div id="a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here" class="section level3">
<h3><span class="header-section-number">7.3.1</span> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></h3>
<p>Assume no quantum effects (i.e, no <span class="math inline">\(q(t)\)</span>). Take a cohort with cumulative fertility</p>
<p><span class="math display">\[
  F_0(a) = \int_0^a f(x) \,dx
  \]</span></p>
<p>Now put in shifts so that observed fertility is from an age <span class="math inline">\(R(t)\)</span> years earlier. (“28” is the new “25”!)
<span class="math display">\[
  F(a,t) = F_0(a - R(t))  = F_0(a - R(c + a))
  \]</span></p>
<p>Differentiate with respect to age (which for a cohort is also time <span class="math inline">\(t\)</span>), using chain rule</p>
<p><span class="math display">\[ \begin{aligned}
  \frac{d }{dt}F(a,t)= f(a,t) &amp;= F&#39;_{0}(a-R(c+a))\times(1-R&#39;(c+a)) \\
  &amp;= f_0(a - R(t)) \left[1 - R&#39;(t)\right]
  \end{aligned}\]</span></p>
<p>Let’s re-notate our constant quantum result
<span class="math display">\[
  f_0(a,t | R(t) ) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]
  \]</span>
Then we can incorporate period quantum on the shifted surface:
<span class="math display">\[
  f(a,t) = f_0(a,t | R(t) ) q(t) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t)
  \]</span></p>
<p>Note: If we vary quantum before shifts, then <span class="math inline">\(q(t)\)</span> will bleed into neighboring years. (a small effect, but makes model
messier). <strong>NOTE: I don’t understand this, could you explain Josh?</strong></p>
</div>
<div id="tempo-adjusted-tfr" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Tempo-adjusted TFR:</h3>
<ul>
<li><p>counter-factual</p></li>
<li><p>TFR in absence of timing changes</p>
<p><span class="math display">\[
TFR(t) = \int_0^\infty f(a,t) \, da
\]</span></p>
<p>Substituting our shifted birth rates with quantum
<span class="math display">\[
\begin{aligned}
TFR(t) &amp;= \int_0^\infty f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t) da \\
&amp;=\left[1 - R&#39;(t)\right]q(t) \int_0^\infty f_0(a - R(t))  da \\
&amp;= TFR_0 \left[1 - R&#39;(t)\right] q(t)\\
\end{aligned}
\]</span>
Without loss of generality, define <span class="math inline">\(TFR_0 = 1\)</span>, then</p>
<p><span class="math display">\[
q(t) =   \frac{TFR(t)} {1 - R&#39;(t)} \equiv TFR^*(t) 
\]</span>
The observed <span class="math inline">\(TFR(t)\)</span> deflated by the rate of change (<span class="math inline">\(1 - R&#39;(t)\)</span>) is the BF formula.</p></li>
</ul>
<p>How do period schedules change?</p>
<p><span class="math display">\[
  f(a,t) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t)
  \]</span></p>
<p>What is <span class="math inline">\({\partial \over \partial t} \log f(a,t)\)</span>?</p>
<p>Solving</p>
<p><span class="math display">\[
  \begin{aligned}
  {\partial \over \partial t} \log f(a,t) &amp; = \frac{d}{dt}log(f_{0}(a-R(t))) + \frac{d}{dt}log(1-R&#39;(t)) + \frac{d}{dt}log(q(t)) \\
  &amp; = \frac{-f&#39;_{0}(a-R(t)) R&#39;(t)}{f_{0}(a-R(t))} - \frac{R&#39;&#39;(t)}{1-R&#39;(t)}+ \frac{q&#39;(t)}{q(t)}
  \end{aligned}
  \]</span></p>
<p>If we sketch this, where the age is on the x-axis, then the last two components affect the intercept of the curve. If births are postponed, <span class="math inline">\(R&#39;(t)&gt;0\)</span> but if they are actually advanced then <span class="math inline">\(R&#39;(t)&lt;0\)</span>, which affects the slope, <span class="math inline">\(\frac{\partial}{\partial t}\log f(a,t)\)</span>.</p>
<p><strong>Uniform shifts</strong></p>
<ul>
<li>BF model assumes all ages shift by <span class="math inline">\(R(t)\)</span>.</li>
<li>BF model assumes all ages rise or fall by same quantum <span class="math inline">\(q(t)\)</span></li>
<li>Violating these assumptions means change in mean age will not just reflect “tempo”.</li>
<li>Example: What happens if people have fewer higher order births?</li>
</ul>
<p><strong>BF recommendation for achieving uniformity</strong></p>
<p>Separate estimates for each birth order, and then combine:
<span class="math display">\[
  TFR^*(t) = \sum_i TFR_i^*(t) = \sum_i {TFR_i(t) \over 1 - r_i(t)}
  \]</span></p>
<p>This will protect against order-specific quantum effects.</p>
</div>
</div>
<div id="an-application-to-the-united-states" class="section level2">
<h2><span class="header-section-number">7.4</span> An Application to the United States</h2>
<p>Tempo adjustment of US fertility using HFD data using Bongaarts-Feeney formula:</p>
<p><em>1. Read in data and format into an array.</em></p>
<p>Below we show the period fertility rates for all parities at each age for 1933 and 1934 of US women.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb86-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-2"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb86-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-3"></a><span class="kw">library</span>(knitr)</span>
<span id="cb86-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-4"></a></span>
<span id="cb86-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-5"></a><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_functions.R&quot;</span>)</span>
<span id="cb86-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-6"></a><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/utility_functions.R&quot;</span>)</span>
<span id="cb86-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-7"></a></span>
<span id="cb86-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-8"></a><span class="co">## age specific fertility rates by birth order for all countries and times</span></span>
<span id="cb86-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-9"></a><span class="co">## RR means &quot;rectangles&quot; on Lexis surface</span></span>
<span id="cb86-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-10"></a>dt &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/data/zip_w/asfrRRbo.txt&quot;</span>, <span class="dt">showProgress =</span> <span class="ot">FALSE</span>)</span>
<span id="cb86-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-11"></a></span>
<span id="cb86-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-12"></a>dt &lt;-<span class="st"> </span>dt[Code <span class="op">==</span><span class="st"> &quot;USA&quot;</span>] <span class="co">## keep only US</span></span>
<span id="cb86-13"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-13"></a>dt &lt;-<span class="st"> </span>dt[Age <span class="op">%in%</span><span class="st"> </span><span class="dv">15</span><span class="op">:</span><span class="dv">49</span>] <span class="co">## keep only ages 15 to 49</span></span>
<span id="cb86-14"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-14"></a></span>
<span id="cb86-15"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-15"></a><span class="co">## put all order fertility into a matrix</span></span>
<span id="cb86-16"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-16"></a>fat &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)] <span class="co"># age (rows) by cohort year (column) matrix of ASFR</span></span>
<span id="cb86-17"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-17"></a>fat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">unclass</span>(fat)) </span>
<span id="cb86-18"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-18"></a>fat1 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR1 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)] <span class="co">#age specific fertility rates for parity = 1 </span></span>
<span id="cb86-19"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-19"></a>fat2 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR2 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</span>
<span id="cb86-20"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-20"></a>fat3 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR3 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</span>
<span id="cb86-21"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-21"></a>fat4 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR4 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</span>
<span id="cb86-22"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-22"></a>fat5p &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR5p <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</span>
<span id="cb86-23"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-23"></a>year.vec &lt;-<span class="st"> </span><span class="kw">colnames</span>(fat)</span>
<span id="cb86-24"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-24"></a>age.vec &lt;-<span class="st"> </span><span class="kw">rownames</span>(fat)</span>
<span id="cb86-25"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-25"></a>parity.vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</span>
<span id="cb86-26"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-26"></a>fat.array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="kw">nrow</span>(fat), <span class="kw">ncol</span>(fat), <span class="kw">length</span>(parity.vec)))</span>
<span id="cb86-27"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-27"></a><span class="kw">dimnames</span>(fat.array) &lt;-<span class="st"> </span><span class="kw">list</span>(age.vec, year.vec, parity.vec)</span>
<span id="cb86-28"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-28"></a>fat.array[,,<span class="st">&quot;all&quot;</span>] &lt;-<span class="st"> </span>fat</span>
<span id="cb86-29"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-29"></a>fat.array[,,<span class="st">&quot;1&quot;</span>] &lt;-<span class="st"> </span>fat1</span>
<span id="cb86-30"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-30"></a>fat.array[,,<span class="st">&quot;2&quot;</span>] &lt;-<span class="st"> </span>fat2</span>
<span id="cb86-31"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-31"></a>fat.array[,,<span class="st">&quot;3&quot;</span>] &lt;-<span class="st"> </span>fat3</span>
<span id="cb86-32"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-32"></a>fat.array[,,<span class="st">&quot;4&quot;</span>] &lt;-<span class="st"> </span>fat4</span>
<span id="cb86-33"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-33"></a>fat.array[,,<span class="st">&quot;5&quot;</span>] &lt;-<span class="st"> </span>fat5p</span>
<span id="cb86-34"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-34"></a></span>
<span id="cb86-35"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb86-35"></a><span class="kw">kable</span>(fat.array[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="st">&quot;all&quot;</span>], <span class="dt">caption=</span><span class="st">&quot;An extract of period age-specific fertility rates&quot;</span>) </span></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-79">Table 7.1: </span>An extract of period age-specific fertility rates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
1933
</th>
<th style="text-align:right;">
1934
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
0.00672
</td>
<td style="text-align:right;">
0.00715
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
0.01875
</td>
<td style="text-align:right;">
0.01991
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
0.03846
</td>
<td style="text-align:right;">
0.04062
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:right;">
0.06586
</td>
<td style="text-align:right;">
0.06957
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:right;">
0.08719
</td>
<td style="text-align:right;">
0.09155
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
0.10136
</td>
<td style="text-align:right;">
0.10749
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:right;">
0.10639
</td>
<td style="text-align:right;">
0.11296
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:right;">
0.11349
</td>
<td style="text-align:right;">
0.11807
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:right;">
0.11785
</td>
<td style="text-align:right;">
0.12034
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:right;">
0.11476
</td>
<td style="text-align:right;">
0.12208
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:right;">
0.11388
</td>
<td style="text-align:right;">
0.11536
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:right;">
0.10873
</td>
<td style="text-align:right;">
0.11399
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:right;">
0.10118
</td>
<td style="text-align:right;">
0.10487
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:right;">
0.10283
</td>
<td style="text-align:right;">
0.10554
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:right;">
0.09094
</td>
<td style="text-align:right;">
0.09483
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:right;">
0.09009
</td>
<td style="text-align:right;">
0.09330
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:right;">
0.06941
</td>
<td style="text-align:right;">
0.07239
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:right;">
0.07813
</td>
<td style="text-align:right;">
0.07541
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:right;">
0.07614
</td>
<td style="text-align:right;">
0.06993
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:right;">
0.06013
</td>
<td style="text-align:right;">
0.07248
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:right;">
0.06009
</td>
<td style="text-align:right;">
0.05676
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:right;">
0.05416
</td>
<td style="text-align:right;">
0.05401
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:right;">
0.04748
</td>
<td style="text-align:right;">
0.04670
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:right;">
0.04755
</td>
<td style="text-align:right;">
0.04769
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:right;">
0.03724
</td>
<td style="text-align:right;">
0.03752
</td>
</tr>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:right;">
0.03078
</td>
<td style="text-align:right;">
0.03024
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:right;">
0.01967
</td>
<td style="text-align:right;">
0.01963
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:right;">
0.01877
</td>
<td style="text-align:right;">
0.01874
</td>
</tr>
<tr>
<td style="text-align:left;">
43
</td>
<td style="text-align:right;">
0.01283
</td>
<td style="text-align:right;">
0.01235
</td>
</tr>
<tr>
<td style="text-align:left;">
44
</td>
<td style="text-align:right;">
0.00808
</td>
<td style="text-align:right;">
0.00789
</td>
</tr>
<tr>
<td style="text-align:left;">
45
</td>
<td style="text-align:right;">
0.00526
</td>
<td style="text-align:right;">
0.00491
</td>
</tr>
<tr>
<td style="text-align:left;">
46
</td>
<td style="text-align:right;">
0.00245
</td>
<td style="text-align:right;">
0.00242
</td>
</tr>
<tr>
<td style="text-align:left;">
47
</td>
<td style="text-align:right;">
0.00127
</td>
<td style="text-align:right;">
0.00122
</td>
</tr>
<tr>
<td style="text-align:left;">
48
</td>
<td style="text-align:right;">
0.00081
</td>
<td style="text-align:right;">
0.00087
</td>
</tr>
<tr>
<td style="text-align:left;">
49
</td>
<td style="text-align:right;">
0.00037
</td>
<td style="text-align:right;">
0.00037
</td>
</tr>
</tbody>
</table>
<p><em>2. Fit bongaarts feeney without birth order</em></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb87-1"></a>tfr.vec &lt;-<span class="st"> </span><span class="kw">colSums</span>(fat)          <span class="co"># total fertility rate for each cohort</span></span>
<span id="cb87-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb87-2"></a>mu.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(fat, <span class="dv">2</span>, get.mean) <span class="co"># mean age at childbearing</span></span>
<span id="cb87-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb87-3"></a>rt.vec &lt;-<span class="st"> </span><span class="kw">center.diff</span>(mu.vec)     <span class="co"># increments of postponement</span></span>
<span id="cb87-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb87-4"></a>adj.tfr.vec &lt;-<span class="st"> </span>tfr.vec <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rt.vec) <span class="co"># Assuming no quantum effect, tempo-adjusted TFR</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb88-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-2"></a><span class="kw">plot</span>(<span class="kw">names</span>(mu.vec), mu.vec, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Mean age of childbearing&quot;</span>)</span>
<span id="cb88-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-3"></a><span class="kw">plot</span>(<span class="kw">names</span>(mu.vec), rt.vec, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;Shifts&quot;</span>)</span>
<span id="cb88-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-4"></a><span class="kw">abline</span>(<span class="dt">h =</span><span class="dv">0</span>)</span>
<span id="cb88-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-5"></a><span class="kw">plot</span>(year.vec, tfr.vec, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;TFR&quot;</span>)</span>
<span id="cb88-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-6"></a><span class="kw">lines</span>(year.vec, adj.tfr.vec, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb88-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-7"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">c</span>(<span class="dv">1945</span>, <span class="dv">2008</span>))</span>
<span id="cb88-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb88-8"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Observed TFR&quot;</span>, <span class="st">&quot;Tempo-adjusted TFR&quot;</span>), <span class="dt">lty=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-81"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-81-1.png" alt="Adjusted TFR" width="672" />
<p class="caption">
Figure 7.1: Adjusted TFR
</p>
</div>
<ul>
<li>We see fertility since 1980 has been depressed by postponment</li>
<li>We see weird dynamics around end of WW2 and great recession.</li>
<li>What’s going on? Here is a closeup</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-82"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-82-1.png" alt="Observed and tempo-adjusted TFRs" width="672" />
<p class="caption">
Figure 7.2: Observed and tempo-adjusted TFRs
</p>
</div>
<ul>
<li>Now let’s look at turbulence around WWII</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-83"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-83-1.png" alt="Change in fertility rates around WWII" width="672" />
<p class="caption">
Figure 7.3: Change in fertility rates around WWII
</p>
</div>
<ul>
<li>From 1945 to 1946, fertility goes up a lot, but more at younger ages. So mean goes down. BF adjustment over-compensates, and has quantum declining.</li>
</ul>
<p>What’s happening from 1944-45?</p>
<p><em>3. Fit bongaarts feeney with birth order</em></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb89-1"></a>out &lt;-<span class="st"> </span><span class="kw">bf.fit</span>(fat.array)  <span class="co">#function to obtain BF tempo-adjusted TFR</span></span>
<span id="cb89-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb89-2"></a>adj.tfr.bo.vec &lt;-<span class="st">  </span>out<span class="op">$</span>tfr.star.out[, <span class="st">&quot;bf.tfr.star&quot;</span>] <span class="co"># sum of parity specific tempo-adjusted TFRs</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-85"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-85-1.png" alt="TFR by parities" width="672" />
<p class="caption">
Figure 7.4: TFR by parities
</p>
</div>
<p><em>4. Use HFD data to verify adjusted TFR.</em></p>
<p>HFD uses a tempo-adjusted TFR that is the sum of the parity specific adjusted BF TFR.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb90-1"></a><span class="co">## let&#39;s check against hfd</span></span>
<span id="cb90-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb90-2"></a>hfd.adj.dt &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/data/zip_w/adjtfrRR.txt&quot;</span>, <span class="dt">showProgress =</span> <span class="ot">FALSE</span>, <span class="dt">skip =</span> <span class="dv">2</span>)</span>
<span id="cb90-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb90-3"></a>hfd.adj.dt &lt;-<span class="st"> </span>hfd.adj.dt[Code <span class="op">==</span><span class="st"> &quot;USA&quot;</span>]</span></code></pre></div>
<p>We find that:</p>
<ul>
<li>Taking birth order into account smooths out WW2 turbulence (large fluctuations) but increases the variation during the Great Recession.<br />
</li>
<li>The baby boom appears to initially be even greater than observed when we take into account birth order, but then it fall more than observed.</li>
<li>Finally, the baby bust was not as bad as it seemed.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-87"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" alt="TFR by parities using HFD data" width="672" />
<p class="caption">
Figure 7.5: TFR by parities using HFD data
</p>
</div>
<div id="conclusions-3" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Conclusions</h3>
<ul>
<li>Baby boom smaller if we account for “pre-ponement”.<br />
</li>
<li>Fertility lull in 1970s and 80s disappears if we account for
“postponement”.</li>
<li>Birth order disaggregation improves estimates of shifts from
changes in mean age</li>
<li>What happened with the recession?</li>
</ul>
</div>
</div>
<div id="two-americas" class="section level2">
<h2><span class="header-section-number">7.5</span> Two Americas</h2>
<p>Let’s look at births (all orders). Here we have some animations of the ASFR over time.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-1"></a>my.year.vec &lt;-<span class="st"> </span><span class="dv">1975</span><span class="op">:</span><span class="dv">2017</span></span>
<span id="cb91-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-2"></a><span class="co"># library(devtools)</span></span>
<span id="cb91-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-3"></a><span class="co"># install_github(&quot;dgrtwo/gganimate&quot;)</span></span>
<span id="cb91-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-4"></a><span class="co"># install.packages(&quot;transformr&quot;)</span></span>
<span id="cb91-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-5"></a><span class="co"># install.packages(&quot;animation&quot;)</span></span>
<span id="cb91-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-6"></a><span class="kw">library</span>(gganimate)</span>
<span id="cb91-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-7"></a><span class="kw">library</span>(data.table)</span>
<span id="cb91-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-8"></a><span class="kw">library</span>(mixtools)</span>
<span id="cb91-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-9"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb91-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-10"></a></span>
<span id="cb91-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-11"></a><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_mixed_functions.R&quot;</span>)</span>
<span id="cb91-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-12"></a><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_functions.R&quot;</span>)</span>
<span id="cb91-13"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-13"></a></span>
<span id="cb91-14"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-14"></a><span class="co"># plot1 &lt;- ggplot(data=dt[Year %in% my.year.vec,2:4], aes(x=Age, y= ASFR)) + </span></span>
<span id="cb91-15"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-15"></a><span class="co">#   geom_line(aes(group=Year))+</span></span>
<span id="cb91-16"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-16"></a><span class="co">#   transition_time(Year)+</span></span>
<span id="cb91-17"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-17"></a><span class="co">#   labs(title = &quot;Year: {frame_time}&quot;)</span></span>
<span id="cb91-18"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-18"></a></span>
<span id="cb91-19"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb91-19"></a><span class="co"># anim_save(&quot;plot1.gif&quot;, plot1)</span></span></code></pre></div>
<p><img src="plot1.gif" /></p>
<p>During the earlier years, the mean childbearing age seems to be in the early 20s. However with time, the AFR seems to become bimodal. So what is happening here? Are there two underlying groups of women that experience different fertility rates. Now fit mixing model and redo the animation.</p>
<p><strong>NOTE: Not sure of all the lines in this mixture code. Josh, could you add some notes please?</strong></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-1"></a><span class="co">## takes few minutes to run</span></span>
<span id="cb92-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-2"></a>my.fat &lt;-<span class="st"> </span>fat[, <span class="kw">paste</span>(my.year.vec)]</span>
<span id="cb92-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-3"></a>out &lt;-<span class="st"> </span><span class="kw">get.mixed.tfr.star</span>(my.fat)</span>
<span id="cb92-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-4"></a><span class="co">##</span></span>
<span id="cb92-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-5"></a>out.all &lt;-<span class="st"> </span>out</span>
<span id="cb92-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-6"></a></span>
<span id="cb92-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-7"></a><span class="co">#Mixture simulation </span></span>
<span id="cb92-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-8"></a><span class="cf">if</span> (<span class="dv">0</span>) {</span>
<span id="cb92-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-9"></a>mu.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>mu.mat</span>
<span id="cb92-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-10"></a>lambda.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>lambda.mat</span>
<span id="cb92-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-11"></a>sigma.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>sigma.mat</span>
<span id="cb92-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-12"></a>}</span>
<span id="cb92-13"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-13"></a>mu.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>mu.mat</span>
<span id="cb92-14"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-14"></a>lambda.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>lambda.mat</span>
<span id="cb92-15"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-15"></a>sigma.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>sigma.ma</span>
<span id="cb92-16"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-16"></a></span>
<span id="cb92-17"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-17"></a><span class="co">#Temporary comment out until we figure out what these graphs actually are</span></span>
<span id="cb92-18"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-18"></a><span class="co"># matplot(my.year.vec, t(mu.mat))</span></span>
<span id="cb92-19"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-19"></a><span class="co"># abline(v = 2015)## problem here</span></span>
<span id="cb92-20"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-20"></a><span class="co"># points(c(2015, 2015), c(21.5, 30.3))</span></span>
<span id="cb92-21"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-21"></a><span class="co"># </span></span>
<span id="cb92-22"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-22"></a><span class="co"># matplot(my.year.vec, t(lambda.mat))</span></span>
<span id="cb92-23"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-23"></a><span class="co"># abline(v = 2015)## problem here</span></span>
<span id="cb92-24"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-24"></a><span class="co"># points(c(2015, 2015), c(21.5, 30.3))</span></span>
<span id="cb92-25"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-25"></a></span>
<span id="cb92-26"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-26"></a><span class="co">## interpolate 1915</span></span>
<span id="cb92-27"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-27"></a></span>
<span id="cb92-28"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-28"></a><span class="kw">colnames</span>(lambda.mat) &lt;-<span class="st"> </span>my.year.vec</span>
<span id="cb92-29"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-29"></a><span class="kw">colnames</span>(mu.mat) &lt;-<span class="st"> </span>my.year.vec</span>
<span id="cb92-30"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-30"></a>lambda.mat[,<span class="st">&quot;2015&quot;</span>] &lt;-<span class="st"> </span>(lambda.mat[,<span class="st">&quot;2014&quot;</span>] <span class="op">+</span><span class="st"> </span>lambda.mat[,<span class="st">&quot;2016&quot;</span>])<span class="op">/</span><span class="dv">2</span></span>
<span id="cb92-31"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb92-31"></a>mu.mat[,<span class="st">&quot;2015&quot;</span>]     &lt;-<span class="st"> </span>(mu.mat[,<span class="st">&quot;2014&quot;</span>]     <span class="op">+</span><span class="st"> </span>mu.mat[,<span class="st">&quot;2016&quot;</span>])<span class="op">/</span><span class="dv">2</span></span></code></pre></div>
<p>Now we create the animation with the normal distributions inside as well as the observed ASFR.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-1"></a><span class="co"># Obtaining different ASFRs per group (1 and 2)</span></span>
<span id="cb93-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-2"></a>my.dt &lt;-<span class="st"> </span>dt[Year <span class="op">%in%</span><span class="st"> </span>my.year.vec,]</span>
<span id="cb93-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-3"></a></span>
<span id="cb93-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(my.year.vec)){</span>
<span id="cb93-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-5"></a>    my.year &lt;-<span class="st"> </span>my.year.vec[i]</span>
<span id="cb93-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-6"></a>    year.vec &lt;-<span class="st"> </span><span class="kw">colnames</span>(my.fat)</span>
<span id="cb93-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-7"></a>    fx &lt;-<span class="st"> </span>my.fat[,<span class="kw">paste</span>(my.year)]</span>
<span id="cb93-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-8"></a>    <span class="co"># fx &lt;- fx/sum(fx)</span></span>
<span id="cb93-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-9"></a>    x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">names</span>(fx))</span>
<span id="cb93-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-10"></a>    <span class="co">## par(mfrow = c(1,1))</span></span>
<span id="cb93-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-11"></a>    <span class="co"># plot(x, fx,</span></span>
<span id="cb93-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-12"></a>    <span class="co">#      ylim = c(0, .3),</span></span>
<span id="cb93-13"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-13"></a>    <span class="co">#      ylab = &quot;normalized fx&quot;)</span></span>
<span id="cb93-14"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-14"></a>    s &lt;-<span class="st"> </span>year.vec <span class="op">==</span><span class="st"> </span>my.year</span>
<span id="cb93-15"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-15"></a>    this.tfr &lt;-<span class="st"> </span><span class="kw">sum</span>(fx)</span>
<span id="cb93-16"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-16"></a>    fx1.hat &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mu.mat[<span class="dv">1</span>,s], <span class="dt">sd =</span> sigma.mat[<span class="dv">1</span>,s]) <span class="op">*</span></span>
<span id="cb93-17"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-17"></a><span class="st">        </span>lambda.mat[<span class="dv">1</span>,s]<span class="op">*</span><span class="st"> </span>this.tfr</span>
<span id="cb93-18"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-18"></a>    <span class="co"># lines(x, fx1.hat, col = &quot;red&quot;)</span></span>
<span id="cb93-19"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-19"></a>    fx2.hat &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mu.mat[<span class="dv">2</span>,s], <span class="dt">sd =</span> sigma.mat[<span class="dv">2</span>,s]) <span class="op">*</span></span>
<span id="cb93-20"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-20"></a><span class="st">        </span>lambda.mat[<span class="dv">2</span>,s] <span class="op">*</span><span class="st"> </span>this.tfr</span>
<span id="cb93-21"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-21"></a>    <span class="co"># lines(x, fx2.hat, col = &quot;blue&quot;)</span></span>
<span id="cb93-22"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-22"></a>    <span class="co"># lines(x, fx1.hat + fx2.hat)</span></span>
<span id="cb93-23"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-23"></a>    <span class="co"># title(last.year)</span></span>
<span id="cb93-24"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-24"></a>    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx]</span>
<span id="cb93-25"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-25"></a>    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx1.hat]</span>
<span id="cb93-26"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-26"></a>    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx2.hat]</span>
<span id="cb93-27"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-27"></a>    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx1fx2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx1.hat <span class="op">+</span><span class="st"> </span>fx2.hat]</span>
<span id="cb93-28"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-28"></a></span>
<span id="cb93-29"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-29"></a>}</span>
<span id="cb93-30"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-30"></a></span>
<span id="cb93-31"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-31"></a>labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Observed&quot;</span> =<span class="st"> &quot;black&quot;</span>, <span class="st">&quot;Mixture 1&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;Mixture 2&quot;</span> =<span class="st"> &quot;red&quot;</span>, <span class="st">&quot;Sum of mixtures&quot;</span>=<span class="st">&quot;orange&quot;</span>)</span>
<span id="cb93-32"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-32"></a></span>
<span id="cb93-33"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-33"></a><span class="co"># plot2 &lt;-</span></span>
<span id="cb93-34"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-34"></a><span class="co">#   ggplot(data=my.dt, aes(x=Age)) + </span></span>
<span id="cb93-35"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-35"></a><span class="co">#   geom_line(aes( y= ASFR, group=Year, color = &quot;Observed&quot;))+</span></span>
<span id="cb93-36"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-36"></a><span class="co">#   geom_line(aes( y= fx1, group=Year, color = &quot;Mixture 1&quot;))+</span></span>
<span id="cb93-37"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-37"></a><span class="co">#   geom_line(aes( y= fx2, group=Year, color = &quot;Mixture 2&quot;))+</span></span>
<span id="cb93-38"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-38"></a><span class="co">#   geom_line(aes( y= fx1fx2, group=Year, color = &quot;Sum of mixtures&quot;))+</span></span>
<span id="cb93-39"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-39"></a><span class="co">#   labs(color = &quot;Legend&quot;) +</span></span>
<span id="cb93-40"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-40"></a><span class="co">#   scale_color_manual(values = labels)+</span></span>
<span id="cb93-41"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-41"></a><span class="co">#   theme_bw()#+</span></span>
<span id="cb93-42"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-42"></a><span class="co">#   transition_time(Year)+</span></span>
<span id="cb93-43"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-43"></a><span class="co">#   labs(title = &quot;Year: {frame_time}&quot;)</span></span>
<span id="cb93-44"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-44"></a></span>
<span id="cb93-45"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb93-45"></a><span class="co"># anim_save(&quot;plot2.gif&quot;, plot2)</span></span></code></pre></div>
<p><img src="plot2.gif" /></p>
<p>The animation shows how the distributions operate under the ASFR curve. There could be two separate normal distributions with distinct mean ages of childbearing.</p>
<p>Let’s do tempo adjustment:</p>
<p><strong>NOTE: Help! I don’t know how to interpret these graphs</strong></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-1"></a>rt.mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(mu.mat, <span class="dv">1</span>, center.diff))</span>
<span id="cb94-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-2"></a>tfr.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(my.fat, <span class="dv">2</span>, sum)</span>
<span id="cb94-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-3"></a>tfr.mat &lt;-<span class="st"> </span>lambda.mat <span class="op">*</span><span class="st"> </span>tfr.vec</span>
<span id="cb94-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-5"></a></span>
<span id="cb94-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-6"></a><span class="kw">matplot</span>(my.year.vec, <span class="kw">t</span>(tfr.mat), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb94-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-7"></a>tfr.star.mat &lt;-<span class="st"> </span>tfr.mat <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rt.mat)</span>
<span id="cb94-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb94-8"></a><span class="kw">matplot</span>(my.year.vec, <span class="kw">t</span>(tfr.star.mat), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-89-1"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-89-1.png" alt="Tempo Adjustment" width="672" />
<p class="caption">
Figure 7.6: Tempo Adjustment
</p>
</div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-1"></a>tfr.star.vec &lt;-<span class="st"> </span><span class="kw">colSums</span>(tfr.star.mat)</span>
<span id="cb95-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-2"></a></span>
<span id="cb95-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-3"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb95-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-4"></a><span class="kw">plot</span>(my.year.vec, tfr.vec, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb95-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-5"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb95-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-6"></a></span>
<span id="cb95-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb95-7"></a><span class="kw">lines</span>(my.year.vec, tfr.star.vec, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-89-2"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-89-2.png" alt="Tempo Adjustment" width="672" />
<p class="caption">
Figure 7.7: Tempo Adjustment
</p>
</div>
<div id="mixture" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Mixture</h3>
<p>Let’s look at 1st births, again as if their are two latent groups: <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. (These could be “early moms” / “late moms”, non-college / college, pre-marital / marital, lower-class / upper class, <span class="math inline">\(\ldots\)</span>)</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-1"></a><span class="kw">library</span>(mixtools)</span>
<span id="cb96-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-2"></a>  <span class="co">## simulate 2 normals </span></span>
<span id="cb96-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-3"></a>  N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb96-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-4"></a>  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">22</span>, <span class="dt">sd =</span> <span class="dv">3</span>) <span class="co">##</span></span>
<span id="cb96-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-5"></a>  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>N, <span class="dt">mean =</span> <span class="dv">30</span>, <span class="dt">sd =</span> <span class="dv">4</span>)</span>
<span id="cb96-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-6"></a>  <span class="co">## combine them</span></span>
<span id="cb96-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-7"></a>  x &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)</span>
<span id="cb96-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-8"></a>  <span class="co">## use EM to infer mixture</span></span>
<span id="cb96-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-9"></a>  out &lt;-<span class="st"> </span><span class="kw">normalmixEM</span>(x,</span>
<span id="cb96-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-10"></a>                     <span class="dt">lambda =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>),</span>
<span id="cb96-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-11"></a>                     <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">35</span>),</span>
<span id="cb96-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb96-12"></a>                     <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## number of iterations= 284</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb98-1"></a>  <span class="kw">print</span>(out<span class="op">$</span>mu)</span></code></pre></div>
<pre><code>## [1] 21.82989 29.86819</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb100-1"></a>  <span class="kw">print</span>(out<span class="op">$</span>sigma)</span></code></pre></div>
<pre><code>## [1] 2.809958 4.145025</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb102-1"></a>  <span class="kw">print</span>(out<span class="op">$</span>lambda)</span></code></pre></div>
<pre><code>## [1] 0.3024403 0.6975597</code></pre>
<p>Seems to work great.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-1"></a>  ages &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">49</span></span>
<span id="cb104-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-2"></a>  dens1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> ages, <span class="dt">mean =</span> out<span class="op">$</span>mu[<span class="dv">1</span>], <span class="dt">sd =</span> out<span class="op">$</span>sigma[<span class="dv">1</span>]) <span class="op">*</span><span class="st"> </span>out<span class="op">$</span>lambda[<span class="dv">1</span>]</span>
<span id="cb104-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-3"></a>  dens2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> ages, <span class="dt">mean =</span> out<span class="op">$</span>mu[<span class="dv">2</span>], <span class="dt">sd =</span> out<span class="op">$</span>sigma[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span>out<span class="op">$</span>lambda[<span class="dv">2</span>]</span>
<span id="cb104-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-4"></a>  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb104-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-5"></a>  <span class="kw">hist</span>(x, <span class="dt">probability =</span> T, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Ages&quot;</span>)</span>
<span id="cb104-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-6"></a>  <span class="kw">lines</span>(ages, dens1, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb104-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-7"></a>  <span class="kw">lines</span>(ages, dens2, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb104-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb104-8"></a>  <span class="kw">lines</span>(ages, dens1 <span class="op">+</span><span class="st"> </span>dens2, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-91"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-91-1.png" alt="Histogram of ages (x)" width="672" />
<p class="caption">
Figure 7.8: Histogram of ages (x)
</p>
</div>
</div>
<div id="an-algorithm-for-tempo-adjustment-of-mixtures" class="section level3">
<h3><span class="header-section-number">7.5.2</span> An algorithm for tempo adjustment of mixtures</h3>
<ul>
<li><p>Fit normal mixture to each year.</p></li>
<li><p>Refit using constant variance (average). This assures shape invariance of each component, fulfilling BF assumption.</p></li>
<li><p>Estimate BF separately for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, and combine.</p></li>
<li><p>tempo_mixed_results_figure.pdf <strong>NOTE: not sure about this…</strong></p></li>
</ul>
</div>
</div>
<div id="conclusions-4" class="section level2">
<h2><span class="header-section-number">7.6</span> Conclusions</h2>
<ul>
<li>Postponement dilutes period births, lowers TFR</li>
<li>Tempo-adjustment tries to ``put births back in’’</li>
<li>Changes in mean work fine if ``shape’’ doesn’t change</li>
<li>Shape can change through heterogeneity</li>
<li>With strong assumptions, we can identify heterogeneity</li>
<li>Declining quantum for young and postponement for old appears to be the story</li>
</ul>
<div id="caveats" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Caveats</h3>
<ul>
<li>Who are these latent groups? Do you start out in one and end up in the other? Do you stay in one your whole life?</li>
<li>How do we project forward?</li>
<li>Can we use other indicators (e.g., social class, education, marriage) to get same results?</li>
</ul>
<hr />
<hr />
</div>
</div>
<div id="questions-3" class="section level2">
<h2><span class="header-section-number">7.7</span> Questions</h2>
<ol style="list-style-type: decimal">
<li>Using the tempo_simu.R file,
<ol style="list-style-type: lower-alpha">
<li>Try with N of 4 million – does it still work? What happens?</li>
<li>Try with a shift function that goes up and down. Are the adjusted counts ever LESS than the observed counts? If so, when?<br />
</li>
<li>If the cumulative shift was Rt = a + 0.1*t, what would be a formula for tempo-adjusted counts of births? Sketch the 4 panels without the computer and then check to see if you’re right.</li>
</ol></li>
<li>Calculate the age profile of fertility change predicted by the BongaartsFeeney model by taking time derivatives of the log schedules. You will end up with three terms. Describe each of these in words.<br />
</li>
<li>Use simulation based on tempo simu.R to check your answer.<br />
</li>
<li>Is there a diagnostic plot that you could do to compare observed agespecific changes to those predicted by the BF model? Hint: use normalized schedules that sum to 1.0<br />
</li>
<li>Use this diagnostic plot to all-order fertility change during the Great Recession.<br />
</li>
<li>Use this diagnostic plot to 1st, 2nd, and 3rd births.<br />
</li>
<li>Fit the two-part normal mixture model to fertility from another country based on what looks interesting in the Burkimsher paper. (E.g., Canada, Portugal, or the Netherlands). I recommend doing this for 1 year, but once you get your code running, you could iterate over years. Use graphs to discuss the goodness of fit. And if you do more than 1 year, discuss whether the time trends in the parameters make substantive sense)</li>
</ol>
</div>
<div id="solutions-3" class="section level2">
<h2><span class="header-section-number">7.8</span> Solutions</h2>
<ol style="list-style-type: decimal">
<li><p><em>Using the tempo_simu.R file,</em></p>
<ol style="list-style-type: lower-alpha">
<li><em>Try with N of 4 million – does it still work? What happens?</em>
This simulation will first sample from a normal distribution draws of ages that represent the ages of women when giving birth for the first time. It also creates as shift function <span class="math inline">\(R(t)\)</span> which affects all women of a given year.
<img src="bookdown-demo_files/figure-html/unnamed-chunk-92-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-92-2.png" width="672" />
Yes, it still works. In fact, we see that the adjusted births are very close to the observed births when using this number of simulations. (I continue to use an N of 4 million for the rest of this problem).<br />
</li>
<li><em>Try with a shift function that goes up and down. Are the adjusted counts ever LESS than the observed counts? If so, when?</em><br />
<img src="bookdown-demo_files/figure-html/unnamed-chunk-93-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-93-2.png" width="672" />
The adjusted counts are not always less than the observed. Naturally, this only happens when we have spikes on the observed counts that become smoother after the adjusting of the birth counts.<br />
</li>
<li><em>If the cumulative shift was <span class="math inline">\(R_t = a + 0.1\times t\)</span>, what would be a formula for tempo-adjusted counts of births? Sketch the 4 panels without the computer and then check to see if you’re right.</em><br />
Let <span class="math inline">\(a = -199\)</span>, so we get a shift of 0 to about 3 years depending on the time period:<br />
<img src="bookdown-demo_files/figure-html/unnamed-chunk-94-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-94-2.png" width="672" /></li>
</ol></li>
<li><p><em>Calculate the age profile of fertility change predicted by the BongaartsFeeney model by taking time derivatives of the log schedules. You will end up with three terms. Describe each of these in words.</em><br />
<span class="math display">\[\begin{aligned}
 f(a,t)&amp;=f_0(a-R(t))[1-R&#39;(t)]q(t)\\
 log(f(a,t))&amp;=log(f_0(a-R(t))) + log(1-R&#39;(t)) + log(q(t))\\
 \frac{\partial log(f(a,t))}{\partial t}&amp;=\frac{\partial log(f_0(a-R(t)))}{\partial t} + \frac{\partial
 log(1-R&#39;(t))}{\partial t} + \frac{\partial log(q(t))}{\partial t}\\
 \frac{\partial log(f(a,t))}{\partial t}&amp;=-R&#39;(t)\frac{f_0&#39;(a-R(t))}{f_0(a-R(t))} -\frac{R&#39;&#39;(t)}{1-R&#39;(t)} + \frac{q&#39;(t)}{q(t)}
 \end{aligned}\]</span>
The first term represents the proportional change in the fertility of the equivalent pre-postponement cohort. In particular, it is divided into (how far someone shifts ‘over’ relative to ages on the baseline fertility schedule) and an <span class="math inline">\(R&#39;(t)\)</span> term (how much one shifts ‘up’). The second term represents the proportional change in the rate of change in years of postponement; it is a tempo-effect. The third term represents the proportional change in quantum.</p></li>
<li><p><em>Use simulation based on tempo simu.R to check your answer.</em></p>
<p>The <code>tempo_simu.R</code> function computes <span class="math inline">\(R(t)\)</span> but we need to obtain the remaining components of the answer from the previous excercise. For simplicity, let’s assume that there are no tempo effects (<span class="math inline">\(q(t)=0\)</span>) and that <span class="math inline">\(a=25\)</span>, that is, our baseline schedule is that of women aged 25.</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(R(t)\)</span> components:
Let’s briefly look at <span class="math inline">\(R(t)\)</span>, <span class="math inline">\(R&#39;(t)\)</span>, and <span class="math inline">\(R&#39;&#39;(t)\)</span>. In <code>tempo_simu.R</code> <span class="math inline">\(R(t)\)</span> refers to the cumulative shift object (<code>shift.t</code> ). We can obtain the derivatives by taking the centered difference of this object.</li>
</ol>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-1"></a>shift.t.prime &lt;-<span class="st"> </span><span class="kw">center.diff</span>(shift.t)</span>
<span id="cb105-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-2"></a>shift.t.prime<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">center.diff</span>(shift.t.prime)</span>
<span id="cb105-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-3"></a></span>
<span id="cb105-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-4"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb105-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-5"></a><span class="kw">plot</span>(<span class="dv">1991</span><span class="op">:</span><span class="dv">2020</span>, shift.t, <span class="dt">main =</span> <span class="st">&#39;R(t)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb105-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-6"></a><span class="kw">plot</span>(<span class="dv">1991</span><span class="op">:</span><span class="dv">2020</span>, shift.t.prime, <span class="dt">main =</span> <span class="st">&#39;R</span><span class="ch">\&#39;</span><span class="st">(t)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb105-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-7"></a><span class="kw">plot</span>(<span class="dv">1991</span><span class="op">:</span><span class="dv">2020</span>, shift.t.prime<span class="fl">.2</span>, <span class="dt">main =</span> <span class="st">&#39;R</span><span class="ch">\&#39;\&#39;</span><span class="st">(t)&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb105-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb105-8"></a><span class="kw">plot</span>(<span class="dv">1991</span><span class="op">:</span><span class="dv">2020</span>,<span class="op">-</span>shift.t.prime<span class="fl">.2</span><span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>shift.t.prime), <span class="dt">main =</span> <span class="st">&#39;-R</span><span class="ch">\&#39;\&#39;</span><span class="st">(t) / (1- R</span><span class="ch">\&#39;</span><span class="st">(t))&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;year&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-96-1.png" width="768" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li><span class="math inline">\(f_0(a-R(t))\)</span> function:
In the Bongaarts and Feeney model, the baseline schedule of women of age <span class="math inline">\(a\)</span> at time <span class="math inline">\(t\)</span> is <span class="math inline">\(f_0(a-R(t))\)</span>. That is, it is the fertility schedule that is observed because of the shift. From the simulation, we obtain a table of births at each age and the age-specific fertility rates. Then, we can look at the original and the observed ASFRs. The original ASFR is that from the simulation, which we would not observe. Rather we would only the see the ASFR from births that were postponed by year-specific shifts.</li>
</ol>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-1"></a><span class="co"># floor everything</span></span>
<span id="cb106-2"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-2"></a>dt_floored &lt;-<span class="st"> </span>dt <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-3"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-3"></a><span class="kw">transmute</span>(<span class="st">&#39;x&#39;</span> =<span class="st"> </span><span class="kw">floor</span>(x), <span class="st">&#39;t&#39;</span> =<span class="st"> </span><span class="kw">floor</span>(t), </span>
<span id="cb106-4"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-4"></a>          <span class="st">&#39;t.obs&#39;</span> =<span class="st"> </span><span class="kw">floor</span>(t.obs), <span class="st">&#39;x.obs&#39;</span> =<span class="st"> </span><span class="kw">floor</span>(x.obs)) <span class="co"># the .obs values are the ones that go into the baseline function. </span></span>
<span id="cb106-5"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-5"></a></span>
<span id="cb106-6"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-6"></a><span class="co"># Births to women born at each age. </span></span>
<span id="cb106-7"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-7"></a>original_sched &lt;-<span class="st"> </span><span class="kw">table</span>(dt_floored<span class="op">$</span>x, dt_floored<span class="op">$</span>t)</span>
<span id="cb106-8"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-8"></a>observed_sched &lt;-<span class="st"> </span><span class="kw">table</span>(dt_floored<span class="op">$</span>x.obs, dt_floored<span class="op">$</span>t.obs)</span>
<span id="cb106-9"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-9"></a></span>
<span id="cb106-10"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-10"></a><span class="co"># ASFR (The denominator is 100 person years lived, or 100 women at each age)</span></span>
<span id="cb106-11"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-11"></a>asfr_original&lt;-<span class="st"> </span>original_sched<span class="op">/</span>(<span class="dv">100</span><span class="op">*</span>thousand) <span class="co">#f(a,t)</span></span>
<span id="cb106-12"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-12"></a>asfr_observed &lt;-<span class="st"> </span>observed_sched<span class="op">/</span>(<span class="dv">100</span><span class="op">*</span>thousand) <span class="co">#f_0(a,t)</span></span>
<span id="cb106-13"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-13"></a></span>
<span id="cb106-14"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-14"></a><span class="co">#Graph of ASFRs for observed and original births. The lines get lighter with each year. </span></span>
<span id="cb106-15"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-15"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb106-16"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-16"></a><span class="kw">matplot</span>(<span class="kw">rownames</span>(asfr_observed), asfr_observed, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col=</span><span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">40</span>)), </span>
<span id="cb106-17"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-17"></a>    <span class="dt">xlab =</span> <span class="st">&#39;Age&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;ASFR&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;Observed ASFR&#39;</span>)</span>
<span id="cb106-18"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-18"></a><span class="kw">abline</span>(<span class="dt">v=</span> <span class="dv">25</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>)</span>
<span id="cb106-19"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-19"></a></span>
<span id="cb106-20"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-20"></a><span class="kw">matplot</span>(<span class="kw">rownames</span>(asfr_original), asfr_original, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col=</span><span class="kw">grey</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">40</span>)), </span>
<span id="cb106-21"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-21"></a>    <span class="dt">xlab =</span> <span class="st">&#39;Age&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;ASFR&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;Original ASFR&#39;</span>)</span>
<span id="cb106-22"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#cb106-22"></a><span class="kw">abline</span>(<span class="dt">v=</span> <span class="dv">25</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-97-1.png" width="672" />
The component that we are interersted in is the first derivative of the baseline schedule (<span class="math inline">\(f_0(a-R(t))\)</span>).
<img src="bookdown-demo_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Comparison of terms from original and observed data:
We can merge all the terms of the formula from the previous question and compare it to the derivative of the log version of the observed fertility schedules.
<img src="bookdown-demo_files/figure-html/unnamed-chunk-99-1.png" width="672" /><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-2.png" width="672" /></li>
</ol>
<pre><code>##             5             6             7             8             9            10 
##           Inf           NaN           NaN           NaN           NaN           NaN 
##            11            12            13            14            15            16 
##  0.0346455819  0.0297976453  0.0248332401  0.0239915297  0.0221809649  0.0199164460 
##            17            18            19            20            21            22 
##  0.0180659826  0.0160980077  0.0144997811  0.0126420118  0.0107639359  0.0089432668 
##            23            24            25            26            27            28 
##  0.0069456544  0.0051884417  0.0032663876  0.0014198640 -0.0004753358 -0.0022687715 
##            29            30            31            32            33            34 
## -0.0041667145 -0.0060392014 -0.0079432768 -0.0096843256 -0.0115976736 -0.0133616444 
##            35            36            37            38            39            40 
## -0.0153737506 -0.0170545337 -0.0189727392 -0.0208894124 -0.0233746760 -0.0249600394 
##            41            42            43            44            45            46 
## -0.0265662882          -Inf           NaN           NaN           NaN          -Inf 
##            47            48 
##           NaN           NaN</code></pre>
<pre><code>##           5           6           7           8           9          10          11 
##         NaN         NaN         NaN -0.04702751        -Inf        -Inf -0.04966368 
##          12          13          14          15          16          17          18 
## -0.06108219 -0.05255181 -0.05463626 -0.05422444 -0.04876114 -0.05049269 -0.05189116 
##          19          20          21          22          23          24          25 
## -0.05168229 -0.05310568 -0.05152007 -0.05163416 -0.05222859 -0.05216303 -0.05147769 
##          26          27          28          29          30          31          32 
## -0.05243268 -0.05242616 -0.05138857 -0.05216956 -0.05232595 -0.05271028 -0.05269802 
##          33          34          35          36          37          38          39 
## -0.05278829 -0.05342713 -0.05158280 -0.05298234 -0.04710160 -0.06555547 -0.06775549 
##          40          41          42          43          44          45 
## -0.03566782 -0.02772589         NaN         NaN         NaN         NaN</code></pre>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-99-3.png" width="672" /></p></li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bongaarts1998quantum">
<p>Bongaarts, John, and Griffith Feeney. 1998. “On the Quantum and Tempo of Fertility.” <em>Population and Development Review</em>, 271–91.</p>
</div>
<div id="ref-burkimsher2017evolution">
<p>Burkimsher, Marion. 2017. “Evolution of the Shape of the Fertility Curve: Why Might Some Countries Develop a Bimodal Curve?” <em>Demographic Research</em> 37: 295–324.</p>
</div>
<div id="ref-hastie2009elements">
<p>Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-sullivan2005age">
<p>Sullivan, Rachel. 2005. “The Age Pattern of First-Birth Rates Among Us Women: The Bimodal 1990s.” <em>Demography</em> 42 (2): 259–73.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mortality-plateaus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="branching-processes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-tempo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
