<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Fisher-Wright | Mathematical Demography</title>
  <meta name="description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Fisher-Wright | Mathematical Demography" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Fisher-Wright | Mathematical Demography" />
  
  <meta name="twitter:description" content="This is a book from the Mathematical Demography lecture notes." />
  

<meta name="author" content="Josh R. Goldstein" />


<meta name="date" content="2020-11-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="branching-processes.html"/>
<link rel="next" href="coalescent.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Random Demography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Demographic Heterogeneity</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#part-i.-conceptual-introduction"><i class="fa fa-check"></i><b>2.2</b> Part I. Conceptual Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#what-is-demographic-heterogeneity"><i class="fa fa-check"></i><b>2.2.1</b> What is Demographic Heterogeneity?</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#analogies"><i class="fa fa-check"></i><b>2.2.2</b> Analogies</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#whats-new"><i class="fa fa-check"></i><b>2.2.3</b> What’s new?</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#application"><i class="fa fa-check"></i><b>2.2.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#part-ii.-formal-analysis"><i class="fa fa-check"></i><b>2.3</b> Part II. Formal Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#outline-1"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#keyfitz-result"><i class="fa fa-check"></i><b>2.3.2</b> Keyfitz result</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#us-mexico-example"><i class="fa fa-check"></i><b>2.3.3</b> US-Mexico Example</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#the-origin-of-professor-wachters-poisson-exponential-model"><i class="fa fa-check"></i><b>2.3.4</b> The Origin of Professor Wachter’s Poisson-Exponential Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#some-commentary"><i class="fa fa-check"></i><b>2.3.5</b> Some commentary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>3</b> Multiplicative Fixed Frailty</a><ul>
<li class="chapter" data-level="3.1" data-path="frailty.html"><a href="frailty.html#outline-2"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frailty.html"><a href="frailty.html#review-of-mortality-mathematics"><i class="fa fa-check"></i><b>3.1.1</b> Review of mortality mathematics</a></li>
<li class="chapter" data-level="3.1.2" data-path="frailty.html"><a href="frailty.html#application-what-is-ellx"><i class="fa fa-check"></i><b>3.1.2</b> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="frailty.html"><a href="frailty.html#extending-keyfitz-to-mortality"><i class="fa fa-check"></i><b>3.1.3</b> Extending Keyfitz to mortality</a></li>
<li class="chapter" data-level="3.1.4" data-path="frailty.html"><a href="frailty.html#multiplicative-fixed-frailty"><i class="fa fa-check"></i><b>3.1.4</b> Multiplicative Fixed frailty</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frailty.html"><a href="frailty.html#part-i.-results-from-fixed-frailty"><i class="fa fa-check"></i><b>3.2</b> Part I. Results from Fixed Frailty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frailty.html"><a href="frailty.html#a-simulation"><i class="fa fa-check"></i><b>3.2.1</b> A simulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="frailty.html"><a href="frailty.html#lets-derive-pop-survival-note-bars-barell"><i class="fa fa-check"></i><b>3.2.2</b> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="frailty.html"><a href="frailty.html#now-population-hazards-stepping-stones"><i class="fa fa-check"></i><b>3.2.3</b> Now population hazards (stepping stones)</a></li>
<li class="chapter" data-level="3.2.4" data-path="frailty.html"><a href="frailty.html#rodriguez-question"><i class="fa fa-check"></i><b>3.2.4</b> Rodriguez question</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frailty.html"><a href="frailty.html#part-ii.-introduction-to-gamma-frailty"><i class="fa fa-check"></i><b>3.3</b> Part II. Introduction to Gamma Frailty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frailty.html"><a href="frailty.html#the-gamma-distribution"><i class="fa fa-check"></i><b>3.3.1</b> The Gamma distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="frailty.html"><a href="frailty.html#gamma-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Gamma in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="frailty.html"><a href="frailty.html#population-survival-of-gamma-frailty"><i class="fa fa-check"></i><b>3.3.3</b> Population Survival of Gamma Frailty</a></li>
<li class="chapter" data-level="3.3.4" data-path="frailty.html"><a href="frailty.html#interpreting-gamma-frailty-survival"><i class="fa fa-check"></i><b>3.3.4</b> Interpreting Gamma-frailty survival</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frailty.html"><a href="frailty.html#conclusions-1"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html"><i class="fa fa-check"></i><b>4</b> Gamma Frailty with Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#from-survival-to-hazards"><i class="fa fa-check"></i><b>4.1</b> From survival to hazards</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#what-happens-to-frailty-of-survivors"><i class="fa fa-check"></i><b>4.1.1</b> What happens to frailty of survivors?</a></li>
<li class="chapter" data-level="4.1.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#average-frailty-in-terms-of-survival"><i class="fa fa-check"></i><b>4.1.2</b> Average frailty in terms of survival</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#censoc-selection-and-observed-frailty"><i class="fa fa-check"></i><b>4.2</b> CenSoc: Selection and observed frailty</a><ul>
<li class="chapter" data-level="4.2.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#data"><i class="fa fa-check"></i><b>4.2.1</b> Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#estimation"><i class="fa fa-check"></i><b>4.2.2</b> Estimation</a></li>
<li class="chapter" data-level="4.2.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#discuss-our-conclusions-and-possible-future-directions-to-follow."><i class="fa fa-check"></i><b>4.2.3</b> Discuss our conclusions and possible future directions to follow.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html"><i class="fa fa-check"></i><b>5</b> Convergence and cross-overs</a><ul>
<li class="chapter" data-level="5.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#outline-3"><i class="fa fa-check"></i><b>5.1</b> Outline</a></li>
<li class="chapter" data-level="5.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#what-happens-to-mortality-disparities-at-older-ages"><i class="fa fa-check"></i><b>5.2</b> What happens to mortality disparities at older ages?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-possible-null-model"><i class="fa fa-check"></i><b>5.2.1</b> A possible null-model</a></li>
<li class="chapter" data-level="5.2.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-result-5e---vm-38"><i class="fa fa-check"></i><b>5.2.2</b> A result: (5E - V&amp;M (38))</a></li>
<li class="chapter" data-level="5.2.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#inversion"><i class="fa fa-check"></i><b>5.2.3</b> Inversion</a></li>
<li class="chapter" data-level="5.2.4" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#an-example-1"><i class="fa fa-check"></i><b>5.2.4</b> An example</a></li>
<li class="chapter" data-level="5.2.5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#application-1"><i class="fa fa-check"></i><b>5.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#student-presentation"><i class="fa fa-check"></i><b>5.3</b> Student Presentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html"><i class="fa fa-check"></i><b>6</b> Mortality plateaus</a><ul>
<li class="chapter" data-level="6.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-4"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#heterogeneity-slows-mortality-improvement"><i class="fa fa-check"></i><b>6.2</b> Heterogeneity slows mortality improvement</a><ul>
<li class="chapter" data-level="6.2.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#an-example-2"><i class="fa fa-check"></i><b>6.2.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#conclusions-2"><i class="fa fa-check"></i><b>6.3</b> Conclusions</a></li>
<li class="chapter" data-level="6.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#hazards-and-plateaus-by-professor-ken-wachter"><i class="fa fa-check"></i><b>6.4</b> Hazards and Plateaus by Professor Ken Wachter</a><ul>
<li class="chapter" data-level="6.4.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-5"><i class="fa fa-check"></i><b>6.4.1</b> Outline</a></li>
<li class="chapter" data-level="6.4.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#extremes-of-longevity-in-humans-and-other-species"><i class="fa fa-check"></i><b>6.4.2</b> Extremes of Longevity in Humans and Other Species</a></li>
<li class="chapter" data-level="6.4.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#gamma-gompertz-fixed-frailty-hazards"><i class="fa fa-check"></i><b>6.4.3</b> Gamma-Gompertz Fixed Frailty Hazards</a></li>
<li class="chapter" data-level="6.4.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#less-restrictive-frailty-models"><i class="fa fa-check"></i><b>6.4.4</b> Less Restrictive Frailty Models</a></li>
<li class="chapter" data-level="6.4.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#mutation-accumulation-gompertz-hazards-with-plateaus"><i class="fa fa-check"></i><b>6.4.5</b> Mutation Accumulation, Gompertz Hazards with Plateaus</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#key-points"><i class="fa fa-check"></i><b>6.5</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><i class="fa fa-check"></i><b>7</b> Fertility Heterogeneity: Tempo Distortions and Distorted TempoTempo</a><ul>
<li class="chapter" data-level="7.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#outline-6"><i class="fa fa-check"></i><b>7.1</b> Outline</a></li>
<li class="chapter" data-level="7.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#fertility-postponement-a-very-simple-example"><i class="fa fa-check"></i><b>7.2.1</b> Fertility postponement, a very simple example</a></li>
<li class="chapter" data-level="7.2.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#continuous-postponement-a-shiny-simulation"><i class="fa fa-check"></i><b>7.2.2</b> Continuous postponement, a shiny simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#period-shifts-bongaarts-and-feeneys-model"><i class="fa fa-check"></i><b>7.3</b> Period Shifts: Bongaarts and Feeney’s model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here"><i class="fa fa-check"></i><b>7.3.1</b> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></a></li>
<li class="chapter" data-level="7.3.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#tempo-adjusted-tfr"><i class="fa fa-check"></i><b>7.3.2</b> Tempo-adjusted TFR:</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#an-application-to-the-united-states"><i class="fa fa-check"></i><b>7.4</b> An Application to the United States</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#conclusions-3"><i class="fa fa-check"></i><b>7.4.1</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#two-americas"><i class="fa fa-check"></i><b>7.5</b> Two Americas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#mixture"><i class="fa fa-check"></i><b>7.5.1</b> Mixture</a></li>
<li class="chapter" data-level="7.5.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#an-algorithm-for-tempo-adjustment-of-mixtures"><i class="fa fa-check"></i><b>7.5.2</b> An algorithm for tempo adjustment of mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#conclusions-4"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a><ul>
<li class="chapter" data-level="7.6.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempotempo.html#caveats"><i class="fa fa-check"></i><b>7.6.1</b> Caveats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="branching-processes.html"><a href="branching-processes.html"><i class="fa fa-check"></i><b>8</b> Branching Processes</a><ul>
<li class="chapter" data-level="8.1" data-path="branching-processes.html"><a href="branching-processes.html#outline-7"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="branching-processes.html"><a href="branching-processes.html#motivation"><i class="fa fa-check"></i><b>8.2</b> Motivation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="branching-processes.html"><a href="branching-processes.html#very-brief-history-of-branching-processes"><i class="fa fa-check"></i><b>8.2.1</b> Very brief history of Branching Processes</a></li>
<li class="chapter" data-level="8.2.2" data-path="branching-processes.html"><a href="branching-processes.html#applicability-to-the-coronavirus-yes-and-no."><i class="fa fa-check"></i><b>8.2.2</b> Applicability to the Coronavirus? Yes and no.</a></li>
<li class="chapter" data-level="8.2.3" data-path="branching-processes.html"><a href="branching-processes.html#simulated-examples-and-the-questions-they-raise"><i class="fa fa-check"></i><b>8.2.3</b> Simulated examples and the questions they raise</a></li>
<li class="chapter" data-level="8.2.4" data-path="branching-processes.html"><a href="branching-processes.html#what-is-a-bienayme-galton-watson-branching-process"><i class="fa fa-check"></i><b>8.2.4</b> What is a (Bienayme)-Galton-Watson branching process?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="branching-processes.html"><a href="branching-processes.html#simulations-of-parents-having-children"><i class="fa fa-check"></i><b>8.3</b> Simulations of parents having children</a></li>
<li class="chapter" data-level="8.4" data-path="branching-processes.html"><a href="branching-processes.html#the-probability-generating-function-our-mathematical-tool"><i class="fa fa-check"></i><b>8.4</b> The Probability Generating Function: Our mathematical tool</a></li>
<li class="chapter" data-level="8.5" data-path="branching-processes.html"><a href="branching-processes.html#extinction"><i class="fa fa-check"></i><b>8.5</b> Extinction</a></li>
<li class="chapter" data-level="8.6" data-path="branching-processes.html"><a href="branching-processes.html#good-and-bad-set-ups-for-branching-process"><i class="fa fa-check"></i><b>8.6</b> Good and bad set-ups for branching process</a></li>
<li class="chapter" data-level="8.7" data-path="branching-processes.html"><a href="branching-processes.html#the-distribution-of-offspring-of-all-generations"><i class="fa fa-check"></i><b>8.7</b> The distribution of offspring of all generations</a></li>
<li class="chapter" data-level="8.8" data-path="branching-processes.html"><a href="branching-processes.html#geometric-offspring-distribution"><i class="fa fa-check"></i><b>8.8</b> Geometric offspring distribution</a><ul>
<li class="chapter" data-level="8.8.1" data-path="branching-processes.html"><a href="branching-processes.html#the-geometric-distributions-simple-pgf"><i class="fa fa-check"></i><b>8.8.1</b> The Geometric Distribution’s simple PGF</a></li>
<li class="chapter" data-level="8.8.2" data-path="branching-processes.html"><a href="branching-processes.html#a-plot-of-keyfitzs-numbers-for-generations-1-2-and-3.-is-it-exponential-for-k-0"><i class="fa fa-check"></i><b>8.8.2</b> A plot of Keyfitz’s numbers for generations 1, 2, and 3. Is it exponential for <span class="math inline">\(k &gt; 0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="branching-processes.html"><a href="branching-processes.html#branching-processes-and-covid-19"><i class="fa fa-check"></i><b>8.9</b> Branching Processes and Covid-19</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fisher-wright.html"><a href="fisher-wright.html"><i class="fa fa-check"></i><b>9</b> Fisher-Wright</a><ul>
<li class="chapter" data-level="9.1" data-path="fisher-wright.html"><a href="fisher-wright.html#outline-8"><i class="fa fa-check"></i><b>9.1</b> Outline</a></li>
<li class="chapter" data-level="9.2" data-path="fisher-wright.html"><a href="fisher-wright.html#parallel"><i class="fa fa-check"></i><b>9.2</b> Parallel</a><ul>
<li class="chapter" data-level="9.2.1" data-path="fisher-wright.html"><a href="fisher-wright.html#another-cell-phone-example"><i class="fa fa-check"></i><b>9.2.1</b> Another cell phone example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="fisher-wright.html"><a href="fisher-wright.html#mutation"><i class="fa fa-check"></i><b>9.3</b> Mutation</a></li>
<li class="chapter" data-level="9.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fixation"><i class="fa fa-check"></i><b>9.4</b> Fixation</a><ul>
<li class="chapter" data-level="9.4.1" data-path="fisher-wright.html"><a href="fisher-wright.html#probability-that-a-particular-line-will-fix"><i class="fa fa-check"></i><b>9.4.1</b> Probability that a particular line will “fix”</a></li>
<li class="chapter" data-level="9.4.2" data-path="fisher-wright.html"><a href="fisher-wright.html#expected-time-until-fixation"><i class="fa fa-check"></i><b>9.4.2</b> Expected time until fixation?</a></li>
<li class="chapter" data-level="9.4.3" data-path="fisher-wright.html"><a href="fisher-wright.html#path-to-fixation-a-measure-of-homogeneityheterogeneity"><i class="fa fa-check"></i><b>9.4.3</b> Path to fixation: a measure of homogeneity/heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="fisher-wright.html"><a href="fisher-wright.html#baby-names"><i class="fa fa-check"></i><b>9.5</b> Baby Names</a><ul>
<li class="chapter" data-level="9.5.1" data-path="fisher-wright.html"><a href="fisher-wright.html#basic-idea"><i class="fa fa-check"></i><b>9.5.1</b> Basic idea</a></li>
<li class="chapter" data-level="9.5.2" data-path="fisher-wright.html"><a href="fisher-wright.html#fisher-wright-simulation-of-baby-names-hahn-and-bentley"><i class="fa fa-check"></i><b>9.5.2</b> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</a></li>
<li class="chapter" data-level="9.5.3" data-path="fisher-wright.html"><a href="fisher-wright.html#drawing-their-picture-with-simulation"><i class="fa fa-check"></i><b>9.5.3</b> Drawing their picture with simulation</a></li>
<li class="chapter" data-level="9.5.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fw-babyname-simulation-of-equilibrium-frequencies"><i class="fa fa-check"></i><b>9.5.4</b> FW babyname simulation of equilibrium frequencies</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="fisher-wright.html"><a href="fisher-wright.html#now-we-can-simulate-babyynmes"><i class="fa fa-check"></i><b>9.6</b> Now we can simulate babyynmes</a></li>
<li class="chapter" data-level="9.7" data-path="fisher-wright.html"><a href="fisher-wright.html#conclusions-5"><i class="fa fa-check"></i><b>9.7</b> Conclusions</a><ul>
<li class="chapter" data-level="9.7.1" data-path="fisher-wright.html"><a href="fisher-wright.html#some-potential-criticism"><i class="fa fa-check"></i><b>9.7.1</b> Some potential criticism</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="coalescent.html"><a href="coalescent.html"><i class="fa fa-check"></i><b>10</b> Coalescent</a><ul>
<li class="chapter" data-level="10.1" data-path="coalescent.html"><a href="coalescent.html#outline-9"><i class="fa fa-check"></i><b>10.1</b> Outline</a></li>
<li class="chapter" data-level="10.2" data-path="coalescent.html"><a href="coalescent.html#big-picture-the-coalescent-expectations-of-the-past"><i class="fa fa-check"></i><b>10.2</b> Big picture: The Coalescent: Expectations of the Past</a></li>
<li class="chapter" data-level="10.3" data-path="coalescent.html"><a href="coalescent.html#our-first-question-when-was-mrca"><i class="fa fa-check"></i><b>10.3</b> Our first question: When was MRCA?</a></li>
<li class="chapter" data-level="10.4" data-path="coalescent.html"><a href="coalescent.html#mutation-and-inference-of-tmrca-and-n"><i class="fa fa-check"></i><b>10.4</b> Mutation and inference of TMRCA and <span class="math inline">\(N\)</span></a></li>
<li class="chapter" data-level="10.5" data-path="coalescent.html"><a href="coalescent.html#inference-of-population-size-simulation"><i class="fa fa-check"></i><b>10.5</b> Inference of population size, simulation</a></li>
<li class="chapter" data-level="10.6" data-path="coalescent.html"><a href="coalescent.html#conclusions-6"><i class="fa fa-check"></i><b>10.6</b> Conclusions</a></li>
<li class="chapter" data-level="10.7" data-path="coalescent.html"><a href="coalescent.html#an-application-of-coalescent-theory"><i class="fa fa-check"></i><b>10.7</b> An application of coalescent theory</a><ul>
<li class="chapter" data-level="10.7.1" data-path="coalescent.html"><a href="coalescent.html#coalesence-when-population-is-changing"><i class="fa fa-check"></i><b>10.7.1</b> Coalesence when population is changing</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="coalescent.html"><a href="coalescent.html#inference-from-mrca-times-n-2-comparisons-and-relative-branch-lengths"><i class="fa fa-check"></i><b>10.8</b> Inference from MRCA times: <span class="math inline">\(n &gt; 2\)</span> comparisons and relative branch lengths</a></li>
<li class="chapter" data-level="10.9" data-path="coalescent.html"><a href="coalescent.html#reconstruction-ancient-european-population-sizes-using-batinis-sample-of-mitochondrial-dna"><i class="fa fa-check"></i><b>10.9</b> Reconstruction Ancient European Population Sizes using Batini’s sample of Mitochondrial DNA&quot;</a><ul>
<li class="chapter" data-level="10.9.1" data-path="coalescent.html"><a href="coalescent.html#summary-of-batini-et-al."><i class="fa fa-check"></i><b>10.9.1</b> Summary of Batini et al.</a></li>
<li class="chapter" data-level="10.9.2" data-path="coalescent.html"><a href="coalescent.html#ancient-population-estimates"><i class="fa fa-check"></i><b>10.9.2</b> Ancient population estimates</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="coalescent.html"><a href="coalescent.html#some-exercises"><i class="fa fa-check"></i><b>10.10</b> Some exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="student-presentations.html"><a href="student-presentations.html"><i class="fa fa-check"></i><b>11</b> Student Presentations</a><ul>
<li class="chapter" data-level="11.1" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers"><i class="fa fa-check"></i><b>11.1</b> Mortality Crossovers</a><ul>
<li class="chapter" data-level="11.1.1" data-path="student-presentations.html"><a href="student-presentations.html#outline-10"><i class="fa fa-check"></i><b>11.1.1</b> Outline</a></li>
<li class="chapter" data-level="11.1.2" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers-reality-or-bad-data-coale1986mortality"><i class="fa fa-check"></i><b>11.1.2</b> <em>Mortality Crossovers: Reality or Bad Data?</em> <span class="citation">(Coale and Kisker <span>1986</span>)</span></a></li>
<li class="chapter" data-level="11.1.3" data-path="student-presentations.html"><a href="student-presentations.html#methods-for-evaluating-the-heterogeneity-of-aging-processes-in-human-populations-using-vital-statistics-data-explaining-the-blackwhite-mortality-crossover-by-a-model-of-mortality-selection-manton1981methods"><i class="fa fa-check"></i><b>11.1.3</b> <em>Methods for Evaluating the Heterogeneity of Aging Processes in Human Populations Using Vital Statistics Data: Explaining the Black/White Mortality Crossover by a Model of Mortality Selection</em> <span class="citation">(Manton and Stallard <span>1981</span>)</span></a></li>
<li class="chapter" data-level="11.1.4" data-path="student-presentations.html"><a href="student-presentations.html#censoc-mortality-crossovers"><i class="fa fa-check"></i><b>11.1.4</b> CenSoc Mortality Crossovers</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="student-presentations.html"><a href="student-presentations.html#plateaus"><i class="fa fa-check"></i><b>11.2</b> Plateaus</a></li>
<li class="chapter" data-level="11.3" data-path="student-presentations.html"><a href="student-presentations.html#rising-inequality"><i class="fa fa-check"></i><b>11.3</b> Rising Inequality</a><ul>
<li class="chapter" data-level="11.3.1" data-path="student-presentations.html"><a href="student-presentations.html#trends-in-mortality-differentials-and-life-expectancy-for-male-social-security-covered-workers-by-socioeconomic-status-waldron2007trends"><i class="fa fa-check"></i><b>11.3.1</b> <em>Trends in mortality differentials and life expectancy for male social security-covered workers, by socioeconomic status</em> <span class="citation">(Waldron <span>2007</span>)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html"><i class="fa fa-check"></i><b>12</b> Demographic theory and COVID-19</a><ul>
<li class="chapter" data-level="12.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#outline-11"><i class="fa fa-check"></i><b>12.1</b> Outline</a></li>
<li class="chapter" data-level="12.2" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#motivating-questions"><i class="fa fa-check"></i><b>12.2</b> Motivating questions</a></li>
<li class="chapter" data-level="12.3" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#population-aging"><i class="fa fa-check"></i><b>12.3</b> Population aging</a><ul>
<li class="chapter" data-level="12.3.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stable-theory"><i class="fa fa-check"></i><b>12.3.1</b> Stable theory</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#keyfitzs-entropy"><i class="fa fa-check"></i><b>12.4</b> Keyfitz’s entropy</a></li>
<li class="chapter" data-level="12.5" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#loss-of-person-years-remaining"><i class="fa fa-check"></i><b>12.5</b> Loss of person years remaining</a></li>
<li class="chapter" data-level="12.6" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stationary-theory"><i class="fa fa-check"></i><b>12.6</b> Stationary theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematical Demography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fisher-wright" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Fisher-Wright</h1>
<div id="outline-8" class="section level2">
<h2><span class="header-section-number">9.1</span> Outline</h2>
<ul>
<li>COVID</li>
<li>Fisher Wright vs Galton Branching Process</li>
<li>FW with mutation</li>
<li>Extinction</li>
<li>Application: Baby Names</li>
</ul>
<p>Additional resources:</p>
<ul>
<li>Blog “Introduction to the Wright-Fisher Model” <a href="https://stephens999.github.io/fiveMinuteStats/wright_fisher_model.html#pre-requisites" class="uri">https://stephens999.github.io/fiveMinuteStats/wright_fisher_model.html#pre-requisites</a></li>
<li><span class="citation">Hahn and Bentley (<a href="#ref-hahn2003drift">2003</a>)</span>: Evolutionary anthropologists arguing that the neutral explanation of the Fisher-Wright model is consistent with the distribution of 1st names. What other quantitative or qualitative features of 1st name fashion could be used to try to reject the neutral model?</li>
<li><span class="citation">Felsenstein (<a href="#ref-felsenstein2005theoretical">2005</a>)</span>: Very complete “lecture notes” for graduate genetics course. Lots of good commentary, does not assume a lot of math background, but lots of content and can be diffcult to read a piece by itself.</li>
</ul>
</div>
<div id="parallel" class="section level2">
<h2><span class="header-section-number">9.2</span> Parallel</h2>
<style>
.column-left{
  float: left;
  width: 50%;
  text-align: left;
}
.column-right{
  float: right;
  width: 50%;
  text-align: left;
}
</style>
<div class="column-right">
<p><em>Fisher-Wright</em></p>
<ul>
<li>Children picking their parents (not “generative”)</li>
<li>Total population size is constant: process goes backwards</li>
<li>Qualitatively similar to BP. Extinction and fixation.</li>
<li>Flexible: mutation, selection, even changes in pop size.</li>
<li>With apologies, biologists take FW “seriously” even if they
don’t take it “literally”.</li>
</ul>
</div>
<div class="column-left">
<p><em>Galton-Watson-Bienaymè Branching Processe</em></p>
<ul>
<li>Branching process models independent parents randomly
producing offspring. “Generative”</li>
<li>Total population size can vary, and has a random component and
deterministic one <span class="math inline">\(m\)</span></li>
<li>Qualitative result when <span class="math inline">\(m = 1\)</span> is that there is one longest
surviving line. This is “fixation”, when one <em>type</em> becomes
universal.</li>
<li></li>
</ul>
</div>
<div id="another-cell-phone-example" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Another cell phone example</h3>
<p>As in the Branching Processes chapter, let’s simulate the creation of generations using the numbers of cell-phone numbers (which are random). For this case, we need as many cell phone numbers as the generations to create, but each next cell phone number is a combination of digits from the first cell phone number. Let these ficticious cell phone numbers be: 731 660 5362 and 530 666 7723. Note how the second number does not contain any 4s, 8s or 9s.</p>
<p>Generation 1 starts off with a sequence of numbers from 0 to 9. Then for generation 2, we assign each digit of the cell phone to one of cells. We repeat this for generation 3 but with the second cell phone number.</p>
<p>+———–+—————————————+
| generation| allele type |
| # | |
+===========+===+===+===+===+===+===+===+===+===+===+
| 1 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
+———–+—+—+—+—+—+—+—+—+—+—+
| 2 | 7 | 3 | 1 | 6 | 6 | 0 | 5 | 3 | 6 | 2 |<br />
+———–+—+—+—+—+—+—+—+—+—+—+
| 3 | 5 | 3 | 0 | 6 | 6 | 6 | 7 | 7 | 2 | 3 |
+———–+—+—+—+—+—+—+—+—+—+—+</p>
<p>If we translate this graph into a tally of the alleles by generation we see that some alleles are passed/‘’survive’’ more than others.</p>
<p>+———+———————–+
|allele | Count per generation |
| type | 1 | 2 | 3 |
+=========+=======+=======+=======+
| 1 | 1 | 1 | 1 |
| 2 | 1 | 1 | 1 |
| 3 | 1 | 2 | 2 |
| 4 | 1 | 0 | 0 |
| 5 | 1 | 1 | 1 |
| 6 | 1 | 3 | 3 |
| 7 | 1 | 1 | 2 |
| 8 | 1 | 0 | 0 |
| 9 | 1 | 0 | 0 |
+=========+=======+=======+=======+
- Here, allele type 6 will most likely dominate. This means that everybody will likely become similar and that individual types disappear.</p>
<p><strong>NOTE FOR JOSH</strong>: does this explanation make sense? I had a hard time following the cell-phone number example in class so my notes are incomplete. Also, it’s not so straightforward to me how the “Children are choosing their parents here”. Could you explain this more?</p>
</div>
</div>
<div id="mutation" class="section level2">
<h2><span class="header-section-number">9.3</span> Mutation</h2>
<p>Let’s simulate the process from the example below. We first present some useful functions.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1">  fwm &lt;-<span class="st"> </span><span class="cf">function</span>(N, n_gen, <span class="dt">mu =</span> <span class="dv">0</span>) <span class="co">## mu != 4/N</span></a>
<a class="sourceLine" id="cb107-2" data-line-number="2">  {</a>
<a class="sourceLine" id="cb107-3" data-line-number="3">      <span class="co">## simulate fisher-wright (with mutations)</span></a>
<a class="sourceLine" id="cb107-4" data-line-number="4">      x &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="dv">1</span><span class="op">:</span>N) <span class="co">## starting types</span></a>
<a class="sourceLine" id="cb107-5" data-line-number="5">      A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> n_gen, <span class="dt">ncol =</span> N)</a>
<a class="sourceLine" id="cb107-6" data-line-number="6">      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_gen)</a>
<a class="sourceLine" id="cb107-7" data-line-number="7">      {</a>
<a class="sourceLine" id="cb107-8" data-line-number="8">          A[i,] &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb107-9" data-line-number="9">          x &lt;-<span class="st"> </span><span class="kw">sample</span>(x, <span class="dt">size =</span> N, <span class="dt">replace =</span> T) <span class="co"># Sample from previous generation and draw with replacement</span></a>
<a class="sourceLine" id="cb107-10" data-line-number="10">          x &lt;-<span class="st"> </span><span class="kw">mut</span>(x, mu) </a>
<a class="sourceLine" id="cb107-11" data-line-number="11">          x</a>
<a class="sourceLine" id="cb107-12" data-line-number="12">      }</a>
<a class="sourceLine" id="cb107-13" data-line-number="13">      <span class="kw">return</span>(A) <span class="co">## matrix of types, each line a generation.</span></a>
<a class="sourceLine" id="cb107-14" data-line-number="14">  }</a>
<a class="sourceLine" id="cb107-15" data-line-number="15"></a>
<a class="sourceLine" id="cb107-16" data-line-number="16"><span class="co"># Function to detect number of mutations. This occurs with probability mu. </span></a>
<a class="sourceLine" id="cb107-17" data-line-number="17">  mut &lt;-<span class="st"> </span><span class="cf">function</span>(x, mu)</a>
<a class="sourceLine" id="cb107-18" data-line-number="18">  {</a>
<a class="sourceLine" id="cb107-19" data-line-number="19">      <span class="co">## m, the individuals that mutate</span></a>
<a class="sourceLine" id="cb107-20" data-line-number="20">      m &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">rbinom</span>(<span class="kw">length</span>(x), <span class="dt">size=</span> <span class="dv">1</span>, <span class="dt">prob =</span> mu) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb107-21" data-line-number="21">      <span class="cf">if</span> (<span class="kw">length</span>(m) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="co">## if no-one mutates</span></a>
<a class="sourceLine" id="cb107-22" data-line-number="22">          <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb107-23" data-line-number="23">      <span class="co">## add a suffix to their ID, so it will be unique (infinite alleles)</span></a>
<a class="sourceLine" id="cb107-24" data-line-number="24">      suffix &lt;-<span class="st"> </span><span class="dv">10000</span><span class="op">*</span><span class="kw">round</span>(<span class="kw">runif</span>(<span class="kw">length</span>(m)),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb107-25" data-line-number="25">      x[m] &lt;-<span class="st"> </span><span class="kw">paste0</span>(x[m], <span class="st">&quot;.&quot;</span>, suffix)</a>
<a class="sourceLine" id="cb107-26" data-line-number="26">      x</a>
<a class="sourceLine" id="cb107-27" data-line-number="27">  }</a></code></pre></div>
<p>Here we try it out. Each row is a generation and each column is a type of allele. Notice that already by the third generation, there are several numbers that are not drawn anymore: 3,4,6,8,9.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">  <span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb108-2" data-line-number="2">  <span class="kw">fwm</span>(<span class="dt">N =</span> <span class="dv">10</span>, <span class="dt">n_gen =</span> <span class="dv">6</span>, <span class="dt">mu =</span> <span class="dv">0</span>)</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,] &quot;1&quot;  &quot;2&quot;  &quot;3&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot; 
## [2,] &quot;9&quot;  &quot;4&quot;  &quot;7&quot;  &quot;1&quot;  &quot;2&quot;  &quot;7&quot;  &quot;2&quot;  &quot;3&quot;  &quot;1&quot;  &quot;5&quot;  
## [3,] &quot;2&quot;  &quot;5&quot;  &quot;7&quot;  &quot;5&quot;  &quot;2&quot;  &quot;1&quot;  &quot;2&quot;  &quot;2&quot;  &quot;1&quot;  &quot;1&quot;  
## [4,] &quot;2&quot;  &quot;2&quot;  &quot;5&quot;  &quot;1&quot;  &quot;1&quot;  &quot;2&quot;  &quot;5&quot;  &quot;7&quot;  &quot;1&quot;  &quot;1&quot;  
## [5,] &quot;1&quot;  &quot;2&quot;  &quot;1&quot;  &quot;1&quot;  &quot;1&quot;  &quot;1&quot;  &quot;5&quot;  &quot;2&quot;  &quot;1&quot;  &quot;7&quot;  
## [6,] &quot;1&quot;  &quot;5&quot;  &quot;2&quot;  &quot;1&quot;  &quot;7&quot;  &quot;5&quot;  &quot;1&quot;  &quot;7&quot;  &quot;1&quot;  &quot;2&quot;</code></pre>
<p>The graph below shows a simulation of 20 generations each of size 10. The colors represent different types drawn in each generation. Let’s analyze it more.</p>
<ul>
<li>By generation 5, many of the lines are flat (ocurrence = 0%) which means that they go extinct and the following generations can only select types from a reduced sample.</li>
<li>For instance line “5” (pink) is selected until generation 10. Around generation 7, it becomes the most prevalent type but then falls as other types are drawn relatively more. As we are looking at the ocurrence in samples were types disappear, the rises and falls in lines are indicate the substitution of numbers as some go extinct.</li>
<li>By generation 15, all draws are 2s and the other numbers do not ‘’survive’’</li>
<li><span class="math inline">\(E(p_i(t) | p_i(t-1))\)</span> is the likelihood that the same number (type) will be drawn given that it was drawn before. <strong>NOTE TO JOSH</strong>: is this really what the expectation means? Not on slides</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">  <span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb110-2" data-line-number="2">  A &lt;-<span class="st"> </span><span class="kw">fwm</span>(<span class="dt">N =</span> <span class="dv">10</span>, <span class="dt">n_gen =</span> <span class="dv">20</span>, <span class="dt">mu =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb110-3" data-line-number="3">  tt &lt;-<span class="st"> </span><span class="kw">table</span>(A, <span class="kw">row</span>(A)) <span class="co">## count types by row</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4">  ptt &lt;-<span class="st"> </span><span class="kw">prop.table</span>(tt, <span class="dv">2</span>) <span class="co">## proportions</span></a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-87"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-87-1.png" alt="Generation composition" width="672" />
<p class="caption">
Figure 9.1: Generation composition
</p>
</div>
<p>This time, let’s increase the number of generations (200) and the number of types drawn at every step. In the long run, many of the colored lines disappear and the generations are composed of a handful of types.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1">  <span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb111-2" data-line-number="2">  A &lt;-<span class="st"> </span><span class="kw">fwm</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">n_gen =</span> <span class="dv">200</span>, <span class="dt">mu =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb111-3" data-line-number="3">  tt &lt;-<span class="st"> </span><span class="kw">table</span>(A, <span class="kw">row</span>(A)) <span class="co">## count types by row</span></a>
<a class="sourceLine" id="cb111-4" data-line-number="4">  ptt &lt;-<span class="st"> </span><span class="kw">prop.table</span>(tt, <span class="dv">2</span>) <span class="co">## proportions</span></a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-89"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-89-1.png" alt="Generation composition long term" width="672" />
<p class="caption">
Figure 9.2: Generation composition long term
</p>
</div>
</div>
<div id="fixation" class="section level2">
<h2><span class="header-section-number">9.4</span> Fixation</h2>
<p>Given that we saw before that some of the lines will disappear, we can look about keeping some of the lines fixed (that it will always be selected). For instance,</p>
<ul>
<li>What is probability that line <span class="math inline">\(i\)</span> will ``fix’’?</li>
<li>What is expected time until some line fixes?</li>
<li>How can we describe the path to fixation?</li>
</ul>
<div id="probability-that-a-particular-line-will-fix" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Probability that a particular line will “fix”</h3>
<p><strong>NOTE TO JOSH</strong>: the slide said that finding this was easy but I don’t necessarily see how the result from the graph goes with the formula below.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1">  <span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb112-2" data-line-number="2">  A &lt;-<span class="st"> </span><span class="kw">fwm</span>(<span class="dt">N =</span> <span class="dv">10</span>, <span class="dt">n_gen =</span> <span class="dv">20</span>, <span class="dt">mu =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb112-3" data-line-number="3">  tt &lt;-<span class="st"> </span><span class="kw">table</span>(A, <span class="kw">row</span>(A)) <span class="co">## count types by row</span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4">  ptt &lt;-<span class="st"> </span><span class="kw">prop.table</span>(tt, <span class="dv">2</span>) <span class="co">## proportions</span></a>
<a class="sourceLine" id="cb112-5" data-line-number="5">  <span class="kw">matplot</span>(<span class="kw">t</span>(ptt), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;FW simu&quot;</span>)</a>
<a class="sourceLine" id="cb112-6" data-line-number="6">  <span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="kw">jitter</span>(ptt[,<span class="dv">4</span>]), <span class="kw">rownames</span>(ptt), <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-90"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-90-1.png" alt="Time to fix" width="672" />
<p class="caption">
Figure 9.3: Time to fix
</p>
</div>
</div>
<div id="expected-time-until-fixation" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Expected time until fixation?</h3>
<p>Answer for us is
<span class="math display">\[
  \bar{T}_{fixed} = 2 \cdot N
  \]</span>
Note: Biologists say <span class="math inline">\(4 N_e\)</span>. See Wikipedia “Genetic drift”</p>
<ul>
<li>Now we carry out simulations of complete processes. In total, we draw 100 times each generation in order to get the time to fixation. For this example, the mean number of generations taken to get only one remaining line is 202 generations <span class="math inline">\(\approx 2 \times\)</span> the starting generation size.</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1">  T.vec &lt;-<span class="st"> </span><span class="ot">NULL</span> </a>
<a class="sourceLine" id="cb113-2" data-line-number="2">  all.the.same &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">length</span>(<span class="kw">unique</span>(x)) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb113-3" data-line-number="3">  <span class="kw">set.seed</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb113-4" data-line-number="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)  <span class="co"># 100 simulations</span></a>
<a class="sourceLine" id="cb113-5" data-line-number="5">  {</a>
<a class="sourceLine" id="cb113-6" data-line-number="6">      A &lt;-<span class="st"> </span><span class="kw">fwm</span>(<span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">n_gen =</span> <span class="dv">1000</span>,<span class="dt">mu =</span> <span class="dv">0</span>)   <span class="co"># generation process: rows are generations and columns are types</span></a>
<a class="sourceLine" id="cb113-7" data-line-number="7">      extinction_time =<span class="st"> </span><span class="kw">min</span>(<span class="kw">row</span>(A)[<span class="kw">apply</span>(A, <span class="dv">1</span>, all.the.same)])  <span class="co"># obtain the first generation when all but one line went extinct</span></a>
<a class="sourceLine" id="cb113-8" data-line-number="8">      T.vec[i] &lt;-<span class="st"> </span>extinction_time</a>
<a class="sourceLine" id="cb113-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb113-10" data-line-number="10">  <span class="kw">mean</span>(T.vec)</a></code></pre></div>
<pre><code>## [1] 202.89</code></pre>
</div>
<div id="path-to-fixation-a-measure-of-homogeneityheterogeneity" class="section level3">
<h3><span class="header-section-number">9.4.3</span> Path to fixation: a measure of homogeneity/heterogeneity</h3>
<ul>
<li>How does the type change over time?</li>
<li>We would like a measure of equality of the types of populations. A low measure would mean that the population is homogeneous while a high measure implies population heterogeneity.</li>
<li>Let the chance that two randomly drawn individuals are of same type be:
<span class="math display">\[  G = \sum_i p_i^2 \]</span></li>
<li>If we have two types, <span class="math inline">\(p_1 = \pi\)</span> , <span class="math inline">\(p_2 = 1-\pi\)</span>. What is G if <span class="math inline">\(\pi = 0, .5, 1\)</span>?</li>
</ul>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1">type_fun  &lt;-<span class="st"> </span><span class="cf">function</span>(pi_vector){</a>
<a class="sourceLine" id="cb115-2" data-line-number="2">  oneminus_pi &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>pi_vector</a>
<a class="sourceLine" id="cb115-3" data-line-number="3">  G &lt;-<span class="st"> </span>pi_vector<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>oneminus_pi<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb115-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb115-5" data-line-number="5">  <span class="kw">return</span>(<span class="kw">plot</span>(pi_vector, G, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Probability type&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb115-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb115-7" data-line-number="7"></a>
<a class="sourceLine" id="cb115-8" data-line-number="8">pi_vector &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb115-9" data-line-number="9"><span class="kw">type_fun</span>(pi_vector)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-92"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-92-1.png" alt="Probability of being the same type" width="480" />
<p class="caption">
Figure 9.4: Probability of being the same type
</p>
</div>
<ul>
<li>Let’s derive time path of G. Assume just two types, <span class="math inline">\(\pi(t)\)</span>
<ul>
<li>The chance that two indivuals are of same type <span class="math display">\[ G_{t+1} = P(\mbox{same parent})\cdot 1 + P(\mbox{different parent})\cdot G_{t} \]</span></li>
<li>The probability of having the same parent is <span class="math inline">\(P(\mbox{same parent}) = \frac{1}{K}\)</span>, where <span class="math inline">\(K\)</span> is the population size. This also implies that anybody in the population can be a parent with equal probability.</li>
<li>Additionally, <span class="math inline">\(P(\mbox{different parent}) = 1- P(\mbox{same parent}) = 1- \frac{1}{K}\)</span></li>
<li>Then, <span class="math display">\[ G_{t+1} = \left(1 \over K\right) \cdot 1 + \left(1 - {1\over K})\right \cdot G_{t}\]</span></li>
<li>For simplicity, let <span class="math inline">\(H = 1 - G\)</span>:</li>
</ul>
<span class="math display">\[\begin{aligned}
1 - H_{t+1} &amp; =  {1 \over K} + \left(1 - {1 \over K} \right) \cdot (1-H_{t})   \\
   &amp; = {1 \over K}  + 1 - H_{t} - {1\over K}+ {1\over K} H_{t} \\
H_{t+1} &amp; = H_{t} - {1\over K} H_{t} \\
H_{t+1} &amp; = H_{t} (1 - 1/K)
\end{aligned}\]</span>
<ul>
<li>For many periods, we start at the initial probabilities.
<span class="math display">\[
H_{t} = H_0 (1 - 1/K)^t % \rightarrow H_0 e^{-t/K}
\]</span>
So, H goes to 0 exponentially, just as G goes to 1.</li>
</ul></li>
</ul>
</div>
</div>
<div id="baby-names" class="section level2">
<h2><span class="header-section-number">9.5</span> Baby Names</h2>
<p>For this section we will look at an application of changes in baby names from this paper:</p>
<blockquote>
<p>“Drift as a mechanism for cultural change: an example from baby names”
by Matthew W. Hahn and R. Alexander Bentley Proc. R. Soc. Lond. B 2003 270, S120-S123</p>
</blockquote>
<div id="basic-idea" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Basic idea</h3>
<ul>
<li>The process seems to be like Fisher-Wright because:
<ul>
<li>people choose from existing set</li>
<li>names are “neutral”</li>
<li>draw proportionally</li>
</ul></li>
<li>Authors test to see if they can reject FW by comparin observed histograms to FW simulation</li>
<li>They include mutation to get a stationary distribution. Note: failing to reject FW doesn’t mean it’s correct</li>
</ul>
<p><img src="images/hahn_pic.png" alt="Baby Names by Matthew W. Hahn and R. Alexander Bentley Proc. R.Soc. Lond. B 2003 270, S120-S123" />
Source: Hahn and Bentley (2003)</p>
</div>
<div id="fisher-wright-simulation-of-baby-names-hahn-and-bentley" class="section level3">
<h3><span class="header-section-number">9.5.2</span> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</h3>
<p>We download and prepare the data:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="kw">download.file</span>(<span class="dt">url=</span> <span class="st">&quot;https://www.ssa.gov/oact/babynames/names.zip&quot;</span>,</a>
<a class="sourceLine" id="cb116-2" data-line-number="2">              <span class="st">&quot;./names.zip&quot;</span>)</a>
<a class="sourceLine" id="cb116-3" data-line-number="3"><span class="kw">unzip</span>(<span class="st">&quot;names.zip&quot;</span>, <span class="dt">exdir =</span> <span class="st">&quot;./names&quot;</span>)</a>
<a class="sourceLine" id="cb116-4" data-line-number="4"></a>
<a class="sourceLine" id="cb116-5" data-line-number="5"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb116-6" data-line-number="6"></a>
<a class="sourceLine" id="cb116-7" data-line-number="7">filenames &lt;-<span class="st"> </span><span class="kw">system</span>(<span class="st">&quot;ls ./names/*.txt&quot;</span>, <span class="dt">intern =</span> T)</a>
<a class="sourceLine" id="cb116-8" data-line-number="8">mylist &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(filenames))</a>
<a class="sourceLine" id="cb116-9" data-line-number="9"><span class="kw">names</span>(mylist) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="dt">pattern =</span> <span class="st">&quot;[^0-9]&quot;</span>, <span class="dt">replace =</span> <span class="st">&quot;&quot;</span>, filenames)</a>
<a class="sourceLine" id="cb116-10" data-line-number="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(filenames))</a>
<a class="sourceLine" id="cb116-11" data-line-number="11">{</a>
<a class="sourceLine" id="cb116-12" data-line-number="12">    myfile &lt;-<span class="st"> </span>filenames[i]</a>
<a class="sourceLine" id="cb116-13" data-line-number="13">    mylist[[i]] &lt;-<span class="st"> </span><span class="kw">fread</span>(myfile)</a>
<a class="sourceLine" id="cb116-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb116-15" data-line-number="15"></a>
<a class="sourceLine" id="cb116-16" data-line-number="16"><span class="co"># Final dataframe</span></a>
<a class="sourceLine" id="cb116-17" data-line-number="17">dt &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(mylist, <span class="dt">idcol =</span> <span class="st">&quot;year&quot;</span>)</a>
<a class="sourceLine" id="cb116-18" data-line-number="18"><span class="kw">names</span>(dt) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;sex&quot;</span>, <span class="st">&quot;N&quot;</span>)</a>
<a class="sourceLine" id="cb116-19" data-line-number="19"></a>
<a class="sourceLine" id="cb116-20" data-line-number="20"><span class="co">## Focus on male names from 1900-1909</span></a>
<a class="sourceLine" id="cb116-21" data-line-number="21">my.dt &lt;-<span class="st"> </span>dt[sex <span class="op">==</span><span class="st"> &quot;M&quot;</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">%in%</span><span class="st"> </span><span class="dv">1900</span><span class="op">:</span><span class="dv">1909</span>]</a>
<a class="sourceLine" id="cb116-22" data-line-number="22">foo &lt;-<span class="st"> </span>my.dt[, .(<span class="dt">N =</span> <span class="kw">sum</span>(N)), by =<span class="st"> </span>name]</a>
<a class="sourceLine" id="cb116-23" data-line-number="23">foo &lt;-<span class="st"> </span>foo[<span class="kw">order</span>(N, <span class="dt">decreasing =</span> T)]</a>
<a class="sourceLine" id="cb116-24" data-line-number="24">bar &lt;-<span class="st"> </span>foo[<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>,] <span class="co">## 1000 top names</span></a>
<a class="sourceLine" id="cb116-25" data-line-number="25"></a>
<a class="sourceLine" id="cb116-26" data-line-number="26"><span class="co"># Observed histogram of name occurence</span></a>
<a class="sourceLine" id="cb116-27" data-line-number="27">my.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">^</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">11</span>)<span class="op">/</span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb116-28" data-line-number="28">bar[, p <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">round</span>(<span class="kw">prop.table</span>(N),<span class="dv">5</span>)] <span class="co"># N column contains the share of times that a name is used</span></a>
<a class="sourceLine" id="cb116-29" data-line-number="29">bar[, pcat <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cut</span>(p, <span class="dt">breaks =</span>  my.breaks, <span class="dt">right =</span> F, <span class="dt">include.lowest =</span> T)]</a>
<a class="sourceLine" id="cb116-30" data-line-number="30"></a>
<a class="sourceLine" id="cb116-31" data-line-number="31">out &lt;-<span class="st"> </span><span class="kw">unclass</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(bar<span class="op">$</span>pcat)))</a>
<a class="sourceLine" id="cb116-32" data-line-number="32"></a>
<a class="sourceLine" id="cb116-33" data-line-number="33"></a>
<a class="sourceLine" id="cb116-34" data-line-number="34">my.x &lt;-<span class="st"> </span>my.breaks[<span class="op">-</span><span class="kw">length</span>(my.breaks)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(my.breaks)<span class="op">/</span><span class="dv">2</span></a></code></pre></div>
<p>Then we look at observed frequencies and they seem to behave as a power law (in log-log)</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">plot</span>(my.x, out, <span class="dt">log =</span> <span class="st">&quot;xy&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Frequency of name&quot;</span>, <span class="dt">ylab=</span> <span class="st">&quot;log(share)&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in xy.coords(x, y, xlabel, ylabel, log): 1 y value &lt;= 0 omitted from logarithmic plot</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-94"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-94-1.png" alt="Power law in baby name appearance" width="480" />
<p class="caption">
Figure 9.5: Power law in baby name appearance
</p>
</div>
</div>
<div id="drawing-their-picture-with-simulation" class="section level3">
<h3><span class="header-section-number">9.5.3</span> Drawing their picture with simulation</h3>
<p>Let’s look at evolution over time of G: chance that two individuals are of same type.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">get.G &lt;-<span class="st"> </span><span class="cf">function</span>(x)</a>
<a class="sourceLine" id="cb119-2" data-line-number="2">{</a>
<a class="sourceLine" id="cb119-3" data-line-number="3">    tt &lt;-<span class="st"> </span><span class="kw">table</span>(x)</a>
<a class="sourceLine" id="cb119-4" data-line-number="4">    p &lt;-<span class="st"> </span><span class="kw">prop.table</span>(tt)</a>
<a class="sourceLine" id="cb119-5" data-line-number="5">    <span class="kw">sum</span>(p<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb119-6" data-line-number="6">}</a></code></pre></div>
<p>First we look at the case were there is no mutation</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">A &lt;-<span class="st"> </span><span class="kw">fwm</span>(<span class="dv">1000</span>, <span class="dt">n_gen =</span> <span class="dv">4000</span>, <span class="dt">mu =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb120-2" data-line-number="2">G.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(A, <span class="dv">1</span>, get.G)</a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="kw">plot</span>(G.vec, <span class="dt">ylab =</span> <span class="st">&quot;G&quot;</span>, <span class="dt">xlab=</span> <span class="st">&quot;# Generation&quot;</span>, <span class="dt">type =</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-96"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-96-1.png" alt="G path (without mutation)" width="480" />
<p class="caption">
Figure 9.6: G path (without mutation)
</p>
</div>
<p>With mutation a single trial shows that the G value oscillates a lot around 0.1.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">N =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2">A &lt;-<span class="st"> </span><span class="kw">fwm</span>(N, <span class="dt">n_gen =</span> <span class="dv">3000</span>, <span class="dt">mu =</span> <span class="dv">4</span><span class="op">/</span>N)</a>
<a class="sourceLine" id="cb121-3" data-line-number="3">G.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(A, <span class="dv">1</span>, get.G)</a>
<a class="sourceLine" id="cb121-4" data-line-number="4"><span class="kw">plot</span>(G.vec, <span class="dt">ylab =</span> <span class="st">&quot;G&quot;</span>, <span class="dt">xlab=</span> <span class="st">&quot;# Generation&quot;</span>, <span class="dt">type =</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-97"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-97-1.png" alt="G path (with mutation, 1 trial)" width="480" />
<p class="caption">
Figure 9.7: G path (with mutation, 1 trial)
</p>
</div>
<p>We can increase the number of trials (up to 100 here) and look at the average (yellow horizontal line).</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">n_gen =<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb122-2" data-line-number="2">n_trials =<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb122-3" data-line-number="3">G.mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,  n_trials, n_gen)</a>
<a class="sourceLine" id="cb122-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_trials)</a>
<a class="sourceLine" id="cb122-5" data-line-number="5">    {</a>
<a class="sourceLine" id="cb122-6" data-line-number="6">        N =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb122-7" data-line-number="7">        A &lt;-<span class="st"> </span><span class="kw">fwm</span>(N, n_gen, <span class="dt">mu =</span> <span class="dv">4</span><span class="op">/</span>N)</a>
<a class="sourceLine" id="cb122-8" data-line-number="8">        G.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(A, <span class="dv">1</span>, get.G)</a>
<a class="sourceLine" id="cb122-9" data-line-number="9">        G.mat[i,] &lt;-<span class="st"> </span>G.vec</a>
<a class="sourceLine" id="cb122-10" data-line-number="10">        }</a>
<a class="sourceLine" id="cb122-11" data-line-number="11">G.bar &lt;-<span class="st"> </span><span class="kw">apply</span>(G.mat, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb122-12" data-line-number="12"></a>
<a class="sourceLine" id="cb122-13" data-line-number="13"><span class="kw">matplot</span>(<span class="kw">t</span>(G.mat), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;G&quot;</span>, <span class="dt">xlab=</span> <span class="st">&quot;# Generation&quot;</span>)</a>
<a class="sourceLine" id="cb122-14" data-line-number="14"><span class="kw">lines</span>(G.bar, <span class="dt">lwd =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb122-15" data-line-number="15"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">9</span>, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;yellow&quot;</span>, <span class="dt">lwd =</span> <span class="dv">5</span>)</a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-98"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-98-1.png" alt="G path (with mutation, 100 trials)" width="480" />
<p class="caption">
Figure 9.8: G path (with mutation, 100 trials)
</p>
</div>
<p>Why is the mean about .11?</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">8</span>)</a></code></pre></div>
<p>Gillespie tells us that <span class="math inline">\(\bar{G}\)</span> is supposed to be <span class="math inline">\(\frac{1}{(1 + 4*Ne*mu)}\)</span></p>
<p>How does 4<em>Ne</em>mu = 8?</p>
<p>Well, we have <span class="math inline">\(K*mu = 4\)</span> and since <span class="math inline">\(K = 2*Ne\)</span>, <span class="math inline">\(Ne = = K/2\)</span> (maybe)</p>
</div>
<div id="fw-babyname-simulation-of-equilibrium-frequencies" class="section level3">
<h3><span class="header-section-number">9.5.4</span> FW babyname simulation of equilibrium frequencies</h3>
<p><strong>NOTE TO JOSH</strong>: I don’t really know what is going on here and I noticed that the code mentions that it might not be (w)right.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1">N =<span class="st"> </span><span class="dv">1000</span> <span class="co">## Not sure if this is (w)right :)</span></a>
<a class="sourceLine" id="cb124-2" data-line-number="2">mu =<span class="st"> </span><span class="dv">4</span><span class="op">/</span>N <span class="co">## [1] 0.004</span></a>
<a class="sourceLine" id="cb124-3" data-line-number="3">theta =<span class="st"> </span>N<span class="op">*</span>mu <span class="co">## [1] 4 ## H&amp;B&#39;s &quot;best fit&quot;</span></a></code></pre></div>
</div>
</div>
<div id="now-we-can-simulate-babyynmes" class="section level2">
<h2><span class="header-section-number">9.6</span> Now we can simulate babyynmes</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1">n_gen =<span class="st"> </span><span class="dv">1001</span></a>
<a class="sourceLine" id="cb125-2" data-line-number="2">N =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb125-3" data-line-number="3"><span class="co">## set.seed(1)</span></a>
<a class="sourceLine" id="cb125-4" data-line-number="4"><span class="co">## A &lt;- fwm2(N, n_gen, mu = 4/N)</span></a>
<a class="sourceLine" id="cb125-5" data-line-number="5"><span class="co">#A &lt;- fwm2(N, n_gen, mu = 8/N)</span></a>
<a class="sourceLine" id="cb125-6" data-line-number="6"><span class="co">###############</span></a>
<a class="sourceLine" id="cb125-7" data-line-number="7"><span class="co">#What about the fwm2 function?</span></a>
<a class="sourceLine" id="cb125-8" data-line-number="8"><span class="co">#######################</span></a>
<a class="sourceLine" id="cb125-9" data-line-number="9">A &lt;-<span class="st"> </span><span class="kw">fwm</span>(N, n_gen, <span class="dt">mu =</span> <span class="dv">8</span><span class="op">/</span>N)</a>
<a class="sourceLine" id="cb125-10" data-line-number="10"><span class="co">## ok, lets do power law plot of this</span></a>
<a class="sourceLine" id="cb125-11" data-line-number="11">x &lt;-<span class="st"> </span>A[<span class="dv">1001</span>,]</a>
<a class="sourceLine" id="cb125-12" data-line-number="12">tt &lt;-<span class="st"> </span><span class="kw">table</span>(x)</a>
<a class="sourceLine" id="cb125-13" data-line-number="13">ptt &lt;-<span class="st"> </span><span class="kw">prop.table</span>(tt)</a>
<a class="sourceLine" id="cb125-14" data-line-number="14">my.breaks &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="op">^</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">11</span>)<span class="op">/</span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb125-15" data-line-number="15">p &lt;-<span class="st"> </span>ptt</a>
<a class="sourceLine" id="cb125-16" data-line-number="16"><span class="co">## bar[, p := round(prop.table(N),5)]</span></a>
<a class="sourceLine" id="cb125-17" data-line-number="17"><span class="co">##bar[, pcat := cut(p, breaks =  my.breaks, right = F, include.lowest = T)]</span></a>
<a class="sourceLine" id="cb125-18" data-line-number="18">pcat =<span class="st"> </span><span class="kw">cut</span>(p, <span class="dt">breaks =</span>  my.breaks, <span class="dt">right =</span> F, <span class="dt">include.lowest =</span> T)</a>
<a class="sourceLine" id="cb125-19" data-line-number="19">out &lt;-<span class="st"> </span><span class="kw">unclass</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(bar<span class="op">$</span>pcat)))</a>
<a class="sourceLine" id="cb125-20" data-line-number="20">out.hat &lt;-<span class="st"> </span><span class="kw">unclass</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(pcat)))</a>
<a class="sourceLine" id="cb125-21" data-line-number="21">my.x &lt;-<span class="st"> </span>my.breaks[<span class="op">-</span><span class="kw">length</span>(my.breaks)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(my.breaks)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb125-22" data-line-number="22"><span class="kw">plot</span>(my.x, out, <span class="dt">log =</span> <span class="st">&quot;xy&quot;</span>)</a>
<a class="sourceLine" id="cb125-23" data-line-number="23"><span class="kw">lines</span>(my.x, out.hat)</a></code></pre></div>
</div>
<div id="conclusions-5" class="section level2">
<h2><span class="header-section-number">9.7</span> Conclusions</h2>
<ul>
<li>Fisher-Wright an alternative to branching processes</li>
<li>It reverses logic of reproduction, but gives similar
quantitative and qualitative results</li>
<li>A neutral model for other processes?</li>
<li>Starting point for coalescent</li>
</ul>
<div id="some-potential-criticism" class="section level3">
<h3><span class="header-section-number">9.7.1</span> Some potential criticism</h3>
<ul>
<li><p>While we can’t reject that there’s some parameterization of
FW that gives us similar disn, this doesn’t mean that we’ve
found the right mechanism. (Just that we can’t reject it).</p></li>
<li><p>What are some other tests of this mechanism?</p></li>
<li>Markov assumption. We could see if each frequency really
followed random walk.</li>
<li><p>Perhaps we could see if variances were scaled to
frequencies correctly.</p></li>
</ul>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-felsenstein2005theoretical">
<p>Felsenstein, Joseph. 2005. “Theoretical Evolutionary Genetics Joseph Felsenstein.” <em>University of Washington, Seattle</em>. <a href="https://evolution.gs.washington.edu/gs562/2017/pgbook.pdf">https://evolution.gs.washington.edu/gs562/2017/pgbook.pdf</a>.</p>
</div>
<div id="ref-hahn2003drift">
<p>Hahn, Matthew W, and R Alexander Bentley. 2003. “Drift as a Mechanism for Cultural Change: An Example from Baby Names.” <em>Proceedings of the Royal Society of London. Series B: Biological Sciences</em> 270 (suppl_1). The Royal Society: S120–S123.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="branching-processes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="coalescent.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-fw.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
