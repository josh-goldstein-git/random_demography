<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Tempo | Mathematical Demography</title>
  <meta name="description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Tempo | Mathematical Demography" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Tempo | Mathematical Demography" />
  
  <meta name="twitter:description" content="This is a book from the Mathematical Demography lecture notes." />
  

<meta name="author" content="Josh R. Goldstein" />


<meta name="date" content="2020-07-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mortality-plateaus.html"/>
<link rel="next" href="branching-processes.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Random Demography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Demographic Heterogeneity</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#part-i.-conceptual-introduction"><i class="fa fa-check"></i><b>2.2</b> Part I. Conceptual Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#what-is-demographic-heterogeneity"><i class="fa fa-check"></i><b>2.2.1</b> What is Demographic Heterogeneity?</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#an-example"><i class="fa fa-check"></i><b>2.2.2</b> An example</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#a-2nd-example-exponential-growth-two-countries"><i class="fa fa-check"></i><b>2.2.3</b> A 2nd example: Exponential growth, two countries</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#more-examples-to-work"><i class="fa fa-check"></i><b>2.2.4</b> More examples to work</a></li>
<li class="chapter" data-level="2.2.5" data-path="intro.html"><a href="intro.html#application"><i class="fa fa-check"></i><b>2.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#part-ii.-formal-analysis"><i class="fa fa-check"></i><b>2.3</b> Part II. Formal Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#outline-1"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#keyfitz-result"><i class="fa fa-check"></i><b>2.3.2</b> Keyfitz result</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#us-mexico-example"><i class="fa fa-check"></i><b>2.3.3</b> US-Mexico Example</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#the-origin-of-professor-wachters-poisson-exponential-model"><i class="fa fa-check"></i><b>2.3.4</b> The Origin of Professor Wachter’s Poisson-Exponential Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#some-commentary"><i class="fa fa-check"></i><b>2.3.5</b> Some commentary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>3</b> Multiplicative Fixed Frailty</a><ul>
<li class="chapter" data-level="3.1" data-path="frailty.html"><a href="frailty.html#outline-2"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frailty.html"><a href="frailty.html#review-of-mortality-mathematics"><i class="fa fa-check"></i><b>3.1.1</b> Review of mortality mathematics</a></li>
<li class="chapter" data-level="3.1.2" data-path="frailty.html"><a href="frailty.html#application-what-is-ellx"><i class="fa fa-check"></i><b>3.1.2</b> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="frailty.html"><a href="frailty.html#extending-keyfitz-to-mortality"><i class="fa fa-check"></i><b>3.1.3</b> Extending Keyfitz to mortality</a></li>
<li class="chapter" data-level="3.1.4" data-path="frailty.html"><a href="frailty.html#fragile"><i class="fa fa-check"></i><b>3.1.4</b> fragile</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frailty.html"><a href="frailty.html#part-i.-results-from-fixed-frailty"><i class="fa fa-check"></i><b>3.2</b> Part I. Results from Fixed Frailty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frailty.html"><a href="frailty.html#a-simulation"><i class="fa fa-check"></i><b>3.2.1</b> A simulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="frailty.html"><a href="frailty.html#lets-derive-pop-survival-note-bars-barell"><i class="fa fa-check"></i><b>3.2.2</b> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="frailty.html"><a href="frailty.html#now-population-hazards-stepping-stones"><i class="fa fa-check"></i><b>3.2.3</b> Now population hazards (stepping stones)</a></li>
<li class="chapter" data-level="3.2.4" data-path="frailty.html"><a href="frailty.html#rodriguez-question"><i class="fa fa-check"></i><b>3.2.4</b> Rodriguez question</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frailty.html"><a href="frailty.html#part-ii.-introduction-to-gamma-frailty"><i class="fa fa-check"></i><b>3.3</b> Part II. Introduction to Gamma Frailty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frailty.html"><a href="frailty.html#the-gamma-distribution"><i class="fa fa-check"></i><b>3.3.1</b> The Gamma distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="frailty.html"><a href="frailty.html#gamma-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Gamma in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="frailty.html"><a href="frailty.html#population-survival-of-gamma-frailty"><i class="fa fa-check"></i><b>3.3.3</b> Population Survival of Gamma Frailty</a></li>
<li class="chapter" data-level="3.3.4" data-path="frailty.html"><a href="frailty.html#interpreting-gamma-frailty-survival"><i class="fa fa-check"></i><b>3.3.4</b> Interpreting Gamma-frailty survival</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frailty.html"><a href="frailty.html#conclusions-1"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html"><i class="fa fa-check"></i><b>4</b> Gamma Frailty with Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#from-pop-survival-to-pop-hazards"><i class="fa fa-check"></i><b>4.1</b> From pop survival to pop hazards</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#what-happens-to-frailty-of-survivors"><i class="fa fa-check"></i><b>4.1.1</b> What happens to frailty of survivors?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#selection-and-observed-frailty-in-censoc"><i class="fa fa-check"></i><b>4.2</b> Selection and observed frailty in CenSoc</a><ul>
<li class="chapter" data-level="4.2.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#data"><i class="fa fa-check"></i><b>4.2.1</b> Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#estimation"><i class="fa fa-check"></i><b>4.2.2</b> Estimation</a></li>
<li class="chapter" data-level="4.2.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#discuss-our-conclusions-and-possible-future-directions-to-follow."><i class="fa fa-check"></i><b>4.2.3</b> Discuss our conclusions and possible future directions to follow.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html"><i class="fa fa-check"></i><b>5</b> Convergence and cross-overs</a><ul>
<li class="chapter" data-level="5.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#outline-3"><i class="fa fa-check"></i><b>5.1</b> Outline</a></li>
<li class="chapter" data-level="5.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#what-happens-to-mortality-disparities-at-older-ages"><i class="fa fa-check"></i><b>5.2</b> What happens to mortality disparities at older ages?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-possible-null-model"><i class="fa fa-check"></i><b>5.2.1</b> A possible null-model</a></li>
<li class="chapter" data-level="5.2.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-result-5e"><i class="fa fa-check"></i><b>5.2.2</b> A result: (5E)</a></li>
<li class="chapter" data-level="5.2.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#inversion"><i class="fa fa-check"></i><b>5.2.3</b> Inversion</a></li>
<li class="chapter" data-level="5.2.4" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#an-example-1"><i class="fa fa-check"></i><b>5.2.4</b> An example</a></li>
<li class="chapter" data-level="5.2.5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#application-1"><i class="fa fa-check"></i><b>5.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#student-presentation"><i class="fa fa-check"></i><b>5.3</b> Student Presentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html"><i class="fa fa-check"></i><b>6</b> Mortality plateaus</a><ul>
<li class="chapter" data-level="6.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-4"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#heterogeneity-slows-mortality-improvement"><i class="fa fa-check"></i><b>6.2</b> Heterogeneity slows mortality improvement</a><ul>
<li class="chapter" data-level="6.2.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#an-example-2"><i class="fa fa-check"></i><b>6.2.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#conclusions-2"><i class="fa fa-check"></i><b>6.3</b> Conclusions</a></li>
<li class="chapter" data-level="6.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#kens-class---hazards-and-plateaus"><i class="fa fa-check"></i><b>6.4</b> Ken’s class - Hazards and Plateaus</a><ul>
<li class="chapter" data-level="6.4.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#extremes-of-longevity-in-humans-and-other-species"><i class="fa fa-check"></i><b>6.4.1</b> Extremes of Longevity in Humans and Other Species</a></li>
<li class="chapter" data-level="6.4.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#gamma-gompertz-fixed-frailty-hazards"><i class="fa fa-check"></i><b>6.4.2</b> Gamma-Gompertz Fixed Frailty Hazards</a></li>
<li class="chapter" data-level="6.4.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#less-restrictive-frailty-models"><i class="fa fa-check"></i><b>6.4.3</b> Less Restrictive Frailty Models</a></li>
<li class="chapter" data-level="6.4.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#mutation-accumulation-gompertz-hazards-with-plateaus"><i class="fa fa-check"></i><b>6.4.4</b> Mutation Accumulation, Gompertz Hazards with Plateaus</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#key-points"><i class="fa fa-check"></i><b>6.5</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tempo.html"><a href="tempo.html"><i class="fa fa-check"></i><b>7</b> Tempo</a><ul>
<li class="chapter" data-level="7.1" data-path="tempo.html"><a href="tempo.html#outline-5"><i class="fa fa-check"></i><b>7.1</b> Outline</a></li>
<li class="chapter" data-level="7.2" data-path="tempo.html"><a href="tempo.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="tempo.html"><a href="tempo.html#fertility-postponement-a-very-simple-example"><i class="fa fa-check"></i><b>7.2.1</b> Fertility postponement, a very simple example</a></li>
<li class="chapter" data-level="7.2.2" data-path="tempo.html"><a href="tempo.html#continuous-postponement-a-shiny-simulation"><i class="fa fa-check"></i><b>7.2.2</b> Continuous postponement, a shiny simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tempo.html"><a href="tempo.html#period-shifts-bongaarts-and-feeneys-model"><i class="fa fa-check"></i><b>7.3</b> Period Shifts: Bongaarts and Feeney’s model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="tempo.html"><a href="tempo.html#a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here"><i class="fa fa-check"></i><b>7.3.1</b> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="tempo.html"><a href="tempo.html#an-application-to-the-united-states"><i class="fa fa-check"></i><b>7.4</b> An Application to the United States</a><ul>
<li class="chapter" data-level="7.4.1" data-path="tempo.html"><a href="tempo.html#conclusions-3"><i class="fa fa-check"></i><b>7.4.1</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="tempo.html"><a href="tempo.html#two-americas"><i class="fa fa-check"></i><b>7.5</b> Two Americas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tempo.html"><a href="tempo.html#mixture"><i class="fa fa-check"></i><b>7.5.1</b> Mixture</a></li>
<li class="chapter" data-level="7.5.2" data-path="tempo.html"><a href="tempo.html#an-algorithm-for-tempo-adjustment-of-mixtures"><i class="fa fa-check"></i><b>7.5.2</b> An algorithm for tempo adjustment of mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tempo.html"><a href="tempo.html#conclusions-4"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a><ul>
<li class="chapter" data-level="7.6.1" data-path="tempo.html"><a href="tempo.html#caveats"><i class="fa fa-check"></i><b>7.6.1</b> Caveats</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="branching-processes.html"><a href="branching-processes.html"><i class="fa fa-check"></i><b>8</b> Branching Processes</a><ul>
<li class="chapter" data-level="8.1" data-path="branching-processes.html"><a href="branching-processes.html#outline-6"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="branching-processes.html"><a href="branching-processes.html#motivation"><i class="fa fa-check"></i><b>8.2</b> Motivation</a><ul>
<li class="chapter" data-level="8.2.1" data-path="branching-processes.html"><a href="branching-processes.html#very-brief-history-of-branching-processes"><i class="fa fa-check"></i><b>8.2.1</b> Very brief history of Branching Processes</a></li>
<li class="chapter" data-level="8.2.2" data-path="branching-processes.html"><a href="branching-processes.html#applicability-to-the-coronavirus-yes-and-no."><i class="fa fa-check"></i><b>8.2.2</b> Applicability to the Coronavirus? Yes and no.</a></li>
<li class="chapter" data-level="8.2.3" data-path="branching-processes.html"><a href="branching-processes.html#simulated-examples-and-the-questions-they-raise"><i class="fa fa-check"></i><b>8.2.3</b> Simulated examples and the questions they raise</a></li>
<li class="chapter" data-level="8.2.4" data-path="branching-processes.html"><a href="branching-processes.html#what-is-a-bienayme-galton-watson-branching-process"><i class="fa fa-check"></i><b>8.2.4</b> What is a (Bienayme)-Galton-Watson branching process?</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="branching-processes.html"><a href="branching-processes.html#simulations-of-parents-having-children"><i class="fa fa-check"></i><b>8.3</b> Simulations of parents having children</a></li>
<li class="chapter" data-level="8.4" data-path="branching-processes.html"><a href="branching-processes.html#the-probability-generating-function-our-mathematical-tool"><i class="fa fa-check"></i><b>8.4</b> The Probability Generating Function: Our mathematical tool</a></li>
<li class="chapter" data-level="8.5" data-path="branching-processes.html"><a href="branching-processes.html#extinction"><i class="fa fa-check"></i><b>8.5</b> Extinction</a></li>
<li class="chapter" data-level="8.6" data-path="branching-processes.html"><a href="branching-processes.html#good-and-bad-set-ups-for-branching-process"><i class="fa fa-check"></i><b>8.6</b> Good and bad set-ups for branching process</a></li>
<li class="chapter" data-level="8.7" data-path="branching-processes.html"><a href="branching-processes.html#the-distribution-of-offspring-of-all-generations"><i class="fa fa-check"></i><b>8.7</b> The distribution of offspring of all generations</a></li>
<li class="chapter" data-level="8.8" data-path="branching-processes.html"><a href="branching-processes.html#geometric-offspring-distribution"><i class="fa fa-check"></i><b>8.8</b> Geometric offspring distribution</a><ul>
<li class="chapter" data-level="8.8.1" data-path="branching-processes.html"><a href="branching-processes.html#the-geometric-distributions-simple-pgf"><i class="fa fa-check"></i><b>8.8.1</b> The Geometric Distribution’s simple PGF</a></li>
<li class="chapter" data-level="8.8.2" data-path="branching-processes.html"><a href="branching-processes.html#a-plot-of-keyfitzs-numbers-for-generations-1-2-and-3.-is-it-exponential-for-k-0"><i class="fa fa-check"></i><b>8.8.2</b> A plot of Keyfitz’s numbers for generations 1, 2, and 3. Is it exponential for <span class="math inline">\(k &gt; 0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="branching-processes.html"><a href="branching-processes.html#branching-processes-and-covid-19"><i class="fa fa-check"></i><b>8.9</b> Branching Processes and Covid-19</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fisher-wright.html"><a href="fisher-wright.html"><i class="fa fa-check"></i><b>9</b> Fisher-Wright</a><ul>
<li class="chapter" data-level="9.1" data-path="fisher-wright.html"><a href="fisher-wright.html#outline-7"><i class="fa fa-check"></i><b>9.1</b> Outline</a></li>
<li class="chapter" data-level="9.2" data-path="fisher-wright.html"><a href="fisher-wright.html#parallel"><i class="fa fa-check"></i><b>9.2</b> Parallel</a><ul>
<li class="chapter" data-level="9.2.1" data-path="fisher-wright.html"><a href="fisher-wright.html#another-cell-phone-example"><i class="fa fa-check"></i><b>9.2.1</b> Another cell phone example</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="fisher-wright.html"><a href="fisher-wright.html#mutation"><i class="fa fa-check"></i><b>9.3</b> Mutation</a></li>
<li class="chapter" data-level="9.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fixation"><i class="fa fa-check"></i><b>9.4</b> Fixation</a><ul>
<li class="chapter" data-level="9.4.1" data-path="fisher-wright.html"><a href="fisher-wright.html#path-to-fixation-a-measure-of-homogeneityheterogeneity"><i class="fa fa-check"></i><b>9.4.1</b> Path to fixation: a measure of homogeneity/heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="fisher-wright.html"><a href="fisher-wright.html#baby-names"><i class="fa fa-check"></i><b>9.5</b> Baby Names</a><ul>
<li class="chapter" data-level="9.5.1" data-path="fisher-wright.html"><a href="fisher-wright.html#whats-the-basic-idea"><i class="fa fa-check"></i><b>9.5.1</b> What’s the basic idea?</a></li>
<li class="chapter" data-level="9.5.2" data-path="fisher-wright.html"><a href="fisher-wright.html#fisher-wright-simulation-of-baby-names-hahn-and-bentley"><i class="fa fa-check"></i><b>9.5.2</b> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</a></li>
<li class="chapter" data-level="9.5.3" data-path="fisher-wright.html"><a href="fisher-wright.html#drawing-their-picture-with-simulation"><i class="fa fa-check"></i><b>9.5.3</b> Drawing their picture with simulation</a></li>
<li class="chapter" data-level="9.5.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fw-babyname-simulation-of-equilibrium-frequencies"><i class="fa fa-check"></i><b>9.5.4</b> FW babyname simulation of equilibrium frequencies</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="fisher-wright.html"><a href="fisher-wright.html#now-we-can-simulate-babyynmes"><i class="fa fa-check"></i><b>9.6</b> Now we can simulate babyynmes</a></li>
<li class="chapter" data-level="9.7" data-path="fisher-wright.html"><a href="fisher-wright.html#conclusions-5"><i class="fa fa-check"></i><b>9.7</b> Conclusions</a><ul>
<li class="chapter" data-level="9.7.1" data-path="fisher-wright.html"><a href="fisher-wright.html#some-potential-criticism"><i class="fa fa-check"></i><b>9.7.1</b> Some potential criticism</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="coalescent.html"><a href="coalescent.html"><i class="fa fa-check"></i><b>10</b> Coalescent</a><ul>
<li class="chapter" data-level="10.1" data-path="coalescent.html"><a href="coalescent.html#outline-8"><i class="fa fa-check"></i><b>10.1</b> Outline</a></li>
<li class="chapter" data-level="10.2" data-path="coalescent.html"><a href="coalescent.html#big-picture-the-coalescent-expectations-of-the-past"><i class="fa fa-check"></i><b>10.2</b> Big picture: The Coalescent: Expectations of the Past</a></li>
<li class="chapter" data-level="10.3" data-path="coalescent.html"><a href="coalescent.html#our-first-question-when-was-mrca"><i class="fa fa-check"></i><b>10.3</b> Our first question: When was MRCA?</a></li>
<li class="chapter" data-level="10.4" data-path="coalescent.html"><a href="coalescent.html#mutation-and-inference-of-tmrca-and-n"><i class="fa fa-check"></i><b>10.4</b> Mutation and inference of TMRCA and <span class="math inline">\(N\)</span></a></li>
<li class="chapter" data-level="10.5" data-path="coalescent.html"><a href="coalescent.html#inference-of-population-size-simulation"><i class="fa fa-check"></i><b>10.5</b> Inference of population size, simulation</a></li>
<li class="chapter" data-level="10.6" data-path="coalescent.html"><a href="coalescent.html#conclusions-6"><i class="fa fa-check"></i><b>10.6</b> Conclusions</a></li>
<li class="chapter" data-level="10.7" data-path="coalescent.html"><a href="coalescent.html#an-application-of-coalescent-theory"><i class="fa fa-check"></i><b>10.7</b> An application of coalescent theory</a><ul>
<li class="chapter" data-level="10.7.1" data-path="coalescent.html"><a href="coalescent.html#coalesence-when-population-is-changing"><i class="fa fa-check"></i><b>10.7.1</b> Coalesence when population is changing</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="coalescent.html"><a href="coalescent.html#inference-from-mrca-times-n-2-comparisons-and-relative-branch-lengths"><i class="fa fa-check"></i><b>10.8</b> Inference from MRCA times: <span class="math inline">\(n &gt; 2\)</span> comparisons and relative branch lengths</a></li>
<li class="chapter" data-level="10.9" data-path="coalescent.html"><a href="coalescent.html#reconstruction-ancient-european-population-sizes-using-batinis-sample-of-mitochondrial-dna"><i class="fa fa-check"></i><b>10.9</b> Reconstruction Ancient European Population Sizes using Batini’s sample of Mitochondrial DNA&quot;</a><ul>
<li class="chapter" data-level="10.9.1" data-path="coalescent.html"><a href="coalescent.html#summary-of-batini-et-al."><i class="fa fa-check"></i><b>10.9.1</b> Summary of Batini et al.</a></li>
<li class="chapter" data-level="10.9.2" data-path="coalescent.html"><a href="coalescent.html#ancient-population-estimates"><i class="fa fa-check"></i><b>10.9.2</b> Ancient population estimates</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="coalescent.html"><a href="coalescent.html#some-exercises"><i class="fa fa-check"></i><b>10.10</b> Some exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="student-presentations.html"><a href="student-presentations.html"><i class="fa fa-check"></i><b>11</b> Student Presentations</a><ul>
<li class="chapter" data-level="11.1" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers"><i class="fa fa-check"></i><b>11.1</b> Mortality Crossovers</a><ul>
<li class="chapter" data-level="11.1.1" data-path="student-presentations.html"><a href="student-presentations.html#outline-9"><i class="fa fa-check"></i><b>11.1.1</b> Outline</a></li>
<li class="chapter" data-level="11.1.2" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers-reality-or-bad-data-coale1986mortality"><i class="fa fa-check"></i><b>11.1.2</b> <em>Mortality Crossovers: Reality or Bad Data?</em> <span class="citation">(Coale and Kisker <span>1986</span>)</span></a></li>
<li class="chapter" data-level="11.1.3" data-path="student-presentations.html"><a href="student-presentations.html#methods-for-evaluating-the-heterogeneity-of-aging-processes-in-human-populations-using-vital-statistics-data-explaining-the-blackwhite-mortality-crossover-by-a-model-of-mortality-selection-manton1981methods"><i class="fa fa-check"></i><b>11.1.3</b> <em>Methods for Evaluating the Heterogeneity of Aging Processes in Human Populations Using Vital Statistics Data: Explaining the Black/White Mortality Crossover by a Model of Mortality Selection</em> <span class="citation">(Manton and Stallard <span>1981</span>)</span></a></li>
<li class="chapter" data-level="11.1.4" data-path="student-presentations.html"><a href="student-presentations.html#censoc-mortality-crossovers"><i class="fa fa-check"></i><b>11.1.4</b> CenSoc Mortality Crossovers</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="student-presentations.html"><a href="student-presentations.html#plateaus"><i class="fa fa-check"></i><b>11.2</b> Plateaus</a></li>
<li class="chapter" data-level="11.3" data-path="student-presentations.html"><a href="student-presentations.html#rising-inequality"><i class="fa fa-check"></i><b>11.3</b> Rising Inequality</a><ul>
<li class="chapter" data-level="11.3.1" data-path="student-presentations.html"><a href="student-presentations.html#trends-in-mortality-differentials-and-life-expectancy-for-male-social-security-covered-workers-by-socioeconomic-status-waldron2007trends"><i class="fa fa-check"></i><b>11.3.1</b> <em>Trends in mortality differentials and life expectancy for male social security-covered workers, by socioeconomic status</em> <span class="citation">(Waldron <span>2007</span>)</span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematical Demography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tempo" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Tempo</h1>
<div id="outline-5" class="section level2">
<h2><span class="header-section-number">7.1</span> Outline</h2>
<ul>
<li>Introduction and a tempo simulation</li>
<li>Bongaarts and Feeney’s formula</li>
<li>An application to the United States</li>
<li>Two Americas?</li>
<li>EM algorithm for unmixing mixtures</li>
<li>An application to two Americas.</li>
</ul>
<p>Additional resources:</p>
<ul>
<li><span class="citation">Sullivan (<a href="#ref-sullivan2005age">2005</a>)</span>: An early paper (by a Berkeley Demog student!) focusing on ﬁrst birth hazards.</li>
<li><span class="citation">Burkimsher (<a href="#ref-burkimsher2017evolution">2017</a>)</span>: A descriptive paper, which you can mostly skip. But see especially section 7, where she argues that her ﬁndings contradict Sullivan for the United States.</li>
<li><span class="citation">Hastie, Tibshirani, and Friedman (<a href="#ref-hastie2009elements">2009</a>)</span>: A textbook example of expectation-maximization algorithm applied to mixture of two normals in Section 8.5.</li>
<li>Victor Lavrenko. Youtube video : “EM algorithm: how it works” <a href="https://www.youtube.com/watch?v=REypj2sy_5U" class="uri">https://www.youtube.com/watch?v=REypj2sy_5U</a>.</li>
<li><span class="citation">Bongaarts and Feeney (<a href="#ref-bongaarts1998quantum">1998</a>)</span></li>
</ul>
</div>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Introduction</h2>
<p>What we see is superficial. Heterogeneous models reveal what’s “really” going on. (Or do they?). Until the past sections, population hazards mislead. However in this section, homogeneous fertility misleads.</p>
<p>We now reverse perspectives:</p>
<ul>
<li>We see differences we see in genotypes, in lineages, in names.</li>
<li>These could be due to “real” differences (heterogeneity).</li>
<li>But they could also be due to luck: everyone is the same but stochastic outcomes differ.</li>
<li>Our models of individual-level randomness will have predicted dynamics, which are themselves interesting but can also be used as a “null” to compare to observations.</li>
</ul>
<div id="fertility-postponement-a-very-simple-example" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Fertility postponement, a very simple example</h3>
<p>Baseline</p>
<ul>
<li>A population has a history of 1 birth per day</li>
<li>When women turn age 25, they have a daughter.</li>
<li>This gives us a constant stream of births, 365 per year.</li>
</ul>
<p>Postponement</p>
<ul>
<li>Starting on Jan. 1, 2020, everyone postpones childbearing an additional month, until they are aged 25 1/12.</li>
<li>How many births will there be in 2020?</li>
<li>How many births in 2021?</li>
</ul>
<p>As everybody postpones childbearing for a month, then the first birth of 2020 occurs on February 1st so that 31 babies have not been born by then. This means that during 2020 there are <span class="math inline">\(365-31=334\)</span> births. For this year, births and total fertility rate decrease. However, the postponement doesn’t affect the birth stream in 2021 as there will still be one birth per day, even if in the absence of postponing these some of the births should’ve occured in 2020.</p>
</div>
<div id="continuous-postponement-a-shiny-simulation" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Continuous postponement, a shiny simulation</h3>
<p>To answer these questions, we can use the following shiny app.
<iframe src="https://shiny.demog.berkeley.edu/josh/tempo/" width="672" height="600px"></iframe></p>
<ul>
<li><p><span class="math inline">\(R(t)\)</span> Cumulative postponment</p></li>
<li><p><span class="math inline">\(r(t)\)</span> Incremental postponement <span class="math inline">\(r(t) = R&#39;(t)\)</span></p>
<p>What is a formula for recovering original birth stream?
<span class="math display">\[\begin{align}
\hat{B}_{orig} &amp;= B_{obs} \times (1 + R&#39;(t)) \\
 \text{or}\\
\hat{B}_{orig} &amp;= B_{obs} \times 1/  \left[1 - R&#39;(t)\right]?
\end{align}\]</span></p>
<p>Note: this idea of ``recovering original’’ is one way to think
about tempo adjustment.</p>
<p>We can think of the original version as that which should have ocurred in the absence of postponement. Intuitively, it should be higher than the observed birth stream, but how much larger? The table below shows an example of how to recover the original births where each formula refers to the equations above.</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">r(t)</th>
<th align="right">B(obs)</th>
<th align="right">B(orig) formula 1</th>
<th align="right">B(orig) formula 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">91</td>
<td align="right">100.1</td>
<td align="right">101.1111</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">84</td>
<td align="right">100.8</td>
<td align="right">105.0000</td>
</tr>
<tr class="odd">
<td align="right">0.3</td>
<td align="right">77</td>
<td align="right">100.1</td>
<td align="right">110.0000</td>
</tr>
<tr class="even">
<td align="right">0.4</td>
<td align="right">72</td>
<td align="right">100.8</td>
<td align="right">120.0000</td>
</tr>
</tbody>
</table>
<p>The correct formula is equation 2. <strong>NOTE: is this correct? If so, why?</strong></p>
</div>
</div>
<div id="period-shifts-bongaarts-and-feeneys-model" class="section level2">
<h2><span class="header-section-number">7.3</span> Period Shifts: Bongaarts and Feeney’s model</h2>
<p>In a bigger microsimulation</p>
<ul>
<li>Each period will have births across a range of ages</li>
<li>We’ll randomly generate the original planned birthdays</li>
<li>Then we’ll shift by a continuous function <span class="math inline">\(R(t)\)</span>.</li>
</ul>
<p>The birth rate of women, <span class="math inline">\(f(a,t)\)</span>, aged <span class="math inline">\(a\)</span> in period <span class="math inline">\(t\)</span> is:
<span class="math display">\[
  f(a,t) = f_0(a - R(t)) (1- R&#39;(t)) q(t)
  \]</span></p>
<p>Where</p>
<ul>
<li><span class="math inline">\(f_0\)</span>: constant baseline schedule (can be normalized to sum to 1).</li>
<li><span class="math inline">\(q(t)\)</span>: period intensity parameter: “quantum”</li>
<li><span class="math inline">\(R(t)\)</span>: cumulative shift.</li>
</ul>
<p>An example</p>
<p><span class="math display">\[
f(a,t) = f_0(a - R(t)) (1- R&#39;(t)) q(t)
\]</span></p>
<ul>
<li><span class="math inline">\(R_{2019} = 3\)</span></li>
<li><span class="math inline">\(R&#39;_{2019} = .1\)</span></li>
<li><span class="math inline">\(q(2019) = 1\)</span></li>
</ul>
<p>Give an expression for <span class="math inline">\(f(28,2019)\)</span>.</p>
<p><span class="math display">\[ \begin{aligned} 
 f(28,2019) &amp;= f_{0}(28-3)\times(1-0.1)\times(1) \\
  &amp; = (0.9)f_{0}(25)
 \end{aligned}
\]</span> Therefore, the fertility rate for a 28 year-old in 2019 would be 0.9 of the baseline fertility rate at age 25. Another way of thinking about it is that had there been no postponement, the fertility rate that we are observing in 2019 for this 28 year-old would actually be similar to that of a 25 year old.</p>
<p>Small changes in the stock can have huge effect in the flows.</p>
<div id="a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here" class="section level3">
<h3><span class="header-section-number">7.3.1</span> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></h3>
<p>Assume no quantum effects (i.e, no <span class="math inline">\(q(t)\)</span>). Take a cohort with cumulative fertility</p>
<p><span class="math display">\[
  F_0(a) = \int_0^a f(x) \,dx
  \]</span></p>
<p>Now put in shifts so that observed fertility is from an age <span class="math inline">\(R(t)\)</span> years earlier. (“28” is the new “25”!)
<span class="math display">\[
  F(a,t) = F_0(a - R(t))  = F_0(a - R(c + a))
  \]</span></p>
<p>Differentiate with respect to age (which for a cohort is also time <span class="math inline">\(t\)</span>), using chain rule</p>
<p><span class="math display">\[ \begin{aligned}
  \frac{d }{dt}F(a,t)= f(a,t) &amp;= F&#39;_{0}(a-R(c+a))\times(1-R&#39;(c+a)) \\
  &amp;= f_0(a - R(t)) \left[1 - R&#39;(t)\right]
  \end{aligned}\]</span></p>
<p>Let’s re-notate our constant quantum result
<span class="math display">\[
  f_0(a,t | R(t) ) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]
  \]</span>
Then we can incorporate period quantum on the shifted surface:
<span class="math display">\[
  f(a,t) = f_0(a,t | R(t) ) q(t) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t)
  \]</span></p>
<p>Note: If we vary quantum before shifts, then <span class="math inline">\(q(t)\)</span> will bleed into neighboring years. (a small effect, but makes model
messier). <strong>NOTE: I don’t understand this, could you explain Josh?</strong></p>
<p><strong>Tempo-adjusted TFR:</strong> counter-factual, TFR in absence of timing changes</p>
<p><span class="math display">\[
  TFR(t) = \int_0^\infty f(a,t) \, da
  \]</span></p>
<p>Substituting our shifted birth rates with quantum
<span class="math display">\[
  \begin{aligned}
  TFR(t) &amp;= \int_0^\infty f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t) da \\
  &amp;=\left[1 - R&#39;(t)\right]q(t) \int_0^\infty f_0(a - R(t))  da \\
  &amp;= TFR_0 \left[1 - R&#39;(t)\right] q(t)\\
  \end{aligned}
  \]</span>
Without loss of generality, define <span class="math inline">\(TFR_0 = 1\)</span>, then</p>
<p><span class="math display">\[
  q(t) =   \frac{TFR(t)} {1 - R&#39;(t)} \equiv TFR^*(t) 
  \]</span>
The observed <span class="math inline">\(TFR(t)\)</span> deflated by the rate of change (<span class="math inline">\(1 - R&#39;(t)\)</span>) is the BF formula.</p>
<p>How do period schedules change?</p>
<p><span class="math display">\[
  f(a,t) = f_0(a - R(t)) \left[1 - R&#39;(t)\right]q(t)
  \]</span></p>
<p>What is
<span class="math display">\[
  \begin{aligned}
  {\partial \over \partial t} \log f(a,t) &amp;= ?\\
  \\
  &amp; = \frac{d}{dt}log(f_{0}(a-R(t))) + \frac{d}{dt}log(1-R&#39;(t)) + \frac{d}{dt}log(q(t)) \\
  &amp; = \frac{-f&#39;_{0}(a-R(t)) R&#39;(t)}{f_{0}(a-R(t))} - \frac{R&#39;&#39;(t)}{1-R&#39;(t)}+ \frac{q&#39;(t)}{q(t)}
  \end{aligned}
  \]</span>
If we sketch this, where the age is on the x-axis, then the last two components affect the intercept of the curve. If births are postponed, <span class="math inline">\(R&#39;(t)&gt;0\)</span> but if they are actually advanced then <span class="math inline">\(R&#39;(t)&lt;0\)</span>, which affects the slope of $ {t} f(a,t)$.</p>
<p><strong>Uniform shifts</strong></p>
<ul>
<li>BF model assumes all ages shift by <span class="math inline">\(R(t)\)</span>.</li>
<li>BF model assumes all ages rise or fall by same quantum <span class="math inline">\(q(t)\)</span></li>
<li>Violating these assumptions means change in mean age will not just reflect “tempo”.</li>
<li>Example: What happens if people have fewer higher order births?</li>
</ul>
<p><strong>BF recommendation for achieving uniformity</strong></p>
<p>Separate estimates for each birth order, and then combine:
<span class="math display">\[
  TFR^*(t) = \sum_i TFR_i^*(t) = \sum_i {TFR_i(t) \over 1 - r_i(t)}
  \]</span></p>
<p>This will protect against order-specific quantum effects.</p>
</div>
</div>
<div id="an-application-to-the-united-states" class="section level2">
<h2><span class="header-section-number">7.4</span> An Application to the United States</h2>
<p>Tempo adjustment of US fertility using HFD data using Bongaarts-Feeney formula:</p>
<ol style="list-style-type: decimal">
<li>Read in data and format into an array.
Below we show the period fertility rates for all parities at each age for 1933 and 1934 of US women.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb61-3" data-line-number="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb61-4" data-line-number="4"></a>
<a class="sourceLine" id="cb61-5" data-line-number="5"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_functions.R&quot;</span>)</a>
<a class="sourceLine" id="cb61-6" data-line-number="6"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/utility_functions.R&quot;</span>)</a>
<a class="sourceLine" id="cb61-7" data-line-number="7"></a>
<a class="sourceLine" id="cb61-8" data-line-number="8"><span class="co">## age specific fertility rates by birth order for all countries and times</span></a>
<a class="sourceLine" id="cb61-9" data-line-number="9"><span class="co">## RR means &quot;rectangles&quot; on Lexis surface</span></a>
<a class="sourceLine" id="cb61-10" data-line-number="10">dt &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/data/zip_w/asfrRRbo.txt&quot;</span>, <span class="dt">showProgress =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb61-11" data-line-number="11"></a>
<a class="sourceLine" id="cb61-12" data-line-number="12">dt &lt;-<span class="st"> </span>dt[Code <span class="op">==</span><span class="st"> &quot;USA&quot;</span>] <span class="co">## keep only US</span></a>
<a class="sourceLine" id="cb61-13" data-line-number="13">dt &lt;-<span class="st"> </span>dt[Age <span class="op">%in%</span><span class="st"> </span><span class="dv">15</span><span class="op">:</span><span class="dv">49</span>] <span class="co">## keep only ages 15 to 49</span></a>
<a class="sourceLine" id="cb61-14" data-line-number="14"></a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="co">## put all order fertility into a matrix</span></a>
<a class="sourceLine" id="cb61-16" data-line-number="16">fat &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)] <span class="co"># age (rows) by cohort year (column) matrix of ASFR</span></a>
<a class="sourceLine" id="cb61-17" data-line-number="17">fat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">unclass</span>(fat)) </a>
<a class="sourceLine" id="cb61-18" data-line-number="18">fat1 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR1 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)] <span class="co">#age specific fertility rates for parity = 1 </span></a>
<a class="sourceLine" id="cb61-19" data-line-number="19">fat2 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR2 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</a>
<a class="sourceLine" id="cb61-20" data-line-number="20">fat3 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR3 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</a>
<a class="sourceLine" id="cb61-21" data-line-number="21">fat4 &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR4 <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</a>
<a class="sourceLine" id="cb61-22" data-line-number="22">fat5p &lt;-<span class="st"> </span>dt[, <span class="kw">xtabs</span>(ASFR5p <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Year)]</a>
<a class="sourceLine" id="cb61-23" data-line-number="23">year.vec &lt;-<span class="st"> </span><span class="kw">colnames</span>(fat)</a>
<a class="sourceLine" id="cb61-24" data-line-number="24">age.vec &lt;-<span class="st"> </span><span class="kw">rownames</span>(fat)</a>
<a class="sourceLine" id="cb61-25" data-line-number="25">parity.vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;all&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb61-26" data-line-number="26">fat.array &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="kw">nrow</span>(fat), <span class="kw">ncol</span>(fat), <span class="kw">length</span>(parity.vec)))</a>
<a class="sourceLine" id="cb61-27" data-line-number="27"><span class="kw">dimnames</span>(fat.array) &lt;-<span class="st"> </span><span class="kw">list</span>(age.vec, year.vec, parity.vec)</a>
<a class="sourceLine" id="cb61-28" data-line-number="28">fat.array[,,<span class="st">&quot;all&quot;</span>] &lt;-<span class="st"> </span>fat</a>
<a class="sourceLine" id="cb61-29" data-line-number="29">fat.array[,,<span class="st">&quot;1&quot;</span>] &lt;-<span class="st"> </span>fat1</a>
<a class="sourceLine" id="cb61-30" data-line-number="30">fat.array[,,<span class="st">&quot;2&quot;</span>] &lt;-<span class="st"> </span>fat2</a>
<a class="sourceLine" id="cb61-31" data-line-number="31">fat.array[,,<span class="st">&quot;3&quot;</span>] &lt;-<span class="st"> </span>fat3</a>
<a class="sourceLine" id="cb61-32" data-line-number="32">fat.array[,,<span class="st">&quot;4&quot;</span>] &lt;-<span class="st"> </span>fat4</a>
<a class="sourceLine" id="cb61-33" data-line-number="33">fat.array[,,<span class="st">&quot;5&quot;</span>] &lt;-<span class="st"> </span>fat5p</a>
<a class="sourceLine" id="cb61-34" data-line-number="34"></a>
<a class="sourceLine" id="cb61-35" data-line-number="35"><span class="kw">kable</span>(fat.array[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="st">&quot;all&quot;</span>], <span class="dt">caption=</span><span class="st">&quot;An extract of period age-specific fertility rates&quot;</span>) </a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-63">Table 7.1: </span>An extract of period age-specific fertility rates</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">1933</th>
<th align="right">1934</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>15</td>
<td align="right">0.00672</td>
<td align="right">0.00715</td>
</tr>
<tr class="even">
<td>16</td>
<td align="right">0.01875</td>
<td align="right">0.01991</td>
</tr>
<tr class="odd">
<td>17</td>
<td align="right">0.03846</td>
<td align="right">0.04062</td>
</tr>
<tr class="even">
<td>18</td>
<td align="right">0.06586</td>
<td align="right">0.06957</td>
</tr>
<tr class="odd">
<td>19</td>
<td align="right">0.08719</td>
<td align="right">0.09155</td>
</tr>
<tr class="even">
<td>20</td>
<td align="right">0.10136</td>
<td align="right">0.10749</td>
</tr>
<tr class="odd">
<td>21</td>
<td align="right">0.10639</td>
<td align="right">0.11296</td>
</tr>
<tr class="even">
<td>22</td>
<td align="right">0.11349</td>
<td align="right">0.11807</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="right">0.11785</td>
<td align="right">0.12034</td>
</tr>
<tr class="even">
<td>24</td>
<td align="right">0.11476</td>
<td align="right">0.12208</td>
</tr>
<tr class="odd">
<td>25</td>
<td align="right">0.11388</td>
<td align="right">0.11536</td>
</tr>
<tr class="even">
<td>26</td>
<td align="right">0.10873</td>
<td align="right">0.11399</td>
</tr>
<tr class="odd">
<td>27</td>
<td align="right">0.10118</td>
<td align="right">0.10487</td>
</tr>
<tr class="even">
<td>28</td>
<td align="right">0.10283</td>
<td align="right">0.10554</td>
</tr>
<tr class="odd">
<td>29</td>
<td align="right">0.09094</td>
<td align="right">0.09483</td>
</tr>
<tr class="even">
<td>30</td>
<td align="right">0.09009</td>
<td align="right">0.09330</td>
</tr>
<tr class="odd">
<td>31</td>
<td align="right">0.06941</td>
<td align="right">0.07239</td>
</tr>
<tr class="even">
<td>32</td>
<td align="right">0.07813</td>
<td align="right">0.07541</td>
</tr>
<tr class="odd">
<td>33</td>
<td align="right">0.07614</td>
<td align="right">0.06993</td>
</tr>
<tr class="even">
<td>34</td>
<td align="right">0.06013</td>
<td align="right">0.07248</td>
</tr>
<tr class="odd">
<td>35</td>
<td align="right">0.06009</td>
<td align="right">0.05676</td>
</tr>
<tr class="even">
<td>36</td>
<td align="right">0.05416</td>
<td align="right">0.05401</td>
</tr>
<tr class="odd">
<td>37</td>
<td align="right">0.04748</td>
<td align="right">0.04670</td>
</tr>
<tr class="even">
<td>38</td>
<td align="right">0.04755</td>
<td align="right">0.04769</td>
</tr>
<tr class="odd">
<td>39</td>
<td align="right">0.03724</td>
<td align="right">0.03752</td>
</tr>
<tr class="even">
<td>40</td>
<td align="right">0.03078</td>
<td align="right">0.03024</td>
</tr>
<tr class="odd">
<td>41</td>
<td align="right">0.01967</td>
<td align="right">0.01963</td>
</tr>
<tr class="even">
<td>42</td>
<td align="right">0.01877</td>
<td align="right">0.01874</td>
</tr>
<tr class="odd">
<td>43</td>
<td align="right">0.01283</td>
<td align="right">0.01235</td>
</tr>
<tr class="even">
<td>44</td>
<td align="right">0.00808</td>
<td align="right">0.00789</td>
</tr>
<tr class="odd">
<td>45</td>
<td align="right">0.00526</td>
<td align="right">0.00491</td>
</tr>
<tr class="even">
<td>46</td>
<td align="right">0.00245</td>
<td align="right">0.00242</td>
</tr>
<tr class="odd">
<td>47</td>
<td align="right">0.00127</td>
<td align="right">0.00122</td>
</tr>
<tr class="even">
<td>48</td>
<td align="right">0.00081</td>
<td align="right">0.00087</td>
</tr>
<tr class="odd">
<td>49</td>
<td align="right">0.00037</td>
<td align="right">0.00037</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li>Fit bongaarts feeney without birth order</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">tfr.vec &lt;-<span class="st"> </span><span class="kw">colSums</span>(fat)          <span class="co"># total fertility rate for each cohort</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2">mu.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(fat, <span class="dv">2</span>, get.mean) <span class="co"># mean age at childbearing</span></a>
<a class="sourceLine" id="cb62-3" data-line-number="3">rt.vec &lt;-<span class="st"> </span><span class="kw">center.diff</span>(mu.vec)     <span class="co"># increments of postponement</span></a>
<a class="sourceLine" id="cb62-4" data-line-number="4">adj.tfr.vec &lt;-<span class="st"> </span>tfr.vec <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rt.vec) <span class="co"># Assuming no quantum effect, tempo-adjusted TFR</span></a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-65"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-65-1.png" alt="Adjusted TFR" width="672" />
<p class="caption">
Figure 7.1: Adjusted TFR
</p>
</div>
<ul>
<li>We see fertility since 1980 has been depressed by postponment</li>
<li>We see weird dynamics around end of WW2 and great recession.</li>
<li>What’s going on? Here is a closeup</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-66"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-66-1.png" alt="Observed and tempo-adjusted TFRs" width="672" />
<p class="caption">
Figure 7.2: Observed and tempo-adjusted TFRs
</p>
</div>
Now let’s look at turbulence around WWII
<div class="figure"><span id="fig:unnamed-chunk-67"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-67-1.png" alt="Change in fertility rates around WWII" width="672" />
<p class="caption">
Figure 7.3: Change in fertility rates around WWII
</p>
</div>
<p>From 1945 to 1946, fertility goes up a lot, but more at younger ages. So mean goes down. BF adjustment over-compensates, and has quantum declining.</p>
<p>What’s happening from 1944-45?</p>
<ol start="3" style="list-style-type: decimal">
<li>Fit bongaarts feeney with birth order</li>
</ol>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">out &lt;-<span class="st"> </span><span class="kw">bf.fit</span>(fat.array)  <span class="co">#function to obtain BF tempo-adjusted TFR</span></a>
<a class="sourceLine" id="cb63-2" data-line-number="2">adj.tfr.bo.vec &lt;-<span class="st">  </span>out<span class="op">$</span>tfr.star.out[, <span class="st">&quot;bf.tfr.star&quot;</span>] <span class="co"># sum of parity specific tempo-adjusted TFRs</span></a></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-69"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-69-1.png" alt="TFR by parities" width="672" />
<p class="caption">
Figure 7.4: TFR by parities
</p>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Use HFD data to verify adjusted TFR
HFD uses a tempo-adjusted TFR that is the sum of the parity specific adjusted BF TFR.</li>
</ol>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="co">## let&#39;s check against hfd</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2">hfd.adj.dt &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/data/zip_w/adjtfrRR.txt&quot;</span>, <span class="dt">showProgress =</span> <span class="ot">FALSE</span>, <span class="dt">skip =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">hfd.adj.dt &lt;-<span class="st"> </span>hfd.adj.dt[Code <span class="op">==</span><span class="st"> &quot;USA&quot;</span>]</a></code></pre></div>
<p>We find that:</p>
<ul>
<li>Taking birth order into account smooths out WW2 turbulence (large fluctuations) but increases the variation during the Great Recession.<br />
</li>
<li>The baby boom appears to initially be even greater than observed when we take into account birth order, but then it fall more than observed.</li>
<li>Finally, the baby bust was not as bad as it seemed.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-71"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-71-1.png" alt="TFR by parities using HFD data" width="672" />
<p class="caption">
Figure 7.5: TFR by parities using HFD data
</p>
</div>
<div id="conclusions-3" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Conclusions</h3>
<ul>
<li>Baby boom smaller if we account for “pre-ponement”.<br />
</li>
<li>Fertility lull in 1970s and 80s disappears if we account for
“postponement”.</li>
<li>Birth order disaggregation improves estimates of shifts from
changes in mean age</li>
<li>What happened with the recession?</li>
</ul>
</div>
</div>
<div id="two-americas" class="section level2">
<h2><span class="header-section-number">7.5</span> Two Americas</h2>
<p>Let’s look at births (all orders). Here we have some animations of the ASFR over time.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">my.year.vec &lt;-<span class="st"> </span><span class="dv">1975</span><span class="op">:</span><span class="dv">2017</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="co"># library(devtools)</span></a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="co"># install_github(&quot;dgrtwo/gganimate&quot;)</span></a>
<a class="sourceLine" id="cb65-4" data-line-number="4"><span class="co"># install.packages(&quot;transformr&quot;)</span></a>
<a class="sourceLine" id="cb65-5" data-line-number="5"><span class="co"># install.packages(&quot;animation&quot;)</span></a>
<a class="sourceLine" id="cb65-6" data-line-number="6"><span class="kw">library</span>(gganimate)</a>
<a class="sourceLine" id="cb65-7" data-line-number="7"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="kw">library</span>(mixtools)</a>
<a class="sourceLine" id="cb65-9" data-line-number="9"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb65-10" data-line-number="10"></a>
<a class="sourceLine" id="cb65-11" data-line-number="11"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_mixed_functions.R&quot;</span>)</a>
<a class="sourceLine" id="cb65-12" data-line-number="12"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/josh-goldstein-git/random_demography/master/bookdown-master/codes/tempo_functions.R&quot;</span>)</a>
<a class="sourceLine" id="cb65-13" data-line-number="13"></a>
<a class="sourceLine" id="cb65-14" data-line-number="14"><span class="co"># plot1 &lt;- ggplot(data=dt[Year %in% my.year.vec,2:4], aes(x=Age, y= ASFR)) + </span></a>
<a class="sourceLine" id="cb65-15" data-line-number="15"><span class="co">#   geom_line(aes(group=Year))+</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16"><span class="co">#   transition_time(Year)+</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17"><span class="co">#   labs(title = &quot;Year: {frame_time}&quot;)</span></a>
<a class="sourceLine" id="cb65-18" data-line-number="18"></a>
<a class="sourceLine" id="cb65-19" data-line-number="19"><span class="co"># anim_save(&quot;plot1.gif&quot;, plot1)</span></a></code></pre></div>
<p><img src="plot1.gif" /></p>
<p>During the earlier years, the mean childbearing age seems to be in the early 20s. However with time, the AFR seems to become bimodal. So what is happening here? Are there two underlying groups of women that experience different fertility rates. Now fit mixing model and redo the animation.</p>
<p><strong>NOTE: Not sure of all the lines in this mixture code. Josh, could you add some notes please?</strong></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="co">## takes few minutes to run</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2">my.fat &lt;-<span class="st"> </span>fat[, <span class="kw">paste</span>(my.year.vec)]</a>
<a class="sourceLine" id="cb66-3" data-line-number="3">out &lt;-<span class="st"> </span><span class="kw">get.mixed.tfr.star</span>(my.fat)</a>
<a class="sourceLine" id="cb66-4" data-line-number="4"><span class="co">##</span></a>
<a class="sourceLine" id="cb66-5" data-line-number="5">out.all &lt;-<span class="st"> </span>out</a>
<a class="sourceLine" id="cb66-6" data-line-number="6"></a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="co">#Mixture simulation </span></a>
<a class="sourceLine" id="cb66-8" data-line-number="8"><span class="cf">if</span> (<span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb66-9" data-line-number="9">mu.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>mu.mat</a>
<a class="sourceLine" id="cb66-10" data-line-number="10">lambda.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>lambda.mat</a>
<a class="sourceLine" id="cb66-11" data-line-number="11">sigma.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list.variable.sigma)<span class="op">$</span>sigma.mat</a>
<a class="sourceLine" id="cb66-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb66-13" data-line-number="13">mu.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>mu.mat</a>
<a class="sourceLine" id="cb66-14" data-line-number="14">lambda.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>lambda.mat</a>
<a class="sourceLine" id="cb66-15" data-line-number="15">sigma.mat &lt;-<span class="st"> </span><span class="kw">get.coefs.mixed</span>(out.all<span class="op">$</span>fert.fit.list)<span class="op">$</span>sigma.ma</a>
<a class="sourceLine" id="cb66-16" data-line-number="16"></a>
<a class="sourceLine" id="cb66-17" data-line-number="17"><span class="co">#Temporary comment out until we figure out what these graphs actually are</span></a>
<a class="sourceLine" id="cb66-18" data-line-number="18"><span class="co"># matplot(my.year.vec, t(mu.mat))</span></a>
<a class="sourceLine" id="cb66-19" data-line-number="19"><span class="co"># abline(v = 2015)## problem here</span></a>
<a class="sourceLine" id="cb66-20" data-line-number="20"><span class="co"># points(c(2015, 2015), c(21.5, 30.3))</span></a>
<a class="sourceLine" id="cb66-21" data-line-number="21"><span class="co"># </span></a>
<a class="sourceLine" id="cb66-22" data-line-number="22"><span class="co"># matplot(my.year.vec, t(lambda.mat))</span></a>
<a class="sourceLine" id="cb66-23" data-line-number="23"><span class="co"># abline(v = 2015)## problem here</span></a>
<a class="sourceLine" id="cb66-24" data-line-number="24"><span class="co"># points(c(2015, 2015), c(21.5, 30.3))</span></a>
<a class="sourceLine" id="cb66-25" data-line-number="25"></a>
<a class="sourceLine" id="cb66-26" data-line-number="26"><span class="co">## interpolate 1915</span></a>
<a class="sourceLine" id="cb66-27" data-line-number="27"></a>
<a class="sourceLine" id="cb66-28" data-line-number="28"><span class="kw">colnames</span>(lambda.mat) &lt;-<span class="st"> </span>my.year.vec</a>
<a class="sourceLine" id="cb66-29" data-line-number="29"><span class="kw">colnames</span>(mu.mat) &lt;-<span class="st"> </span>my.year.vec</a>
<a class="sourceLine" id="cb66-30" data-line-number="30">lambda.mat[,<span class="st">&quot;2015&quot;</span>] &lt;-<span class="st"> </span>(lambda.mat[,<span class="st">&quot;2014&quot;</span>] <span class="op">+</span><span class="st"> </span>lambda.mat[,<span class="st">&quot;2016&quot;</span>])<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb66-31" data-line-number="31">mu.mat[,<span class="st">&quot;2015&quot;</span>]     &lt;-<span class="st"> </span>(mu.mat[,<span class="st">&quot;2014&quot;</span>]     <span class="op">+</span><span class="st"> </span>mu.mat[,<span class="st">&quot;2016&quot;</span>])<span class="op">/</span><span class="dv">2</span></a></code></pre></div>
<p>Now we create the animation with the normal distributions inside as well as the observed ASFR.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co"># Obtaining different ASFRs per group (1 and 2)</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2">my.dt &lt;-<span class="st"> </span>dt[Year <span class="op">%in%</span><span class="st"> </span>my.year.vec,]</a>
<a class="sourceLine" id="cb67-3" data-line-number="3"></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(my.year.vec)){</a>
<a class="sourceLine" id="cb67-5" data-line-number="5">    my.year &lt;-<span class="st"> </span>my.year.vec[i]</a>
<a class="sourceLine" id="cb67-6" data-line-number="6">    year.vec &lt;-<span class="st"> </span><span class="kw">colnames</span>(my.fat)</a>
<a class="sourceLine" id="cb67-7" data-line-number="7">    fx &lt;-<span class="st"> </span>my.fat[,<span class="kw">paste</span>(my.year)]</a>
<a class="sourceLine" id="cb67-8" data-line-number="8">    <span class="co"># fx &lt;- fx/sum(fx)</span></a>
<a class="sourceLine" id="cb67-9" data-line-number="9">    x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">names</span>(fx))</a>
<a class="sourceLine" id="cb67-10" data-line-number="10">    <span class="co">## par(mfrow = c(1,1))</span></a>
<a class="sourceLine" id="cb67-11" data-line-number="11">    <span class="co"># plot(x, fx,</span></a>
<a class="sourceLine" id="cb67-12" data-line-number="12">    <span class="co">#      ylim = c(0, .3),</span></a>
<a class="sourceLine" id="cb67-13" data-line-number="13">    <span class="co">#      ylab = &quot;normalized fx&quot;)</span></a>
<a class="sourceLine" id="cb67-14" data-line-number="14">    s &lt;-<span class="st"> </span>year.vec <span class="op">==</span><span class="st"> </span>my.year</a>
<a class="sourceLine" id="cb67-15" data-line-number="15">    this.tfr &lt;-<span class="st"> </span><span class="kw">sum</span>(fx)</a>
<a class="sourceLine" id="cb67-16" data-line-number="16">    fx1.hat &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mu.mat[<span class="dv">1</span>,s], <span class="dt">sd =</span> sigma.mat[<span class="dv">1</span>,s]) <span class="op">*</span></a>
<a class="sourceLine" id="cb67-17" data-line-number="17"><span class="st">        </span>lambda.mat[<span class="dv">1</span>,s]<span class="op">*</span><span class="st"> </span>this.tfr</a>
<a class="sourceLine" id="cb67-18" data-line-number="18">    <span class="co"># lines(x, fx1.hat, col = &quot;red&quot;)</span></a>
<a class="sourceLine" id="cb67-19" data-line-number="19">    fx2.hat &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mu.mat[<span class="dv">2</span>,s], <span class="dt">sd =</span> sigma.mat[<span class="dv">2</span>,s]) <span class="op">*</span></a>
<a class="sourceLine" id="cb67-20" data-line-number="20"><span class="st">        </span>lambda.mat[<span class="dv">2</span>,s] <span class="op">*</span><span class="st"> </span>this.tfr</a>
<a class="sourceLine" id="cb67-21" data-line-number="21">    <span class="co"># lines(x, fx2.hat, col = &quot;blue&quot;)</span></a>
<a class="sourceLine" id="cb67-22" data-line-number="22">    <span class="co"># lines(x, fx1.hat + fx2.hat)</span></a>
<a class="sourceLine" id="cb67-23" data-line-number="23">    <span class="co"># title(last.year)</span></a>
<a class="sourceLine" id="cb67-24" data-line-number="24">    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx]</a>
<a class="sourceLine" id="cb67-25" data-line-number="25">    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx1 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx1.hat]</a>
<a class="sourceLine" id="cb67-26" data-line-number="26">    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx2.hat]</a>
<a class="sourceLine" id="cb67-27" data-line-number="27">    my.dt &lt;-<span class="st"> </span>my.dt[Year<span class="op">==</span>my.year, fx1fx2 <span class="op">:</span><span class="er">=</span><span class="st"> </span>fx1.hat <span class="op">+</span><span class="st"> </span>fx2.hat]</a>
<a class="sourceLine" id="cb67-28" data-line-number="28"></a>
<a class="sourceLine" id="cb67-29" data-line-number="29">}</a>
<a class="sourceLine" id="cb67-30" data-line-number="30"></a>
<a class="sourceLine" id="cb67-31" data-line-number="31">labels &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Observed&quot;</span> =<span class="st"> &quot;black&quot;</span>, <span class="st">&quot;Mixture 1&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;Mixture 2&quot;</span> =<span class="st"> &quot;red&quot;</span>, <span class="st">&quot;Sum of mixtures&quot;</span>=<span class="st">&quot;orange&quot;</span>)</a>
<a class="sourceLine" id="cb67-32" data-line-number="32"></a>
<a class="sourceLine" id="cb67-33" data-line-number="33"><span class="co"># plot2 &lt;-</span></a>
<a class="sourceLine" id="cb67-34" data-line-number="34"><span class="co">#   ggplot(data=my.dt, aes(x=Age)) + </span></a>
<a class="sourceLine" id="cb67-35" data-line-number="35"><span class="co">#   geom_line(aes( y= ASFR, group=Year, color = &quot;Observed&quot;))+</span></a>
<a class="sourceLine" id="cb67-36" data-line-number="36"><span class="co">#   geom_line(aes( y= fx1, group=Year, color = &quot;Mixture 1&quot;))+</span></a>
<a class="sourceLine" id="cb67-37" data-line-number="37"><span class="co">#   geom_line(aes( y= fx2, group=Year, color = &quot;Mixture 2&quot;))+</span></a>
<a class="sourceLine" id="cb67-38" data-line-number="38"><span class="co">#   geom_line(aes( y= fx1fx2, group=Year, color = &quot;Sum of mixtures&quot;))+</span></a>
<a class="sourceLine" id="cb67-39" data-line-number="39"><span class="co">#   labs(color = &quot;Legend&quot;) +</span></a>
<a class="sourceLine" id="cb67-40" data-line-number="40"><span class="co">#   scale_color_manual(values = labels)+</span></a>
<a class="sourceLine" id="cb67-41" data-line-number="41"><span class="co">#   theme_bw()#+</span></a>
<a class="sourceLine" id="cb67-42" data-line-number="42"><span class="co">#   transition_time(Year)+</span></a>
<a class="sourceLine" id="cb67-43" data-line-number="43"><span class="co">#   labs(title = &quot;Year: {frame_time}&quot;)</span></a>
<a class="sourceLine" id="cb67-44" data-line-number="44"></a>
<a class="sourceLine" id="cb67-45" data-line-number="45"><span class="co"># anim_save(&quot;plot2.gif&quot;, plot2)</span></a></code></pre></div>
<p><img src="plot2.gif" />
The animation shows how the distributions operate under the AFSR curve. There could be two separate normal distributions with distinct mean ages of childbearing.</p>
<p>Let’s do tempo adjustment:<strong>NOTE: Help! I don’t know how to interpret these graphs</strong></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">rt.mat &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(mu.mat, <span class="dv">1</span>, center.diff))</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">tfr.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(my.fat, <span class="dv">2</span>, sum)</a>
<a class="sourceLine" id="cb68-3" data-line-number="3">tfr.mat &lt;-<span class="st"> </span>lambda.mat <span class="op">*</span><span class="st"> </span>tfr.vec</a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb68-5" data-line-number="5"></a>
<a class="sourceLine" id="cb68-6" data-line-number="6"><span class="kw">matplot</span>(my.year.vec, <span class="kw">t</span>(tfr.mat), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb68-7" data-line-number="7">tfr.star.mat &lt;-<span class="st"> </span>tfr.mat <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>rt.mat)</a>
<a class="sourceLine" id="cb68-8" data-line-number="8"><span class="kw">matplot</span>(my.year.vec, <span class="kw">t</span>(tfr.star.mat), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">tfr.star.vec &lt;-<span class="st"> </span><span class="kw">colSums</span>(tfr.star.mat)</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="kw">plot</span>(my.year.vec, tfr.vec, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb69-5" data-line-number="5">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb69-6" data-line-number="6"></a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="kw">lines</span>(my.year.vec, tfr.star.vec, <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-73-2.png" width="672" /></p>
<div id="mixture" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Mixture</h3>
<p>Let’s look at 1st births, again as if their are two latent groups: <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>. (These could be “early moms” / “late moms”, non-college / college, pre-marital / marital, lower-class / upper class, <span class="math inline">\(\ldots\)</span>)</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">library</span>(mixtools)</a>
<a class="sourceLine" id="cb70-2" data-line-number="2">  <span class="co">## simulate 2 normals </span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3">  N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N, <span class="dt">mean =</span> <span class="dv">22</span>, <span class="dt">sd =</span> <span class="dv">3</span>) <span class="co">##</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>N, <span class="dt">mean =</span> <span class="dv">30</span>, <span class="dt">sd =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb70-6" data-line-number="6">  <span class="co">## combine them</span></a>
<a class="sourceLine" id="cb70-7" data-line-number="7">  x &lt;-<span class="st"> </span><span class="kw">c</span>(x1,x2)</a>
<a class="sourceLine" id="cb70-8" data-line-number="8">  <span class="co">## use EM to infer mixture</span></a>
<a class="sourceLine" id="cb70-9" data-line-number="9">  out &lt;-<span class="st"> </span><span class="kw">normalmixEM</span>(x,</a>
<a class="sourceLine" id="cb70-10" data-line-number="10">                     <span class="dt">lambda =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb70-11" data-line-number="11">                     <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">35</span>),</a>
<a class="sourceLine" id="cb70-12" data-line-number="12">                     <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>))</a></code></pre></div>
<pre><code>## number of iterations= 371</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">  <span class="kw">print</span>(out<span class="op">$</span>mu)</a></code></pre></div>
<pre><code>## [1] 22.62401 30.73713</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">  <span class="kw">print</span>(out<span class="op">$</span>sigma)</a></code></pre></div>
<pre><code>## [1] 3.265651 3.645539</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">  <span class="kw">print</span>(out<span class="op">$</span>lambda)</a></code></pre></div>
<pre><code>## [1] 0.4259413 0.5740587</code></pre>
<p>Seems to work great.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">  ages &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">:</span><span class="dv">49</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">  dens1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> ages, <span class="dt">mean =</span> out<span class="op">$</span>mu[<span class="dv">1</span>], <span class="dt">sd =</span> out<span class="op">$</span>sigma[<span class="dv">1</span>]) <span class="op">*</span><span class="st"> </span>out<span class="op">$</span>lambda[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">  dens2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(<span class="dt">x =</span> ages, <span class="dt">mean =</span> out<span class="op">$</span>mu[<span class="dv">2</span>], <span class="dt">sd =</span> out<span class="op">$</span>sigma[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span>out<span class="op">$</span>lambda[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb78-4" data-line-number="4">  <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb78-5" data-line-number="5">  <span class="kw">hist</span>(x, <span class="dt">probability =</span> T, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</a>
<a class="sourceLine" id="cb78-6" data-line-number="6">  <span class="kw">lines</span>(ages, dens1, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb78-7" data-line-number="7">  <span class="kw">lines</span>(ages, dens2, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb78-8" data-line-number="8">  <span class="kw">lines</span>(ages, dens1 <span class="op">+</span><span class="st"> </span>dens2, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="an-algorithm-for-tempo-adjustment-of-mixtures" class="section level3">
<h3><span class="header-section-number">7.5.2</span> An algorithm for tempo adjustment of mixtures</h3>
<ul>
<li>Fit normal mixture to each year.</li>
<li>Refit using constant variance (average). This assures shape invariance of each component, fulfilling BF assumption.</li>
<li><p>Estimate BF separately for <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, and combine.</p></li>
<li><p>tempo_mixed_results_figure.pdf <strong>NOTE: not sure about this…</strong></p></li>
</ul>
</div>
</div>
<div id="conclusions-4" class="section level2">
<h2><span class="header-section-number">7.6</span> Conclusions</h2>
<ul>
<li>Postponement dilutes period births, lowers TFR</li>
<li>Tempo-adjustment tries to ``put births back in’’</li>
<li>Changes in mean work fine if ``shape’’ doesn’t change</li>
<li>Shape can change through heterogeneity</li>
<li>With strong assumptions, we can identify heterogeneity</li>
<li>Declining quantum for young and postponement for old appears
to be the story</li>
</ul>
<div id="caveats" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Caveats</h3>
<ul>
<li>Who are these latent groups? Do you start out in one and end up in the other? Do you stay in one your whole life?</li>
<li>How do we project forward?</li>
<li>Can we use other indicators (e.g., social class, education,
marriage) to get same results?</li>
</ul>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bongaarts1998quantum">
<p>Bongaarts, John, and Griffith Feeney. 1998. “On the Quantum and Tempo of Fertility.” <em>Population and Development Review</em>. JSTOR, 271–91.</p>
</div>
<div id="ref-burkimsher2017evolution">
<p>Burkimsher, Marion. 2017. “Evolution of the Shape of the Fertility Curve: Why Might Some Countries Develop a Bimodal Curve?” <em>Demographic Research</em> 37. JSTOR: 295–324.</p>
</div>
<div id="ref-hastie2009elements">
<p>Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-sullivan2005age">
<p>Sullivan, Rachel. 2005. “The Age Pattern of First-Birth Rates Among Us Women: The Bimodal 1990s.” <em>Demography</em> 42 (2). Springer: 259–73.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mortality-plateaus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="branching-processes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06-tempo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
