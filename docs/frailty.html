<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Multiplicative Fixed Frailty | Mathematical Demography</title>
  <meta name="description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Multiplicative Fixed Frailty | Mathematical Demography" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book from the Mathematical Demography lecture notes." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Multiplicative Fixed Frailty | Mathematical Demography" />
  
  <meta name="twitter:description" content="This is a book from the Mathematical Demography lecture notes." />
  

<meta name="author" content="Josh R. Goldstein" />


<meta name="date" content="2020-12-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="gamma-frailty-with-applications.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Random Demography</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Demographic Heterogeneity</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>2.1</b> Outline</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#part-i.-conceptual-introduction"><i class="fa fa-check"></i><b>2.2</b> Part I. Conceptual Introduction</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#what-is-demographic-heterogeneity"><i class="fa fa-check"></i><b>2.2.1</b> What is Demographic Heterogeneity?</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#analogies"><i class="fa fa-check"></i><b>2.2.2</b> Analogies</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#whats-new"><i class="fa fa-check"></i><b>2.2.3</b> What’s new?</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#application"><i class="fa fa-check"></i><b>2.2.4</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#part-ii.-formal-analysis"><i class="fa fa-check"></i><b>2.3</b> Part II. Formal Analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#outline-1"><i class="fa fa-check"></i><b>2.3.1</b> Outline</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#keyfitz-result"><i class="fa fa-check"></i><b>2.3.2</b> Keyfitz result</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#us-mexico-example"><i class="fa fa-check"></i><b>2.3.3</b> US-Mexico Example</a></li>
<li class="chapter" data-level="2.3.4" data-path="intro.html"><a href="intro.html#the-origin-of-professor-wachters-poisson-exponential-model"><i class="fa fa-check"></i><b>2.3.4</b> The Origin of Professor Wachter’s Poisson-Exponential Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="intro.html"><a href="intro.html#some-commentary"><i class="fa fa-check"></i><b>2.3.5</b> Some commentary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#conclusions"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#questions"><i class="fa fa-check"></i><b>2.5</b> Questions</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#solutions"><i class="fa fa-check"></i><b>2.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>3</b> Multiplicative Fixed Frailty</a><ul>
<li class="chapter" data-level="3.1" data-path="frailty.html"><a href="frailty.html#outline-2"><i class="fa fa-check"></i><b>3.1</b> Outline</a><ul>
<li class="chapter" data-level="3.1.1" data-path="frailty.html"><a href="frailty.html#review-of-mortality-mathematics"><i class="fa fa-check"></i><b>3.1.1</b> Review of mortality mathematics</a></li>
<li class="chapter" data-level="3.1.2" data-path="frailty.html"><a href="frailty.html#application-what-is-ellx"><i class="fa fa-check"></i><b>3.1.2</b> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</a></li>
<li class="chapter" data-level="3.1.3" data-path="frailty.html"><a href="frailty.html#extending-keyfitz-to-mortality"><i class="fa fa-check"></i><b>3.1.3</b> Extending Keyfitz to mortality</a></li>
<li class="chapter" data-level="3.1.4" data-path="frailty.html"><a href="frailty.html#multiplicative-fixed-frailty"><i class="fa fa-check"></i><b>3.1.4</b> Multiplicative Fixed frailty</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="frailty.html"><a href="frailty.html#part-i.-results-from-fixed-frailty"><i class="fa fa-check"></i><b>3.2</b> Part I. Results from Fixed Frailty</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frailty.html"><a href="frailty.html#a-simulation"><i class="fa fa-check"></i><b>3.2.1</b> A simulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="frailty.html"><a href="frailty.html#lets-derive-pop-survival-note-bars-barell"><i class="fa fa-check"></i><b>3.2.2</b> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="frailty.html"><a href="frailty.html#now-population-hazards-stepping-stones"><i class="fa fa-check"></i><b>3.2.3</b> Now population hazards (stepping stones)</a></li>
<li class="chapter" data-level="3.2.4" data-path="frailty.html"><a href="frailty.html#rodriguez-question"><i class="fa fa-check"></i><b>3.2.4</b> Rodriguez question</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frailty.html"><a href="frailty.html#part-ii.-introduction-to-gamma-frailty"><i class="fa fa-check"></i><b>3.3</b> Part II. Introduction to Gamma Frailty</a><ul>
<li class="chapter" data-level="3.3.1" data-path="frailty.html"><a href="frailty.html#the-gamma-distribution"><i class="fa fa-check"></i><b>3.3.1</b> The Gamma distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="frailty.html"><a href="frailty.html#gamma-in-r"><i class="fa fa-check"></i><b>3.3.2</b> Gamma in R</a></li>
<li class="chapter" data-level="3.3.3" data-path="frailty.html"><a href="frailty.html#population-survival-of-gamma-frailty"><i class="fa fa-check"></i><b>3.3.3</b> Population Survival of Gamma Frailty</a></li>
<li class="chapter" data-level="3.3.4" data-path="frailty.html"><a href="frailty.html#interpreting-gamma-frailty-survival"><i class="fa fa-check"></i><b>3.3.4</b> Interpreting Gamma-frailty survival</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="frailty.html"><a href="frailty.html#conclusions-1"><i class="fa fa-check"></i><b>3.4</b> Conclusions</a></li>
<li class="chapter" data-level="3.5" data-path="frailty.html"><a href="frailty.html#questions-1"><i class="fa fa-check"></i><b>3.5</b> Questions</a></li>
<li class="chapter" data-level="3.6" data-path="frailty.html"><a href="frailty.html#solutions-1"><i class="fa fa-check"></i><b>3.6</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html"><i class="fa fa-check"></i><b>4</b> Gamma Frailty with Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#from-survival-to-hazards"><i class="fa fa-check"></i><b>4.1</b> From survival to hazards</a><ul>
<li class="chapter" data-level="4.1.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#what-happens-to-frailty-of-survivors"><i class="fa fa-check"></i><b>4.1.1</b> What happens to frailty of survivors?</a></li>
<li class="chapter" data-level="4.1.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#average-frailty-in-terms-of-survival"><i class="fa fa-check"></i><b>4.1.2</b> Average frailty in terms of survival</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#censoc-selection-and-observed-frailty"><i class="fa fa-check"></i><b>4.2</b> CenSoc: Selection and observed frailty</a><ul>
<li class="chapter" data-level="4.2.1" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#data"><i class="fa fa-check"></i><b>4.2.1</b> Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#estimation"><i class="fa fa-check"></i><b>4.2.2</b> Estimation</a></li>
<li class="chapter" data-level="4.2.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#discuss-our-conclusions-and-possible-future-directions-to-follow."><i class="fa fa-check"></i><b>4.2.3</b> Discuss our conclusions and possible future directions to follow.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#questions-2"><i class="fa fa-check"></i><b>4.3</b> Questions</a></li>
<li class="chapter" data-level="4.4" data-path="gamma-frailty-with-applications.html"><a href="gamma-frailty-with-applications.html#solutions-2"><i class="fa fa-check"></i><b>4.4</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html"><i class="fa fa-check"></i><b>5</b> Convergence and cross-overs</a><ul>
<li class="chapter" data-level="5.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#outline-3"><i class="fa fa-check"></i><b>5.1</b> Outline</a></li>
<li class="chapter" data-level="5.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#what-happens-to-mortality-disparities-at-older-ages"><i class="fa fa-check"></i><b>5.2</b> What happens to mortality disparities at older ages?</a><ul>
<li class="chapter" data-level="5.2.1" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-possible-null-model"><i class="fa fa-check"></i><b>5.2.1</b> A possible null-model</a></li>
<li class="chapter" data-level="5.2.2" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#a-result-5e---vaupel2014unobserved-eq-38"><i class="fa fa-check"></i><b>5.2.2</b> A result: (5E - <span class="citation">Vaupel and Missov (<span>2014</span>)</span> (Eq 38))</a></li>
<li class="chapter" data-level="5.2.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#inversion"><i class="fa fa-check"></i><b>5.2.3</b> Inversion</a></li>
<li class="chapter" data-level="5.2.4" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#an-example-1"><i class="fa fa-check"></i><b>5.2.4</b> An example</a></li>
<li class="chapter" data-level="5.2.5" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#application-1"><i class="fa fa-check"></i><b>5.2.5</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="convergence-and-cross-overs.html"><a href="convergence-and-cross-overs.html#student-presentation"><i class="fa fa-check"></i><b>5.3</b> Student Presentation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html"><i class="fa fa-check"></i><b>6</b> Mortality plateaus</a><ul>
<li class="chapter" data-level="6.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-4"><i class="fa fa-check"></i><b>6.1</b> Outline</a></li>
<li class="chapter" data-level="6.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#heterogeneity-slows-mortality-improvement"><i class="fa fa-check"></i><b>6.2</b> Heterogeneity slows mortality improvement</a><ul>
<li class="chapter" data-level="6.2.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#an-example-2"><i class="fa fa-check"></i><b>6.2.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#conclusions-2"><i class="fa fa-check"></i><b>6.3</b> Conclusions</a></li>
<li class="chapter" data-level="6.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#hazards-and-plateaus-by-professor-ken-wachter"><i class="fa fa-check"></i><b>6.4</b> Hazards and Plateaus by Professor Ken Wachter</a><ul>
<li class="chapter" data-level="6.4.1" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#outline-5"><i class="fa fa-check"></i><b>6.4.1</b> Outline</a></li>
<li class="chapter" data-level="6.4.2" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#extremes-of-longevity-in-humans-and-other-species"><i class="fa fa-check"></i><b>6.4.2</b> Extremes of Longevity in Humans and Other Species</a></li>
<li class="chapter" data-level="6.4.3" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#gamma-gompertz-fixed-frailty-hazards"><i class="fa fa-check"></i><b>6.4.3</b> Gamma-Gompertz Fixed Frailty Hazards</a></li>
<li class="chapter" data-level="6.4.4" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#less-restrictive-frailty-models"><i class="fa fa-check"></i><b>6.4.4</b> Less Restrictive Frailty Models</a></li>
<li class="chapter" data-level="6.4.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#mutation-accumulation-gompertz-hazards-with-plateaus"><i class="fa fa-check"></i><b>6.4.5</b> Mutation Accumulation, Gompertz Hazards with Plateaus</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="mortality-plateaus.html"><a href="mortality-plateaus.html#key-points"><i class="fa fa-check"></i><b>6.5</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><i class="fa fa-check"></i><b>7</b> Fertility Heterogeneity: Tempo Distortions and Distorted Tempo</a><ul>
<li class="chapter" data-level="7.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#outline-6"><i class="fa fa-check"></i><b>7.1</b> Outline</a></li>
<li class="chapter" data-level="7.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#introduction-1"><i class="fa fa-check"></i><b>7.2</b> Introduction</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#fertility-postponement-a-very-simple-example"><i class="fa fa-check"></i><b>7.2.1</b> Fertility postponement, a very simple example</a></li>
<li class="chapter" data-level="7.2.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#continuous-postponement-a-shiny-simulation"><i class="fa fa-check"></i><b>7.2.2</b> Continuous postponement, a shiny simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#period-shifts-bongaarts-and-feeneys-model"><i class="fa fa-check"></i><b>7.3</b> Period Shifts: Bongaarts and Feeney’s model</a><ul>
<li class="chapter" data-level="7.3.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#a-derivation-due-to-rodriguez-note-not-sure-what-the-reference-is-here"><i class="fa fa-check"></i><b>7.3.1</b> A derivation: due to Rodriguez <em>NOTE: not sure what the reference is here</em></a></li>
<li class="chapter" data-level="7.3.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#tempo-adjusted-tfr"><i class="fa fa-check"></i><b>7.3.2</b> Tempo-adjusted TFR:</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-application-to-the-united-states"><i class="fa fa-check"></i><b>7.4</b> An Application to the United States</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-3"><i class="fa fa-check"></i><b>7.4.1</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#two-americas"><i class="fa fa-check"></i><b>7.5</b> Two Americas</a><ul>
<li class="chapter" data-level="7.5.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#mixture"><i class="fa fa-check"></i><b>7.5.1</b> Mixture</a></li>
<li class="chapter" data-level="7.5.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#an-algorithm-for-tempo-adjustment-of-mixtures"><i class="fa fa-check"></i><b>7.5.2</b> An algorithm for tempo adjustment of mixtures</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#conclusions-4"><i class="fa fa-check"></i><b>7.6</b> Conclusions</a><ul>
<li class="chapter" data-level="7.6.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#caveats"><i class="fa fa-check"></i><b>7.6.1</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#questions-3"><i class="fa fa-check"></i><b>7.7</b> Questions</a></li>
<li class="chapter" data-level="7.8" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#solutions-3"><i class="fa fa-check"></i><b>7.8</b> Solutions</a><ul>
<li class="chapter" data-level="7.8.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#what-is-a-bienayme-galton-watson-branching-process"><i class="fa fa-check"></i><b>7.8.1</b> What is a (Bienayme)-Galton-Watson branching process?</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#simulations-of-parents-having-children"><i class="fa fa-check"></i><b>7.9</b> Simulations of parents having children</a></li>
<li class="chapter" data-level="7.10" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#the-probability-generating-function-our-mathematical-tool"><i class="fa fa-check"></i><b>7.10</b> The Probability Generating Function: Our mathematical tool</a></li>
<li class="chapter" data-level="7.11" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#extinction"><i class="fa fa-check"></i><b>7.11</b> Extinction</a></li>
<li class="chapter" data-level="7.12" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#good-and-bad-set-ups-for-branching-process"><i class="fa fa-check"></i><b>7.12</b> Good and bad set-ups for branching process</a></li>
<li class="chapter" data-level="7.13" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#the-distribution-of-offspring-of-all-generations"><i class="fa fa-check"></i><b>7.13</b> The distribution of offspring of all generations</a><ul>
<li class="chapter" data-level="7.13.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#proving-mathbbe-z_n-mn"><i class="fa fa-check"></i><b>7.13.1</b> Proving <span class="math inline">\(\mathbb{E} Z_n = m^n\)</span></a></li>
<li class="chapter" data-level="7.13.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#variance-result."><i class="fa fa-check"></i><b>7.13.2</b> Variance result.</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#geometric-offspring-distribution"><i class="fa fa-check"></i><b>7.14</b> Geometric offspring distribution</a><ul>
<li class="chapter" data-level="7.14.1" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#the-geometric-distributions-simple-pgf"><i class="fa fa-check"></i><b>7.14.1</b> The Geometric Distribution’s simple PGF</a></li>
<li class="chapter" data-level="7.14.2" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#a-plot-of-keyfitzs-numbers-for-generations-1-2-and-3.-is-it-exponential-for-k-0"><i class="fa fa-check"></i><b>7.14.2</b> A plot of Keyfitz’s numbers for generations 1, 2, and 3. Is it exponential for <span class="math inline">\(k &gt; 0\)</span>?</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#branching-processes-and-covid-19"><i class="fa fa-check"></i><b>7.15</b> Branching Processes and Covid-19</a></li>
<li class="chapter" data-level="7.16" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#problems"><i class="fa fa-check"></i><b>7.16</b> Problems</a></li>
<li class="chapter" data-level="7.17" data-path="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html"><a href="fertility-heterogeneity-tempo-distortions-and-distorted-tempo.html#solutions-4"><i class="fa fa-check"></i><b>7.17</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fisher-wright.html"><a href="fisher-wright.html"><i class="fa fa-check"></i><b>8</b> Fisher-Wright</a><ul>
<li class="chapter" data-level="8.1" data-path="fisher-wright.html"><a href="fisher-wright.html#outline-7"><i class="fa fa-check"></i><b>8.1</b> Outline</a></li>
<li class="chapter" data-level="8.2" data-path="fisher-wright.html"><a href="fisher-wright.html#parallel"><i class="fa fa-check"></i><b>8.2</b> Parallel</a><ul>
<li class="chapter" data-level="8.2.1" data-path="fisher-wright.html"><a href="fisher-wright.html#another-cell-phone-example"><i class="fa fa-check"></i><b>8.2.1</b> Another cell phone example</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fisher-wright.html"><a href="fisher-wright.html#mutation"><i class="fa fa-check"></i><b>8.3</b> Mutation</a></li>
<li class="chapter" data-level="8.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fixation"><i class="fa fa-check"></i><b>8.4</b> Fixation</a><ul>
<li class="chapter" data-level="8.4.1" data-path="fisher-wright.html"><a href="fisher-wright.html#probability-that-a-particular-line-will-fix"><i class="fa fa-check"></i><b>8.4.1</b> Probability that a particular line will “fix”</a></li>
<li class="chapter" data-level="8.4.2" data-path="fisher-wright.html"><a href="fisher-wright.html#expected-time-until-fixation"><i class="fa fa-check"></i><b>8.4.2</b> Expected time until fixation?</a></li>
<li class="chapter" data-level="8.4.3" data-path="fisher-wright.html"><a href="fisher-wright.html#path-to-fixation-a-measure-of-homogeneityheterogeneity"><i class="fa fa-check"></i><b>8.4.3</b> Path to fixation: a measure of homogeneity/heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="fisher-wright.html"><a href="fisher-wright.html#baby-names"><i class="fa fa-check"></i><b>8.5</b> Baby Names</a><ul>
<li class="chapter" data-level="8.5.1" data-path="fisher-wright.html"><a href="fisher-wright.html#basic-idea"><i class="fa fa-check"></i><b>8.5.1</b> Basic idea</a></li>
<li class="chapter" data-level="8.5.2" data-path="fisher-wright.html"><a href="fisher-wright.html#fisher-wright-simulation-of-baby-names-hahn-and-bentley"><i class="fa fa-check"></i><b>8.5.2</b> Fisher-Wright simulation of Baby Names (Hahn and Bentley)</a></li>
<li class="chapter" data-level="8.5.3" data-path="fisher-wright.html"><a href="fisher-wright.html#drawing-their-picture-with-simulation"><i class="fa fa-check"></i><b>8.5.3</b> Drawing their picture with simulation</a></li>
<li class="chapter" data-level="8.5.4" data-path="fisher-wright.html"><a href="fisher-wright.html#fw-babyname-simulation-of-equilibrium-frequencies"><i class="fa fa-check"></i><b>8.5.4</b> FW babyname simulation of equilibrium frequencies</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="fisher-wright.html"><a href="fisher-wright.html#now-we-can-simulate-babynames"><i class="fa fa-check"></i><b>8.6</b> Now we can simulate babynames</a></li>
<li class="chapter" data-level="8.7" data-path="fisher-wright.html"><a href="fisher-wright.html#conclusions-5"><i class="fa fa-check"></i><b>8.7</b> Conclusions</a><ul>
<li class="chapter" data-level="8.7.1" data-path="fisher-wright.html"><a href="fisher-wright.html#some-potential-criticism"><i class="fa fa-check"></i><b>8.7.1</b> Some potential criticism</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="coalescent.html"><a href="coalescent.html"><i class="fa fa-check"></i><b>9</b> Coalescent</a><ul>
<li class="chapter" data-level="9.1" data-path="coalescent.html"><a href="coalescent.html#outline-8"><i class="fa fa-check"></i><b>9.1</b> Outline</a></li>
<li class="chapter" data-level="9.2" data-path="coalescent.html"><a href="coalescent.html#the-coalescent-expectations-of-the-past"><i class="fa fa-check"></i><b>9.2</b> The Coalescent: Expectations of the Past</a></li>
<li class="chapter" data-level="9.3" data-path="coalescent.html"><a href="coalescent.html#our-first-question-when-was-mrca"><i class="fa fa-check"></i><b>9.3</b> Our first question: When was MRCA?</a></li>
<li class="chapter" data-level="9.4" data-path="coalescent.html"><a href="coalescent.html#mutation-and-inference-of-tmrca-and-n"><i class="fa fa-check"></i><b>9.4</b> Mutation and inference of TMRCA and <span class="math inline">\(N\)</span></a><ul>
<li class="chapter" data-level="9.4.1" data-path="coalescent.html"><a href="coalescent.html#inference-of-population-size-simulation"><i class="fa fa-check"></i><b>9.4.1</b> Inference of population size (Simulation)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="coalescent.html"><a href="coalescent.html#coalescence-of-a-sample-of-n-individuals"><i class="fa fa-check"></i><b>9.5</b> Coalescence of a sample of <span class="math inline">\(n\)</span> individuals</a></li>
<li class="chapter" data-level="9.6" data-path="coalescent.html"><a href="coalescent.html#an-application-of-coalescent-theory"><i class="fa fa-check"></i><b>9.6</b> An application of coalescent theory</a><ul>
<li class="chapter" data-level="9.6.1" data-path="coalescent.html"><a href="coalescent.html#coalesence-when-population-is-changing"><i class="fa fa-check"></i><b>9.6.1</b> Coalesence when population is changing</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="coalescent.html"><a href="coalescent.html#reconstruction-ancient-european-population-sizes-using-batinis-sample-of-mitochondrial-dna"><i class="fa fa-check"></i><b>9.7</b> Reconstruction Ancient European Population Sizes using Batini’s sample of Mitochondrial DNA"</a><ul>
<li class="chapter" data-level="9.7.1" data-path="coalescent.html"><a href="coalescent.html#summary-of-batini-et-al."><i class="fa fa-check"></i><b>9.7.1</b> Summary of Batini et al.</a></li>
<li class="chapter" data-level="9.7.2" data-path="coalescent.html"><a href="coalescent.html#ancient-population-estimates"><i class="fa fa-check"></i><b>9.7.2</b> Ancient population estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="student-presentations.html"><a href="student-presentations.html"><i class="fa fa-check"></i><b>10</b> Student Presentations</a><ul>
<li class="chapter" data-level="10.1" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers"><i class="fa fa-check"></i><b>10.1</b> Mortality Crossovers</a><ul>
<li class="chapter" data-level="10.1.1" data-path="student-presentations.html"><a href="student-presentations.html#outline-9"><i class="fa fa-check"></i><b>10.1.1</b> Outline</a></li>
<li class="chapter" data-level="10.1.2" data-path="student-presentations.html"><a href="student-presentations.html#mortality-crossovers-reality-or-bad-data-coale1986mortality"><i class="fa fa-check"></i><b>10.1.2</b> <em>Mortality Crossovers: Reality or Bad Data?</em> <span class="citation">(Coale and Kisker <span>1986</span>)</span></a></li>
<li class="chapter" data-level="10.1.3" data-path="student-presentations.html"><a href="student-presentations.html#methods-for-evaluating-the-heterogeneity-of-aging-processes-in-human-populations-using-vital-statistics-data-explaining-the-blackwhite-mortality-crossover-by-a-model-of-mortality-selection-manton1981methods"><i class="fa fa-check"></i><b>10.1.3</b> <em>Methods for Evaluating the Heterogeneity of Aging Processes in Human Populations Using Vital Statistics Data: Explaining the Black/White Mortality Crossover by a Model of Mortality Selection</em> <span class="citation">(Manton and Stallard <span>1981</span>)</span></a></li>
<li class="chapter" data-level="10.1.4" data-path="student-presentations.html"><a href="student-presentations.html#censoc-mortality-crossovers"><i class="fa fa-check"></i><b>10.1.4</b> CenSoc Mortality Crossovers</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="student-presentations.html"><a href="student-presentations.html#plateaus"><i class="fa fa-check"></i><b>10.2</b> Plateaus</a></li>
<li class="chapter" data-level="10.3" data-path="student-presentations.html"><a href="student-presentations.html#rising-inequality"><i class="fa fa-check"></i><b>10.3</b> Rising Inequality</a><ul>
<li class="chapter" data-level="10.3.1" data-path="student-presentations.html"><a href="student-presentations.html#trends-in-mortality-differentials-and-life-expectancy-for-male-social-security-covered-workers-by-socioeconomic-status-waldron2007trends"><i class="fa fa-check"></i><b>10.3.1</b> <em>Trends in mortality differentials and life expectancy for male social security-covered workers, by socioeconomic status</em> <span class="citation">(Waldron <span>2007</span>)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html"><i class="fa fa-check"></i><b>11</b> Demographic theory and COVID-19</a><ul>
<li class="chapter" data-level="11.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#outline-10"><i class="fa fa-check"></i><b>11.1</b> Outline</a></li>
<li class="chapter" data-level="11.2" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#motivating-questions"><i class="fa fa-check"></i><b>11.2</b> Motivating questions</a></li>
<li class="chapter" data-level="11.3" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#population-aging"><i class="fa fa-check"></i><b>11.3</b> Population aging</a><ul>
<li class="chapter" data-level="11.3.1" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stable-theory"><i class="fa fa-check"></i><b>11.3.1</b> Stable theory</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#keyfitzs-entropy"><i class="fa fa-check"></i><b>11.4</b> Keyfitz’s entropy</a></li>
<li class="chapter" data-level="11.5" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#loss-of-person-years-remaining"><i class="fa fa-check"></i><b>11.5</b> Loss of person years remaining</a></li>
<li class="chapter" data-level="11.6" data-path="demographic-theory-and-covid-19.html"><a href="demographic-theory-and-covid-19.html#stationary-theory"><i class="fa fa-check"></i><b>11.6</b> Stationary theory</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematical Demography</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frailty" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Multiplicative Fixed Frailty</h1>
<div id="outline-2" class="section level2">
<h2><span class="header-section-number">3.1</span> Outline</h2>
<ol style="list-style-type: decimal">
<li>Review of Mortality Mathematics</li>
<li>Multiplicative-fixed-frailty and alternatives.</li>
<li>Population Survival and Hazards under fixed frailty</li>
<li>Gamma frailty</li>
</ol>
<p>Additional resources</p>
<ul>
<li><span class="citation">Vaupel and Missov (<a href="#ref-vaupel2014unobserved" role="doc-biblioref">2014</a>)</span>:</li>
<li><span class="citation">Rodriguez (<a href="#ref-rodriguez2001" role="doc-biblioref">2001</a>)</span>: detailed hand-out for Princeton class. Many of the same results as <span class="citation">Vaupel and Missov (<a href="#ref-vaupel2014unobserved" role="doc-biblioref">2014</a>)</span>, but with alternative derivations and notation. Also includes inversion formula and extensions beyond Gamma frailty such as “Inverse Gaussian Frailty”.</li>
</ul>
<div id="review-of-mortality-mathematics" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Review of mortality mathematics</h3>
<ul>
<li><p><span class="math inline">\(\ell(x)\)</span> or <span class="math inline">\(S(x)\)</span> probability of survival to age <span class="math inline">\(x\)</span></p></li>
<li><p><span class="math inline">\(\mu(x)\)</span> or <span class="math inline">\(h(x)\)</span> hazard rate at age <span class="math inline">\(x\)</span> (“minus the exponential rate of change in survival”)</p>
<p>Let’s treat <span class="math inline">\(\mu\)</span> as a definition.
<span class="math display">\[
\mu(x) \equiv -{d \over dx} \log \ell(x)
\]</span></p>
<p>Can anti-differentiate (integrate) to solve for survival:
<span class="math display">\[
\ell(x) = s(x) = e^{-\int_0^x \mu(a)\, da}
\]</span></p></li>
</ul>
</div>
<div id="application-what-is-ellx" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Application: what is <span class="math inline">\(\ell&#39;(x)\)</span>?</h3>
<ul>
<li>in words?</li>
<li>taking derivative of <span class="math inline">\(\ell(x)\)</span></li>
<li>interpretation</li>
</ul>
<div id="two-special-cases" class="section level4">
<h4><span class="header-section-number">3.1.2.1</span> Two special cases</h4>
<ul>
<li>Constant hazards <span class="math inline">\(\mu(x) = \mu\)</span>. What’s <span class="math inline">\(\ell(x)\)</span>?</li>
<li>Gompertz hazards <span class="math inline">\(\mu(x) = a e^{b x}\)</span>. What’s <span class="math inline">\(\ell(x)\)</span>?</li>
</ul>
</div>
</div>
<div id="extending-keyfitz-to-mortality" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Extending Keyfitz to mortality</h3>
<p><span class="math display">\[
  {d \over dx} \bar{\mu}(x) = \mbox{average rate of change} - \sigma_\mu^2
  \]</span></p>
<p>What is <span class="math inline">\(\bar{\mu}\)</span>? It’s a weighted average:
<span class="math display">\[
  \bar{\mu}(x) = {\int \mu(x | z) \ell(x | z) p(z) \, dz
    \over
    \int \ell(x | z) p(z) \, dz}
  \]</span></p>
<p>To derive Keyfitz extension, differentiate with respect to age
<span class="math inline">\(x\)</span>. (See <span class="citation">Vaupel and Missov (<a href="#ref-vaupel2014unobserved" role="doc-biblioref">2014</a>)</span> (Eq. 13). A good exercise.</p>
</div>
<div id="multiplicative-fixed-frailty" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Multiplicative Fixed frailty</h3>
<p>For individual <span class="math inline">\(i\)</span>,
<span class="math display">\[
  \mu_i(x) = z_i \mu_0(x).
  \]</span></p>
<ul>
<li><span class="math inline">\(z_i\)</span> “frailty” of the <span class="math inline">\(i\)</span>th individual. (Usually thought of as a random variable with mean <span class="math inline">\(1\)</span>.)</li>
<li><span class="math inline">\(\mu_0(x)\)</span> “Baseline hazard” schedule. (Also, the schedule of a person with <span class="math inline">\(z = 1\)</span>).</li>
<li>Let’s think of at least three. (<span class="math inline">\(\beta\)</span>, <span class="math inline">\(i\)</span>, <span class="math inline">\(\Delta\)</span>)</li>
</ul>
<p>Which look like multiplicative fixed frailty?</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-6-1.png" alt="Multiplicative fixed frailty" width="672" />
<p class="caption">
Figure 3.1: Multiplicative fixed frailty
</p>
</div>
</div>
</div>
<div id="part-i.-results-from-fixed-frailty" class="section level2">
<h2><span class="header-section-number">3.2</span> Part I. Results from Fixed Frailty</h2>
<div id="a-simulation" class="section level3">
<h3><span class="header-section-number">3.2.1</span> A simulation</h3>
<ul>
<li>Our questions
<ul>
<li>How do we do a micro-simulation, with individuals?</li>
<li>How does fixed frailty fit in?</li>
<li>How do we compute pop survival, hazards, etc.</li>
<li>How does life table of heterogeneous pop differ from baseline?</li>
</ul></li>
</ul>
</div>
<div id="lets-derive-pop-survival-note-bars-barell" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Let’s derive pop survival (Note: <span class="math inline">\(\bar{s} = \bar{\ell}\)</span>)</h3>
<p>Pop survival will be a weighted average of group survival curves</p>
<p><span class="math display">\[
  \bar{s}(x) = {p(z_1) s_1(x) + p(z_2) s_2(x) + \ldots \over
    p(z_1) + p(z_2)  + \ldots}
  \]</span>
With continuous <span class="math inline">\(z\)</span> (what are limits of integration?)</p>
<p><span class="math display">\[
  \bar{s}(x) = \int s(x|z) p(z) \, dz
  \]</span></p>
<p>Under Multiplicative Fixed Frailty use
<span class="math display">\[ \mu(x|z)  = z \mu_0(x) \]</span></p>
<p>to derive</p>
<p><span class="math display">\[\bar{s}(x) = \int s_0(x)^z p(z) \,dz.\]</span></p>
</div>
<div id="now-population-hazards-stepping-stones" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Now population hazards (stepping stones)</h3>
<p>Definition of hazards:</p>
<p><span class="math display">\[
  \bar{\mu}(x) = - {d \over dx} \log \bar{s}(x)
  \]</span></p>
<p><span class="math display">\[
  \bar{\mu}(x) = \mu_0(x) {\int z s_0(x)^z p(z) \, dz \over
    \int  s_0(x)^z p(z) \, dz}
  \]</span></p>
<p><span class="math display">\[
  \bar{\mu}(x) = \mu_0(x) \bar{z}(x)
  \]</span></p>
<p>Let’s fill in steps.</p>
</div>
<div id="rodriguez-question" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Rodriguez question</h3>
<p>Why isn’t population hazard a (simple) average of individual hazards?</p>
<blockquote>
<p>Answer: selected survival means that the distribution of frailty at
age <span class="math inline">\(x\)</span> differs from the starting frailty distribution at age <span class="math inline">\(0\)</span>.</p>
</blockquote>
<p>The rate of increase in hazards</p>
<p>(AKA “LAR: Lifetable Aging Rate”)
<span class="math display">\[
  \beta(x) = {d \over dx} \log \mu(x)
  \]</span></p>
<p>Example:</p>
<p>What is <span class="math inline">\(\beta(x)\)</span> for Gompertz: <span class="math inline">\(\mu(x) = a e^{bx}\)</span>?</p>
<p>Vaupel’s result</p>
<p><span class="math display">\[
  \bar{\beta}(x) = \beta_0(x) - \bar{\mu}(x) CV_z^2(x)
  \]</span></p>
<ul>
<li>Hazards rise less slowly in pop than in baseline</li>
<li>If pop hazards plateau, then <span class="math inline">\(\bar{\beta}(x) = 0\)</span></li>
<li>Two special cases
<ul>
<li>Homogeneous pop and plateau in baseline</li>
<li>Gompertz and constant <span class="math inline">\(CV_z\)</span> (e.g., from Gamma)</li>
</ul></li>
</ul>
</div>
</div>
<div id="part-ii.-introduction-to-gamma-frailty" class="section level2">
<h2><span class="header-section-number">3.3</span> Part II. Introduction to Gamma Frailty</h2>
<div id="the-gamma-distribution" class="section level3">
<h3><span class="header-section-number">3.3.1</span> The Gamma distribution</h3>
<ul>
<li>What do we want in a frailty distribution?
<ul>
<li>positive?</li>
<li>a single dimension summarizing multiple factors? (Normal?)</li>
<li>flexible?</li>
<li>tractable?</li>
</ul></li>
<li>What’s the Gamma?</li>
</ul>
<p><span class="math display">\[
p(z | k, \lambda) = {\lambda^k  \over \Gamma(k)} z^{k-1} e^{-\lambda z} 
\]</span></p>
<ul>
<li><span class="math inline">\(z\)</span> the random variable representing frailty</li>
<li><span class="math inline">\(k, \lambda\)</span> parameters</li>
<li><span class="math inline">\(\Gamma(k)\)</span> A normalizing constant.</li>
</ul>
</div>
<div id="gamma-in-r" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Gamma in R</h3>
<ul>
<li>Mean: <span class="math inline">\(k / \lambda\)</span></li>
<li>Variance: <span class="math inline">\(k / \lambda^2\)</span></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="frailty.html#cb11-1"></a>  <span class="co">## with k and lambda</span></span>
<span id="cb11-2"><a href="frailty.html#cb11-2"></a>  k =<span class="st"> </span><span class="dv">3</span>; lambda =<span class="st"> </span><span class="dv">6</span></span>
<span id="cb11-3"><a href="frailty.html#cb11-3"></a>  x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">10000</span>, <span class="dt">shape =</span> k, <span class="dt">rate=</span> lambda)</span>
<span id="cb11-4"><a href="frailty.html#cb11-4"></a>  <span class="kw">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.5017978</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="frailty.html#cb13-1"></a>  <span class="kw">sd</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.2889426</code></pre>
<p>Alternate parameterization</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="frailty.html#cb15-1"></a>  <span class="co">## with mean 1, sigma.sq</span></span>
<span id="cb15-2"><a href="frailty.html#cb15-2"></a>  sigma.sq &lt;-<span class="st"> </span><span class="fl">.25</span></span>
<span id="cb15-3"><a href="frailty.html#cb15-3"></a>  z &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">10000</span>, <span class="dt">shape =</span> <span class="dv">1</span><span class="op">/</span>sigma.sq, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span>sigma.sq)</span>
<span id="cb15-4"><a href="frailty.html#cb15-4"></a>  <span class="kw">mean</span>(z)</span></code></pre></div>
<pre><code>## [1] 0.9996</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="frailty.html#cb17-1"></a>  <span class="kw">var</span>(z)</span></code></pre></div>
<pre><code>## [1] 0.2527649</code></pre>
</div>
<div id="population-survival-of-gamma-frailty" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Population Survival of Gamma Frailty</h3>
<p>Big picture
<span class="math display">\[
  \bar{s}(x) = \int s_0(x)^z p(z) \, dz
  \]</span></p>
<p>Or, using our definition of survival,
<span class="math display">\[
  \bar{s}(x) = \int e^{-z H_0(x)} p(z) \, dz
  \]</span></p>
<p>Completing the gamma
<span class="math display">\[
  \bar{s}(x) = \int e^{-z H_0(x)} {\lambda^k  \over \Gamma(k)} z^{k-1} e^{-\lambda z}  \, dz
  \]</span></p>
<p>Rearranging,</p>
<p><span class="math display">\[
  \bar{s}(x) = \lambda^k \int  { 1 \over \Gamma(k)} z^{k-1}
  e^{-z (H_0(x)+\lambda)}  \, dz
  \]</span></p>
<p>Integral is like a <span class="math inline">\(Gamma(z | k, H_0(x) + \lambda)\)</span>, but missing
something. What?</p>
<p>Our Result</p>
<p><span class="math display">\[
  \bar{S}(x) = {\lambda^k \over \left[H_0(x) + \lambda\right]^k}
  \]</span></p>
<p>If mean = 1.0, then we can let <span class="math inline">\(\lambda = k = 1/\sigma^2\)</span>,
<span class="math display">\[
  \bar S(x) = {1/\sigma^2 \over (H_0(x) + 1/\sigma^2)^{1/ \sigma^2}} =
  {1 \over  \left(1 + \sigma^2 H_0(x)\right)^{1/ \sigma^2}}
  \]</span></p>
</div>
<div id="interpreting-gamma-frailty-survival" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Interpreting Gamma-frailty survival</h3>
<p><span class="math display">\[
  \bar S(x) = {1 \over  \left(1 + \sigma^2 H_0(x)\right)^{1/ \sigma^2}}
  \]</span></p>
<ul>
<li>Older ages, smaller survival.</li>
<li>Variance not so clear, need a picture. (What if <span class="math inline">\(\sigma^2 = 0\)</span>?)</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="frailty.html#cb19-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span></span>
<span id="cb19-2"><a href="frailty.html#cb19-2"></a>a =<span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span></span>
<span id="cb19-3"><a href="frailty.html#cb19-3"></a>b =<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">10</span></span>
<span id="cb19-4"><a href="frailty.html#cb19-4"></a>mx<span class="fl">.0</span> &lt;-<span class="st"> </span>a <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(b<span class="op">*</span>x)</span>
<span id="cb19-5"><a href="frailty.html#cb19-5"></a>Hx<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">cumsum</span>(mx<span class="fl">.0</span>)</span>
<span id="cb19-6"><a href="frailty.html#cb19-6"></a>Sx<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>Hx<span class="fl">.0</span>)</span>
<span id="cb19-7"><a href="frailty.html#cb19-7"></a><span class="co">## small sigma</span></span>
<span id="cb19-8"><a href="frailty.html#cb19-8"></a>sigma.sq =<span class="st"> </span><span class="fl">.5</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb19-9"><a href="frailty.html#cb19-9"></a>bar.S.small.sigma &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sigma.sq <span class="op">*</span>Hx<span class="fl">.0</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>sigma.sq)</span>
<span id="cb19-10"><a href="frailty.html#cb19-10"></a><span class="co">## big sigma</span></span>
<span id="cb19-11"><a href="frailty.html#cb19-11"></a>sigma.sq =<span class="st"> </span><span class="dv">1</span><span class="op">^</span><span class="dv">2</span></span>
<span id="cb19-12"><a href="frailty.html#cb19-12"></a>bar.S.big.sigma &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>sigma.sq <span class="op">*</span>Hx<span class="fl">.0</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>sigma.sq)</span>
<span id="cb19-13"><a href="frailty.html#cb19-13"></a><span class="kw">plot</span>(x, Sx<span class="fl">.0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb19-14"><a href="frailty.html#cb19-14"></a>       <span class="dt">ylab =</span> <span class="st">&quot;Survival&quot;</span>)</span>
<span id="cb19-15"><a href="frailty.html#cb19-15"></a>  <span class="kw">lines</span>(x, bar.S.small.sigma, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb19-16"><a href="frailty.html#cb19-16"></a>  <span class="kw">lines</span>(x, bar.S.big.sigma, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb19-17"><a href="frailty.html#cb19-17"></a>  <span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Pop big.sigma&quot;</span>,</span>
<span id="cb19-18"><a href="frailty.html#cb19-18"></a>                       <span class="st">&quot;Pop small.sigma&quot;</span>,</span>
<span id="cb19-19"><a href="frailty.html#cb19-19"></a>                       <span class="st">&quot;Baseline&quot;</span>),</span>
<span id="cb19-20"><a href="frailty.html#cb19-20"></a>         <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb19-21"><a href="frailty.html#cb19-21"></a>         <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb19-22"><a href="frailty.html#cb19-22"></a>         <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" alt="Gamma-frailty population survival" width="672" />
<p class="caption">
Figure 3.2: Gamma-frailty population survival
</p>
</div>
</div>
</div>
<div id="conclusions-1" class="section level2">
<h2><span class="header-section-number">3.4</span> Conclusions</h2>
<ul>
<li>Multiplicative Fixed Frailty is one option for modeling</li>
<li>Gave us analytical expressions for population survival and hazards including <span class="math inline">\(\bar{\mu}(x) = \mu_0(x) \bar{z}(x)\)</span></li>
<li>Extended Keyfitz result to age-changing hazards</li>
<li>Survival curve for Gamma</li>
</ul>
<hr />
<hr />
</div>
<div id="questions-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Questions</h2>
<ol style="list-style-type: decimal">
<li><p>True/False: The variance of the population distribution of deaths will always be larger than that of the baseline. Explain your answer briefly.</p></li>
<li><p>Use the frailty simulator to produce plots of the uniform, gamma, and U-shaped beta distribution. Describe in a sentence, each, how the population hazard behaves at older ages.</p></li>
<li><p>Does the behavior of the uniform at older ages look like a population with two (proportional) sub-groups? What do you think is driving this? (This is an open-ended question. You should feel free to use mathematics, intuition, or any other approach to answer.)</p></li>
<li><p>Does the behavior of the beta at older ages look like the gamma at older ages? What do you think is driving this? (Also open ended)</p></li>
<li><p>At what age do population hazards start to diverge from the baseline in the the three models? Is it fair to say that half the cohort has to have died before unobserved heterogeneity plays a role?</p></li>
<li><p>Extend the simulation code to include life expectancy at age x (Shown above.)</p></li>
<li><p>Extend the simulation code to include the average frailty of the surviving at age x, z(x). (Note: this requires some more difficulty programming, and I would recommend keeping your N fairly small.)</p></li>
<li><p>Extend the simulation code to histograms of frailty of survivors at different ages. Does the uniform stay uniform? How about the other distributions?</p></li>
<li><p>Use the method of completing the gamma to get the mean of the gamma distribution. (Hint: I believe there are youtube examples of this).</p></li>
<li><p>Derive V&amp;M equation 13, extending Keyfitz’s result. Did your derivation require you to assume proportional hazards; if so, where?</p></li>
<li><p>Derive V&amp;M equation 20, extending Keyfitz’s result to proportional changes in the population hazard. Did your derivation require you to assume proportional hazards; if so, where?</p></li>
<li><p>Describe a strategy for simulating cross-overs in the aggregate hazards of two groups, which have baseline hazards that don’t cross. If you want, write code and produce a plot.</p></li>
</ol>
</div>
<div id="solutions-1" class="section level2">
<h2><span class="header-section-number">3.6</span> Solutions</h2>
<ol style="list-style-type: decimal">
<li><p><em>True/False: The variance of the population distribution of deaths will always be larger than that of the baseline. Explain your answer briefly.</em><br />
True.<br />
If each individual has their own hazard schedule proportional to baseline <span class="math inline">\(z\)</span>, there will be more variation in the distribution of deaths than if each person had the baseline case. The variation for homogeneous populations comes from to chance only, while the variation for heterogeneous populations comes from chance and group variation in risk. Therefore, the variance of the population distribution of deaths will always be larger than that of the baseline (unless the variance is 0).<br />
</p></li>
<li><p><em>Use the fraily simulator code to produce plots of the uniform, gamma, and U-shaped beta distribution. Describe in a sentence, each, how the population hazard behaves at older ages.</em><br />
For simplicity, we take the code and convert it into a function that can use frailty draws from different distributions. We also extend it to include life expectancy calculation.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="frailty.html#cb20-1"></a><span class="kw">source</span>(<span class="st">&quot;functions/gomp_funs.R&quot;</span>)</span>
<span id="cb20-2"><a href="frailty.html#cb20-2"></a></span>
<span id="cb20-3"><a href="frailty.html#cb20-3"></a>frailty_sim &lt;-<span class="st"> </span><span class="cf">function</span>( N, z, base.a, base.b ){</span>
<span id="cb20-4"><a href="frailty.html#cb20-4"></a>  <span class="co">## (1) simulate ages at death from h0*z  using the gompertz as our baseline##</span></span>
<span id="cb20-5"><a href="frailty.html#cb20-5"></a>  <span class="co">## note: we call the continuous ages of death &quot;y&quot;</span></span>
<span id="cb20-6"><a href="frailty.html#cb20-6"></a>  <span class="co">## but we&#39;ll make a table of deaths at age &quot;x&quot; and</span></span>
<span id="cb20-7"><a href="frailty.html#cb20-7"></a>  <span class="co">## using life table notation call the count &quot;Dx&quot;</span></span>
<span id="cb20-8"><a href="frailty.html#cb20-8"></a>  y &lt;-<span class="st"> </span><span class="kw">rgomp</span>(N,</span>
<span id="cb20-9"><a href="frailty.html#cb20-9"></a>       <span class="dt">b =</span> base.b, <span class="co">## doesn&#39;t vary</span></span>
<span id="cb20-10"><a href="frailty.html#cb20-10"></a>       <span class="dt">a =</span> base.a <span class="op">*</span><span class="st"> </span>z) <span class="co">## multiplicative fixed frailty</span></span>
<span id="cb20-11"><a href="frailty.html#cb20-11"></a></span>
<span id="cb20-12"><a href="frailty.html#cb20-12"></a>  <span class="co">## (2) Lifetables: first define age at death as floor(y) and then</span></span>
<span id="cb20-13"><a href="frailty.html#cb20-13"></a>  <span class="co">## make a table of deaths at each age (&quot;Dx&quot;)</span></span>
<span id="cb20-14"><a href="frailty.html#cb20-14"></a></span>
<span id="cb20-15"><a href="frailty.html#cb20-15"></a>  Dx &lt;-<span class="st"> </span><span class="kw">get.Dx</span>(y)</span>
<span id="cb20-16"><a href="frailty.html#cb20-16"></a>  x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">names</span>(Dx))  </span>
<span id="cb20-17"><a href="frailty.html#cb20-17"></a>  lx &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">cumsum</span>(<span class="kw">rev</span>(Dx))) <span class="co">## lx by reverse-survival</span></span>
<span id="cb20-18"><a href="frailty.html#cb20-18"></a>  lxpn &lt;-<span class="st"> </span><span class="kw">c</span>(lx[<span class="op">-</span><span class="dv">1</span>], <span class="dv">0</span>) <span class="co">## Person-years as average of adjacent lx</span></span>
<span id="cb20-19"><a href="frailty.html#cb20-19"></a>  Lx &lt;-<span class="st"> </span>(lx <span class="op">+</span><span class="st"> </span>lxpn)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb20-20"><a href="frailty.html#cb20-20"></a>  mx &lt;-<span class="st"> </span>Dx<span class="op">/</span>Lx <span class="co">## Hazards</span></span>
<span id="cb20-21"><a href="frailty.html#cb20-21"></a>  Tx &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">cumsum</span>(<span class="kw">rev</span>(Lx))) <span class="co">## Remaining person-years</span></span>
<span id="cb20-22"><a href="frailty.html#cb20-22"></a>  ex &lt;-<span class="st"> </span>Tx<span class="op">/</span>lx <span class="co">## Life expectancy at age x</span></span>
<span id="cb20-23"><a href="frailty.html#cb20-23"></a></span>
<span id="cb20-24"><a href="frailty.html#cb20-24"></a>  <span class="co">## Baseline lifetable</span></span>
<span id="cb20-25"><a href="frailty.html#cb20-25"></a>  lx.base &lt;-<span class="st"> </span>N <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span><span class="kw">pgomp</span>(x, <span class="dt">b =</span> base.b, <span class="dt">a =</span> base.a))</span>
<span id="cb20-26"><a href="frailty.html#cb20-26"></a>  Dx.base &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="op">-</span><span class="kw">diff</span>(<span class="kw">c</span>(lx.base,<span class="dv">0</span>)))</span>
<span id="cb20-27"><a href="frailty.html#cb20-27"></a>  mx.base &lt;-<span class="st"> </span>base.a <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(base.b <span class="op">*</span><span class="st"> </span>(x <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)) <span class="co">## x + .5</span></span>
<span id="cb20-28"><a href="frailty.html#cb20-28"></a>  lxpn.base &lt;-<span class="st"> </span><span class="kw">c</span>(lx.base[<span class="op">-</span><span class="dv">1</span>], <span class="dv">0</span>)</span>
<span id="cb20-29"><a href="frailty.html#cb20-29"></a>  Lx.base &lt;-<span class="st"> </span>(lx.base <span class="op">+</span><span class="st"> </span>lxpn.base)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb20-30"><a href="frailty.html#cb20-30"></a>  Tx.base &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">cumsum</span>(<span class="kw">rev</span>(Lx.base)))</span>
<span id="cb20-31"><a href="frailty.html#cb20-31"></a>  ex.base &lt;-<span class="st"> </span>Tx.base<span class="op">/</span>lx.base</span>
<span id="cb20-32"><a href="frailty.html#cb20-32"></a></span>
<span id="cb20-33"><a href="frailty.html#cb20-33"></a></span>
<span id="cb20-34"><a href="frailty.html#cb20-34"></a>  <span class="co"># exported tables</span></span>
<span id="cb20-35"><a href="frailty.html#cb20-35"></a>lifetables &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb20-36"><a href="frailty.html#cb20-36"></a>lifetables<span class="op">$</span>sim &lt;-<span class="st"> </span>y</span>
<span id="cb20-37"><a href="frailty.html#cb20-37"></a>lifetables<span class="op">$</span>z &lt;-<span class="st"> </span>z</span>
<span id="cb20-38"><a href="frailty.html#cb20-38"></a>lifetables<span class="op">$</span>baseline &lt;-<span class="st"> </span><span class="kw">tibble</span>(Dx.base, lx.base,lxpn.base, Lx.base, mx.base, Tx.base, ex.base)</span>
<span id="cb20-39"><a href="frailty.html#cb20-39"></a>lifetables<span class="op">$</span>frailty &lt;-<span class="st"> </span><span class="kw">tibble</span>(x,Dx, lx,lxpn, Lx, mx, Tx, ex)</span>
<span id="cb20-40"><a href="frailty.html#cb20-40"></a>  <span class="kw">return</span>(lifetables)</span>
<span id="cb20-41"><a href="frailty.html#cb20-41"></a></span>
<span id="cb20-42"><a href="frailty.html#cb20-42"></a>  }</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Uniform distribution:<br />
We find that the uniform-distributed frailty begins to increase more slowly after age 60 compared to baseline.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="frailty.html#cb21-1"></a><span class="co"># Parameters</span></span>
<span id="cb21-2"><a href="frailty.html#cb21-2"></a>million =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb21-3"><a href="frailty.html#cb21-3"></a>N &lt;-<span class="st">  </span>million</span>
<span id="cb21-4"><a href="frailty.html#cb21-4"></a>base.a &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span></span>
<span id="cb21-5"><a href="frailty.html#cb21-5"></a>base.b &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span></span>
<span id="cb21-6"><a href="frailty.html#cb21-6"></a><span class="kw">set.seed</span>(<span class="dv">1047</span>) <span class="co"># for reproducibility</span></span>
<span id="cb21-7"><a href="frailty.html#cb21-7"></a></span>
<span id="cb21-8"><a href="frailty.html#cb21-8"></a><span class="co">#Uniform distribution</span></span>
<span id="cb21-9"><a href="frailty.html#cb21-9"></a>w &lt;-<span class="st"> </span><span class="fl">.3</span> <span class="co">## try smaller if you want</span></span>
<span id="cb21-10"><a href="frailty.html#cb21-10"></a>z &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dt">min =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>w , <span class="dt">max =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>w)</span>
<span id="cb21-11"><a href="frailty.html#cb21-11"></a>uniform_frailty &lt;-<span class="st"> </span><span class="kw">frailty_sim</span>(N, z, base.a, base.b)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-13-1.png" alt="Uniform Distribution" width="100%" />
<p class="caption">
Figure 3.3: Uniform Distribution
</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Gamma frailty distribution:<br />
Gamma-distributed frailty begins to increase more slowly after age 60 compared to baseline.This is similar to the uniform frailty distribution.</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="frailty.html#cb22-1"></a><span class="co"># Parameters</span></span>
<span id="cb22-2"><a href="frailty.html#cb22-2"></a>million =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb22-3"><a href="frailty.html#cb22-3"></a>N &lt;-<span class="st">  </span>million</span>
<span id="cb22-4"><a href="frailty.html#cb22-4"></a>base.a &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span></span>
<span id="cb22-5"><a href="frailty.html#cb22-5"></a>base.b &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span></span>
<span id="cb22-6"><a href="frailty.html#cb22-6"></a><span class="kw">set.seed</span>(<span class="dv">1047</span>) <span class="co"># for reproducibility</span></span>
<span id="cb22-7"><a href="frailty.html#cb22-7"></a></span>
<span id="cb22-8"><a href="frailty.html#cb22-8"></a><span class="co">#Gamma distribution</span></span>
<span id="cb22-9"><a href="frailty.html#cb22-9"></a>my.sd &lt;-<span class="st"> </span><span class="fl">.5</span></span>
<span id="cb22-10"><a href="frailty.html#cb22-10"></a> sigma.sq &lt;-<span class="st"> </span>my.sd<span class="op">^</span><span class="dv">2</span></span>
<span id="cb22-11"><a href="frailty.html#cb22-11"></a>  z &lt;-<span class="st"> </span><span class="kw">rgamma</span>(N, <span class="dt">shape =</span> <span class="dv">1</span><span class="op">/</span>sigma.sq, <span class="dt">scale =</span> sigma.sq)</span>
<span id="cb22-12"><a href="frailty.html#cb22-12"></a>gamma_frailty &lt;-<span class="st"> </span><span class="kw">frailty_sim</span>(N, z, base.a, base.b)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" alt="Gamma Distribution" width="100%" />
<p class="caption">
Figure 3.4: Gamma Distribution
</p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Beta frailty distribution:<br />
Beta-distributed frailty begins to increase more slowly after age 60 compared to baseline and eventually stops increasing at age 100.</li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="frailty.html#cb23-1"></a><span class="co"># Parameters</span></span>
<span id="cb23-2"><a href="frailty.html#cb23-2"></a>million =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb23-3"><a href="frailty.html#cb23-3"></a>N &lt;-<span class="st">  </span>million</span>
<span id="cb23-4"><a href="frailty.html#cb23-4"></a>base.a &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">4</span></span>
<span id="cb23-5"><a href="frailty.html#cb23-5"></a>base.b &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span></span>
<span id="cb23-6"><a href="frailty.html#cb23-6"></a><span class="kw">set.seed</span>(<span class="dv">1047</span>) <span class="co"># for reproducibility</span></span>
<span id="cb23-7"><a href="frailty.html#cb23-7"></a></span>
<span id="cb23-8"><a href="frailty.html#cb23-8"></a><span class="co">#Beta distribution</span></span>
<span id="cb23-9"><a href="frailty.html#cb23-9"></a>z &lt;-<span class="st"> </span><span class="kw">rbeta</span>(N, <span class="dt">shape1 =</span> <span class="fl">.5</span>, <span class="dt">shape2 =</span> <span class="fl">.5</span>)</span>
<span id="cb23-10"><a href="frailty.html#cb23-10"></a>beta_frailty &lt;-<span class="st"> </span><span class="kw">frailty_sim</span>(N, z, base.a, base.b)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-17-1.png" alt="Beta Distribution" width="100%" />
<p class="caption">
Figure 3.5: Beta Distribution
</p>
</div></li>
<li><p><em>Does the behavior of the uniform at older ages look like a population with two (proportional) sub-groups? What do you think is driving this?</em><br />
It doesn’t look like two proportional subgroups. It looks like the frailty is drawn from a single distribution.<br />
</p></li>
<li><p><em>Does the behavior of the beta at older ages look like the gamma at older ages? What do you think is driving this?</em><br />
The behavior is somewhat similar, as the hazards are increasing more slowly at older ages. However, the beta hazards stops increasing at a certain point. The uniform and the gamma are more similar. For the parameters we used, beta-distributed frailty generates many very-frail or very-robust individuals and fewer medium-frail individuals. Gamma-distributed frailty generates many medium-frail individuals but fewer very-frail or very-robust individuals.<br />
</p></li>
<li><p><em>At what age do population hazards start to diverge from the baseline in the the three models? Is it fair to say that half the cohort has to have died before unobserved heterogeneity plays a role?</em><br />
Generally around age 65, but if frailty is beta distributed (with our set of parameters) then we observe a divergence earlier. For the gamma and uniform frailty models roughly half the cohort has to die before unobserved heterogeneity plays a role, but for the beta model we observe divergence in the survival curve much earlier.<br />
</p></li>
<li><p><em>Extend the simulation code to include life expectancy at age x.</em><br />
Within the frailty function, we include the steps to calculate life expectancy. We also limit the ages up to 100 for each simulation, to avoid extreme and non-realistic results. This is particularly relevant for the beta frailty distribution which leads to ages above 110 to be sampled.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="frailty.html#cb24-1"></a>Tx&lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">cumsum</span>(<span class="kw">rev</span>(Lx)))</span>
<span id="cb24-2"><a href="frailty.html#cb24-2"></a>ex &lt;-<span class="st"> </span>Tx<span class="op">/</span>lx</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="frailty.html#cb25-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb25-2"><a href="frailty.html#cb25-2"></a><span class="co">## Uniform</span></span>
<span id="cb25-3"><a href="frailty.html#cb25-3"></a><span class="kw">plot</span>(uniform_frailty<span class="op">$</span>frailty<span class="op">$</span>x, uniform_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">main =</span> <span class="st">&quot;Uniform&quot;</span>,</span>
<span id="cb25-4"><a href="frailty.html#cb25-4"></a> <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb25-5"><a href="frailty.html#cb25-5"></a> <span class="dt">ylim =</span> <span class="kw">range</span>(uniform_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">na.rm =</span> T, <span class="dt">finite =</span> <span class="ot">TRUE</span>),</span>
<span id="cb25-6"><a href="frailty.html#cb25-6"></a> <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span><span class="st">&quot;ex&quot;</span>)</span>
<span id="cb25-7"><a href="frailty.html#cb25-7"></a><span class="kw">lines</span>(uniform_frailty<span class="op">$</span>frailty<span class="op">$</span>x, uniform_frailty<span class="op">$</span>base<span class="op">$</span>ex.base, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb25-8"><a href="frailty.html#cb25-8"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;baseline&quot;</span>),</span>
<span id="cb25-9"><a href="frailty.html#cb25-9"></a>   <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">.8</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb25-10"><a href="frailty.html#cb25-10"></a><span class="co">## Gamma</span></span>
<span id="cb25-11"><a href="frailty.html#cb25-11"></a><span class="kw">plot</span>(gamma_frailty<span class="op">$</span>frailty<span class="op">$</span>x, gamma_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">main =</span> <span class="st">&quot;Gamma&quot;</span>,</span>
<span id="cb25-12"><a href="frailty.html#cb25-12"></a> <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb25-13"><a href="frailty.html#cb25-13"></a> <span class="dt">ylim =</span> <span class="kw">range</span>(gamma_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">na.rm =</span> T, <span class="dt">finite =</span> <span class="ot">TRUE</span>),</span>
<span id="cb25-14"><a href="frailty.html#cb25-14"></a> <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span><span class="st">&quot;ex&quot;</span>)</span>
<span id="cb25-15"><a href="frailty.html#cb25-15"></a><span class="kw">lines</span>(gamma_frailty<span class="op">$</span>frailty<span class="op">$</span>x, gamma_frailty<span class="op">$</span>base<span class="op">$</span>ex.base, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb25-16"><a href="frailty.html#cb25-16"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;baseline&quot;</span>),</span>
<span id="cb25-17"><a href="frailty.html#cb25-17"></a>   <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">.8</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb25-18"><a href="frailty.html#cb25-18"></a><span class="co">## Beta</span></span>
<span id="cb25-19"><a href="frailty.html#cb25-19"></a><span class="kw">plot</span>(beta_frailty<span class="op">$</span>frailty<span class="op">$</span>x, beta_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">main =</span> <span class="st">&quot;Beta&quot;</span>,</span>
<span id="cb25-20"><a href="frailty.html#cb25-20"></a> <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb25-21"><a href="frailty.html#cb25-21"></a> <span class="dt">ylim =</span> <span class="kw">range</span>(beta_frailty<span class="op">$</span>frailty<span class="op">$</span>ex, <span class="dt">na.rm =</span> T, <span class="dt">finite =</span> <span class="ot">TRUE</span>),</span>
<span id="cb25-22"><a href="frailty.html#cb25-22"></a> <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">110</span>),</span>
<span id="cb25-23"><a href="frailty.html#cb25-23"></a> <span class="dt">xlab =</span> <span class="st">&quot;Age&quot;</span>, <span class="dt">ylab =</span><span class="st">&quot;ex&quot;</span>)</span>
<span id="cb25-24"><a href="frailty.html#cb25-24"></a><span class="kw">lines</span>(beta_frailty<span class="op">$</span>frailty<span class="op">$</span>x, beta_frailty<span class="op">$</span>base<span class="op">$</span>ex.base, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb25-25"><a href="frailty.html#cb25-25"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;baseline&quot;</span>),</span>
<span id="cb25-26"><a href="frailty.html#cb25-26"></a>   <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">.8</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-19"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-19-1.png" alt="Life expectancy comparison" width="65%" height="65%" />
<p class="caption">
Figure 3.6: Life expectancy comparison
</p>
</div></li>
<li><p><em>Extend the simulation code to include the average frailty of the surviving at age x, z(x). (Note: this requires some more difficulty programming, and I would recommend keeping your N fairly small.)</em></p></li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="frailty.html#cb26-1"></a>avg_hazard_uniform &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(uniform_frailty<span class="op">$</span>sim),<span class="dt">z =</span> uniform_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="frailty.html#cb26-2"></a><span class="st">  </span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-3"><a href="frailty.html#cb26-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">z_mean =</span> <span class="kw">mean</span>(z), <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-4"><a href="frailty.html#cb26-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar_num =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(z_mean<span class="op">*</span>n)), <span class="dt">z_bar_denom =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(n))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-5"><a href="frailty.html#cb26-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar =</span> <span class="kw">rev</span>(z_bar_num<span class="op">/</span>z_bar_denom) )</span>
<span id="cb26-6"><a href="frailty.html#cb26-6"></a></span>
<span id="cb26-7"><a href="frailty.html#cb26-7"></a>avg_hazard_beta &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(beta_frailty<span class="op">$</span>sim),<span class="dt">z =</span> beta_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-8"><a href="frailty.html#cb26-8"></a><span class="st">  </span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-9"><a href="frailty.html#cb26-9"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">z_mean =</span> <span class="kw">mean</span>(z), <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-10"><a href="frailty.html#cb26-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar_num =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(z_mean<span class="op">*</span>n)), <span class="dt">z_bar_denom =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(n))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-11"><a href="frailty.html#cb26-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar =</span> <span class="kw">rev</span>(z_bar_num<span class="op">/</span>z_bar_denom) ) </span>
<span id="cb26-12"><a href="frailty.html#cb26-12"></a></span>
<span id="cb26-13"><a href="frailty.html#cb26-13"></a>avg_hazard_gamma &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(gamma_frailty<span class="op">$</span>sim),<span class="dt">z =</span> gamma_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-14"><a href="frailty.html#cb26-14"></a><span class="st">  </span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-15"><a href="frailty.html#cb26-15"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">z_mean =</span> <span class="kw">mean</span>(z), <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-16"><a href="frailty.html#cb26-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar_num =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(z_mean<span class="op">*</span>n)), <span class="dt">z_bar_denom =</span> <span class="kw">cumsum</span>(<span class="kw">rev</span>(n))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-17"><a href="frailty.html#cb26-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_bar =</span> <span class="kw">rev</span>(z_bar_num<span class="op">/</span>z_bar_denom) ) </span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="frailty.html#cb27-1"></a>  <span class="kw">ggplot</span>(<span class="dt">data=</span>avg_hazard_uniform , <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> z_bar)) <span class="op">+</span></span>
<span id="cb27-2"><a href="frailty.html#cb27-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-3"><a href="frailty.html#cb27-3"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-4"><a href="frailty.html#cb27-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-21"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-21-1.png" alt="Uniform Hazards Average Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.7: Uniform Hazards Average Frailty
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="frailty.html#cb28-1"></a>  <span class="kw">ggplot</span>(<span class="dt">data=</span>avg_hazard_gamma , <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> z_bar)) <span class="op">+</span></span>
<span id="cb28-2"><a href="frailty.html#cb28-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-3"><a href="frailty.html#cb28-3"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-4"><a href="frailty.html#cb28-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-22"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-22-1.png" alt="Gamma Hazards Average Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.8: Gamma Hazards Average Frailty
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="frailty.html#cb29-1"></a>  <span class="kw">ggplot</span>(<span class="dt">data=</span>avg_hazard_beta , <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> z_bar)) <span class="op">+</span></span>
<span id="cb29-2"><a href="frailty.html#cb29-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-3"><a href="frailty.html#cb29-3"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-4"><a href="frailty.html#cb29-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-23"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-23-1.png" alt="Beta Hazards Average Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.9: Beta Hazards Average Frailty
</p>
</div>
<ol start="8" style="list-style-type: decimal">
<li><em>Extend the simulation code to histograms of frailty of survivors at different ages. Does the uniform stay uniform? How about the other distributions?</em><br />
The uniform does not remain uniform. This matches our intuition that people with higher frailty will die off first. This leaves an exponentially decreasing distribution of frailty for survivors age 75+. The gamma remains a gamma but the parameters change. The beta, similar to the uniform, does not remain beta. There is an exponentially decreasing distribution of frailty for survivors age 75+.</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="frailty.html#cb30-1"></a>avg_hazard_uniform_age &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(uniform_frailty<span class="op">$</span>sim),<span class="dt">z =</span> uniform_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span></span>
<span id="cb30-2"><a href="frailty.html#cb30-2"></a><span class="st">  </span><span class="kw">filter</span>(age <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-3"><a href="frailty.html#cb30-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_group =</span> <span class="kw">case_when</span>(</span>
<span id="cb30-4"><a href="frailty.html#cb30-4"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span> <span class="op">~</span><span class="st"> &quot;(0-25]&quot;</span>,</span>
<span id="cb30-5"><a href="frailty.html#cb30-5"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span> <span class="op">~</span><span class="st">&quot;(25, 50]&quot;</span>,</span>
<span id="cb30-6"><a href="frailty.html#cb30-6"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st"> &quot;(50, 75]&quot;</span>,</span>
<span id="cb30-7"><a href="frailty.html#cb30-7"></a>    age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st">&quot;75+&quot;</span></span>
<span id="cb30-8"><a href="frailty.html#cb30-8"></a>  )) <span class="op">%&gt;%</span></span>
<span id="cb30-9"><a href="frailty.html#cb30-9"></a><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb30-10"><a href="frailty.html#cb30-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z))<span class="op">+</span><span class="st"> </span></span>
<span id="cb30-11"><a href="frailty.html#cb30-11"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-12"><a href="frailty.html#cb30-12"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span>age_group, <span class="dt">margins =</span> T)</span>
<span id="cb30-13"><a href="frailty.html#cb30-13"></a></span>
<span id="cb30-14"><a href="frailty.html#cb30-14"></a>avg_hazard_uniform_age</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-24"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.png" alt="Uniform Hazards Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.10: Uniform Hazards Frailty
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="frailty.html#cb31-1"></a>avg_hazard_gamma_age &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(gamma_frailty<span class="op">$</span>sim),<span class="dt">z =</span> gamma_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span></span>
<span id="cb31-2"><a href="frailty.html#cb31-2"></a><span class="st">  </span><span class="kw">filter</span>(age <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-3"><a href="frailty.html#cb31-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_group =</span> <span class="kw">case_when</span>(</span>
<span id="cb31-4"><a href="frailty.html#cb31-4"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span> <span class="op">~</span><span class="st"> &quot;(0-25]&quot;</span>,</span>
<span id="cb31-5"><a href="frailty.html#cb31-5"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span> <span class="op">~</span><span class="st">&quot;(25, 50]&quot;</span>,</span>
<span id="cb31-6"><a href="frailty.html#cb31-6"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st"> &quot;(50, 75]&quot;</span>,</span>
<span id="cb31-7"><a href="frailty.html#cb31-7"></a>    age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st">&quot;75+&quot;</span></span>
<span id="cb31-8"><a href="frailty.html#cb31-8"></a>  )) <span class="op">%&gt;%</span></span>
<span id="cb31-9"><a href="frailty.html#cb31-9"></a><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb31-10"><a href="frailty.html#cb31-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z))<span class="op">+</span><span class="st"> </span></span>
<span id="cb31-11"><a href="frailty.html#cb31-11"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-12"><a href="frailty.html#cb31-12"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span>age_group, <span class="dt">margins =</span> T)</span>
<span id="cb31-13"><a href="frailty.html#cb31-13"></a></span>
<span id="cb31-14"><a href="frailty.html#cb31-14"></a>avg_hazard_gamma_age</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-25"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-25-1.png" alt="Gamma Hazards Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.11: Gamma Hazards Frailty
</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="frailty.html#cb32-1"></a>avg_hazard_beta_age &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">floor</span>(beta_frailty<span class="op">$</span>sim),<span class="dt">z =</span> beta_frailty<span class="op">$</span>z) <span class="op">%&gt;%</span></span>
<span id="cb32-2"><a href="frailty.html#cb32-2"></a><span class="st">  </span><span class="kw">filter</span>(age <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="frailty.html#cb32-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">age_group =</span> <span class="kw">case_when</span>(</span>
<span id="cb32-4"><a href="frailty.html#cb32-4"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span> <span class="op">~</span><span class="st"> &quot;(0-25]&quot;</span>,</span>
<span id="cb32-5"><a href="frailty.html#cb32-5"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span> <span class="op">~</span><span class="st">&quot;(25, 50]&quot;</span>,</span>
<span id="cb32-6"><a href="frailty.html#cb32-6"></a>    age <span class="op">&lt;</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st"> &quot;(50, 75]&quot;</span>,</span>
<span id="cb32-7"><a href="frailty.html#cb32-7"></a>    age <span class="op">&gt;=</span><span class="st"> </span><span class="dv">75</span> <span class="op">~</span><span class="st">&quot;75+&quot;</span></span>
<span id="cb32-8"><a href="frailty.html#cb32-8"></a>  )) <span class="op">%&gt;%</span></span>
<span id="cb32-9"><a href="frailty.html#cb32-9"></a><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb32-10"><a href="frailty.html#cb32-10"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z))<span class="op">+</span><span class="st"> </span></span>
<span id="cb32-11"><a href="frailty.html#cb32-11"></a><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-12"><a href="frailty.html#cb32-12"></a><span class="st">  </span><span class="kw">facet_grid</span>( <span class="op">~</span>age_group, <span class="dt">margins =</span> T)</span>
<span id="cb32-13"><a href="frailty.html#cb32-13"></a></span>
<span id="cb32-14"><a href="frailty.html#cb32-14"></a>avg_hazard_beta_age</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-26"></span>
<img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.png" alt="Beta Hazards Frailty" width="65%" height="65%" />
<p class="caption">
Figure 3.12: Beta Hazards Frailty
</p>
</div>
<ol start="9" style="list-style-type: decimal">
<li><em>Use the method of completing the gamma to get the mean of the gamma distribution.</em><br />
<span class="math display">\[\begin{aligned}
\mu 
&amp; = \int_0^{\infty} \frac{1}{\Gamma(k) \lambda^k} z^{k - 1} e^{-\frac{z}{\lambda}} \\
&amp; = \frac{\Gamma(k+1) \lambda^{k+1}}{\Gamma(k+1) \lambda^{k+1}} \cdot \int_0^{\infty} \frac{1}{\Gamma(k) \lambda^k} z^{k - 1} e^{-\frac{z}{\lambda}} \\
&amp; = \frac{\Gamma(k+1) \lambda^{k+1}}{\Gamma(k) \lambda^{k}} \cdot \int_0^{\infty} \frac{1}{\Gamma(k+1) \lambda^{k+1}} z^{k - 1} e^{-\frac{z}{\lambda}} \\ 
&amp; = k \lambda \cdot 1 \\
&amp; = k \lambda
\end{aligned}\]</span></li>
<li><em>Derive V&amp;M equation 13, extending Keyfitz’s result. Did your derivation require you to assume proportional hazards; if so, where?</em><br />
</li>
<li><em>Derive V&amp;M equation 20, extending Keyfitz’s result to proportional changes in the population hazard. Did your derivation require you to assume proportional hazards; if so, where?</em><br />
</li>
<li><em>Describe a strategy for simulating cross-overs in the aggregate hazards of two groups, which have baseline hazards that don’t cross. If you want, write code and produce a plot.</em></li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-rodriguez2001">
<p>Rodriguez, Germán. 2001. “Unobserved Heterogeneity.” <a href="https://data.princeton.edu/pop509/UnobservedHeterogeneity.pdf">https://data.princeton.edu/pop509/UnobservedHeterogeneity.pdf</a>.</p>
</div>
<div id="ref-vaupel2014unobserved">
<p>Vaupel, James W, and Trifon I Missov. 2014. “Unobserved Population Heterogeneity: A Review of Formal Relationships.” <em>Demographic Research</em> 31: 659–86. <a href="https://www.demographic-research.org/Volumes/Vol31/22/">https://www.demographic-research.org/Volumes/Vol31/22/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gamma-frailty-with-applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-frailty.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
